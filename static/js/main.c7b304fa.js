/*! For license information please see main.c7b304fa.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={43:(e,t,n)=>{e.exports=n(202)},52:(e,t,n)=>{n.r(t),n.d(t,{FirebaseError:()=>s.g,SDK_VERSION:()=>te,_DEFAULT_ENTRY_NAME:()=>F,_addComponent:()=>V,_addOrOverwriteComponent:()=>K,_apps:()=>j,_clearComponents:()=>Y,_components:()=>q,_getProvider:()=>W,_isFirebaseApp:()=>G,_isFirebaseServerApp:()=>Q,_registerComponent:()=>z,_removeServiceInstance:()=>H,_serverApps:()=>B,deleteApp:()=>oe,getApp:()=>ie,getApps:()=>se,initializeApp:()=>ne,initializeServerApp:()=>re,onLog:()=>ce,registerVersion:()=>ae,setLogLevel:()=>le});var r=n(812),i=n(443),s=n(529),o=n(799);class a{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const c="@firebase/app",l="0.13.1",u=new i.Vy("@firebase/app"),h="@firebase/app-compat",d="@firebase/analytics-compat",f="@firebase/analytics",p="@firebase/app-check-compat",g="@firebase/app-check",m="@firebase/auth",_="@firebase/auth-compat",v="@firebase/database",y="@firebase/data-connect",w="@firebase/database-compat",b="@firebase/functions",E="@firebase/functions-compat",I="@firebase/installations",T="@firebase/installations-compat",C="@firebase/messaging",S="@firebase/messaging-compat",k="@firebase/performance",x="@firebase/performance-compat",P="@firebase/remote-config",A="@firebase/remote-config-compat",O="@firebase/storage",D="@firebase/storage-compat",R="@firebase/firestore",N="@firebase/ai",M="@firebase/firestore-compat",L="firebase",F="[DEFAULT]",U={[c]:"fire-core",[h]:"fire-core-compat",[f]:"fire-analytics",[d]:"fire-analytics-compat",[g]:"fire-app-check",[p]:"fire-app-check-compat",[m]:"fire-auth",[_]:"fire-auth-compat",[v]:"fire-rtdb",[y]:"fire-data-connect",[w]:"fire-rtdb-compat",[b]:"fire-fn",[E]:"fire-fn-compat",[I]:"fire-iid",[T]:"fire-iid-compat",[C]:"fire-fcm",[S]:"fire-fcm-compat",[k]:"fire-perf",[x]:"fire-perf-compat",[P]:"fire-rc",[A]:"fire-rc-compat",[O]:"fire-gcs",[D]:"fire-gcs-compat",[R]:"fire-fst",[M]:"fire-fst-compat",[N]:"fire-vertex","fire-js":"fire-js",[L]:"fire-js-all"},j=new Map,B=new Map,q=new Map;function V(e,t){try{e.container.addComponent(t)}catch(n){u.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function K(e,t){e.container.addOrOverwriteComponent(t)}function z(e){const t=e.name;if(q.has(t))return u.debug("There were multiple attempts to register component ".concat(t,".")),!1;q.set(t,e);for(const n of j.values())V(n,e);for(const n of B.values())V(n,e);return!0}function W(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function H(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:F;W(e,t).clearInstance(n)}function G(e){return void 0!==e.options}function Q(e){return null!==e&&void 0!==e&&void 0!==e.settings}function Y(){q.clear()}const $={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},J=new s.FA("app","Firebase",$);class X{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw J.create("app-deleted",{appName:this._name})}}function Z(e,t){const n=(0,s.u)(e.split(".")[1]);if(null===n)return void console.error("FirebaseServerApp ".concat(t," is invalid: second part could not be parsed."));if(void 0===JSON.parse(n).exp)return void console.error("FirebaseServerApp ".concat(t," is invalid: expiration claim could not be parsed"));1e3*JSON.parse(n).exp-(new Date).getTime()<=0&&console.error("FirebaseServerApp ".concat(t," is invalid: the token has expired."))}class ee extends X{constructor(e,t,n,r){const i=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,s={name:n,automaticDataCollectionEnabled:i};if(void 0!==e.apiKey)super(e,s,r);else{super(e.options,s,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},t),this._serverConfig.authIdToken&&Z(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Z(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"undefined"!==typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry((()=>{this.automaticCleanup()}))),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ae(c,l,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){oe(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw J.create("server-app-deleted")}}const te="11.9.0";function ne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=Object.assign({name:F,automaticDataCollectionEnabled:!0},t),o=i.name;if("string"!==typeof o||!o)throw J.create("bad-app-name",{appName:String(o)});if(n||(n=(0,s.T9)()),!n)throw J.create("no-options");const a=j.get(o);if(a){if((0,s.bD)(n,a.options)&&(0,s.bD)(i,a.config))return a;throw J.create("duplicate-app",{appName:o})}const c=new r.h1(o);for(const r of q.values())c.addComponent(r);const l=new X(n,i,c);return j.set(o,l),l}function re(e,t){if((0,s.Bd)()&&!(0,s.p7)())throw J.create("invalid-server-app-environment");let n;void 0===t.automaticDataCollectionEnabled&&(t.automaticDataCollectionEnabled=!0),n=G(e)?e.options:e;const i=Object.assign(Object.assign({},t),n);void 0!==i.releaseOnDeref&&delete i.releaseOnDeref;if(void 0!==t.releaseOnDeref&&"undefined"===typeof FinalizationRegistry)throw J.create("finalization-registry-not-supported",{});const o=""+(a=JSON.stringify(i),[...a].reduce(((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0),0));var a;const c=B.get(o);if(c)return c.incRefCount(t.releaseOnDeref),c;const l=new r.h1(o);for(const r of q.values())l.addComponent(r);const u=new ee(n,t,o,l);return B.set(o,u),u}function ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;const t=j.get(e);if(!t&&e===F&&(0,s.T9)())return ne();if(!t)throw J.create("no-app",{appName:e});return t}function se(){return Array.from(j.values())}async function oe(e){let t=!1;const n=e.name;if(j.has(n))t=!0,j.delete(n);else if(B.has(n)){e.decRefCount()<=0&&(B.delete(n),t=!0)}t&&(await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function ae(e,t,n){var i;let s=null!==(i=U[e])&&void 0!==i?i:e;n&&(s+="-".concat(n));const o=s.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const e=['Unable to register library "'.concat(s,'" with version "').concat(t,'":')];return o&&e.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),o&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void u.warn(e.join(" "))}z(new r.uA("".concat(s,"-version"),(()=>({library:s,version:t})),"VERSION"))}function ce(e,t){if(null!==e&&"function"!==typeof e)throw J.create("invalid-log-argument");(0,i.Ey)(e,t)}function le(e){(0,i.He)(e)}const ue="firebase-heartbeat-store";let he=null;function de(){return he||(he=(0,o.P2)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ue)}catch(n){console.warn(n)}}}).catch((e=>{throw J.create("idb-open",{originalErrorMessage:e.message})}))),he}async function fe(e,t){try{const n=(await de()).transaction(ue,"readwrite"),r=n.objectStore(ue);await r.put(t,pe(e)),await n.done}catch(n){if(n instanceof s.g)u.warn(n.message);else{const e=J.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});u.warn(e.message)}}}function pe(e){return"".concat(e.name,"!").concat(e.options.appId)}class ge{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new _e(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=me();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){u.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=me(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),ve(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ve(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=(0,s.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return u.warn(t),""}}}function me(){return(new Date).toISOString().substring(0,10)}class _e{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.zW)()&&(0,s.eX)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await de()).transaction(ue),n=await t.objectStore(ue).get(pe(e));return await t.done,n}catch(t){if(t instanceof s.g)u.warn(t.message);else{const e=J.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});u.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return fe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return fe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ve(e){return(0,s.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var ye;ye="",z(new r.uA("platform-logger",(e=>new a(e)),"PRIVATE")),z(new r.uA("heartbeat",(e=>new ge(e)),"PRIVATE")),ae(c,l,ye),ae(c,l,"esm2017"),ae("fire-js","")},111:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>App});var C_Users_Administrator_Desktop_Project2_sri_rudra_chat_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(379),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(43),_firebase__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(765),firebase_firestore__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(550),firebase_database__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(796),lucide_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(393),lucide_react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(940),lucide_react__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(669),lucide_react__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(469),lucide_react__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(247),lucide_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(746),lucide_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(408),lucide_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(645),react_chessboard__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(846),chess_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(314),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(579);function LoginScreen(e){let{onLogin:t}=e;const[n,r]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("phone"),[i,s]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(""),[o,a]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"flex flex-col items-center justify-center h-screen p-4 bg-white dark:bg-slate-900",children:"phone"===n?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("h1",{className:"mb-4 text-2xl",children:"Enter your phone"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("input",{className:"mb-4 p-2 border rounded w-full max-w-md",placeholder:"+911234567890",value:i,onChange:e=>s(e.target.value)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:()=>i.trim()&&r("name"),disabled:!i.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded",children:"Next"})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("h1",{className:"mb-4 text-2xl",children:"Enter your name"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("input",{className:"mb-4 p-2 border rounded w-full max-w-md",placeholder:"Your name",value:o,onChange:e=>a(e.target.value)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:()=>o.trim()&&t(i.trim(),o.trim()),disabled:!o.trim(),className:"px-4 py-2 bg-green-500 text-white rounded",children:"Continue"})]})})}function WelcomeScreen(e){let{onFinish:t}=e;return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const e=setTimeout(t,3e3);return()=>clearTimeout(e)}),[t]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"fixed inset-0 bg-black flex items-center justify-center z-50",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("h1",{className:"text-4xl text-white animate-pulse",children:"Powered by Sri Rudra IT Solutions"})})}const Avatar=e=>{let{name:t}=e;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("img",{src:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(t),"&background=007AFF&color=fff"),alt:t,className:"w-10 h-10 rounded-full"})};function Modal(e){let{title:t,onClose:n,children:r}=e;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 shadow-lg w-full max-w-md",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("h2",{className:"text-xl font-bold",children:t}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:n,className:"text-gray-500",children:"\u2715"})]}),r]})})}function ChessGame(e){let{onClose:t}=e;const[n]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(new chess_js__WEBPACK_IMPORTED_MODULE_5__.d$),[r,i]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("start");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:t,className:"self-end",children:"Close"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_chessboard__WEBPACK_IMPORTED_MODULE_4__.Ve,{position:r,onPieceDrop:(e,t)=>{let r;try{r=n.move({from:e,to:t,promotion:"q"})}catch(s){return!1}return r&&i(n.fen()),!!r},boardWidth:320}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:()=>{n.reset(),i("start")},className:"px-4 py-2 bg-red-500 text-white rounded",children:"Reset"})]})}function CalculatorModal(_ref6){let{onClose:onClose}=_ref6;const[expr,setExpr]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(""),append=e=>setExpr((t=>t+e)),clear=()=>setExpr(""),evalIt=()=>{try{setExpr(eval(expr).toString())}catch(_unused2){setExpr("Err")}},KEYS=["7","8","9","/","4","5","6","*","1","2","3","-","0",".","=","+"];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"space-y-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("input",{readOnly:!0,value:expr,className:"w-full p-2 border rounded text-right"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"grid grid-cols-4 gap-2",children:KEYS.map((e=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:()=>"="===e?evalIt():append(e),className:"p-2 bg-gray-200 rounded",children:e},e)))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex justify-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:clear,className:"px-4 py-2 bg-yellow-400 rounded",children:"Clear"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:onClose,className:"px-4 py-2 bg-gray-300 rounded",children:"Close"})]})]})}function ChatList(e){let{me:t,users:n,unread:r,onSelect:i,onLogout:s,theme:o,onToggle:a}=e;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex flex-col h-full bg-white dark:bg-slate-900",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("header",{className:"flex justify-between p-4 bg-white dark:bg-slate-800 shadow rounded-b-lg",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("span",{children:["Hello, ",t]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:a,children:"light"===o?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_7__.A,{}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_8__.A,{})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:s,className:"px-2 py-1 bg-red-200 rounded",children:"Logout"})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"flex-1 overflow-auto p-4",children:0===n.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("p",{children:"No one online"}):n.map((e=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{onClick:()=>i(e),className:"flex items-center p-3 mb-2 bg-white dark:bg-slate-800 rounded shadow cursor-pointer",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(Avatar,{name:e.name}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{className:"ml-2 flex-1",children:e.name}),r[e.id]>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:r[e.id]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_9__.A,{className:"ml-2"})]},e.id)))})]})}function ChatRoom(e){let{me:t,peer:n,roomId:r,onBack:i}=e;const[s,o]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),[a,c]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(""),l=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),u=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),h=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(new Set);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const e=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.P)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.rJ)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db,"rooms",r,"messages"),(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.My)("createdAt")),t=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.aQ)(e,(e=>{var t;const n=e.docs.map((e=>(0,C_Users_Administrator_Desktop_Project2_sri_rudra_chat_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.A)({id:e.id},e.data())));"granted"===Notification.permission&&n.forEach((e=>{h.current.has(e.id)||e.uid===window.userId||new Notification(e.name,{body:e.text})})),h.current=new Set(n.map((e=>e.id))),o(n),null===(t=l.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})}));return()=>t()}),[r]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex flex-col h-screen bg-white dark:bg-slate-900",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("header",{className:"flex items-center p-4 bg-white dark:bg-slate-800 shadow rounded-b-lg",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:i,className:"mr-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_11__.A,{})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(Avatar,{name:n.name}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{className:"ml-2",children:n.name}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"ml-auto flex gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:()=>u.current.click(),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_12__.A,{})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("input",{type:"file",accept:"image/*",capture:"environment",ref:u,className:"hidden",onChange:e=>(async e=>{const n=_firebase__WEBPACK_IMPORTED_MODULE_1__.IG.ref("images/".concat(r,"/").concat(e.name));await n.put(e);const i=await n.getDownloadURL();await(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.gS)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.rJ)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db,"rooms",r,"messages"),{name:t,image:i,uid:window.userId,createdAt:(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.O5)()})})(e.target.files[0])})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("main",{className:"flex-1 overflow-auto px-4 pt-6 pb-24 space-y-3",children:[s.map((e=>{var t;const n=e.uid===window.userId,r=null===(t=e.createdAt)||void 0===t?void 0:t.toDate().toLocaleTimeString();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"flex ".concat(n?"justify-end":"justify-start"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"px-4 py-2 rounded-2xl shadow max-w-[70%] ".concat(n?"bg-blue-500 text-white":"bg-gray-100 dark:bg-slate-700 dark:text-white"),children:[e.image?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("img",{src:e.image,alt:"",className:"rounded-lg"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("p",{children:e.text}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"text-xs text-gray-300 mt-1 text-right",children:r})]})},e.id)})),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{ref:l})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),a.trim()&&(await(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.gS)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.rJ)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db,"rooms",r,"messages"),{name:t,text:a,uid:window.userId,createdAt:(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.O5)()}),c(""))},className:"sticky bottom-0 z-10 flex items-center p-3 bg-white dark:bg-slate-800 shadow-inner",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("input",{value:a,onChange:e=>c(e.target.value),placeholder:"Type a message\u2026",className:"flex-1 p-2 border rounded"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{type:"submit",className:"ml-2 p-2 bg-blue-500 text-white rounded-full",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_13__.A,{})})]})]})}function BottomNav(e){let{onFood:t,onGames:n,onCalc:r,onChats:i}=e;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-900 border-t p-2 flex justify-around",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("button",{onClick:t,className:"flex flex-col items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_14__.A,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{className:"text-xs",children:"Food"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("button",{onClick:n,className:"flex flex-col items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_15__.A,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{className:"text-xs",children:"Games"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("button",{onClick:r,className:"flex flex-col items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_13__.A,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{className:"text-xs",children:"Calc"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("button",{onClick:i,className:"flex flex-col items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(lucide_react__WEBPACK_IMPORTED_MODULE_9__.A,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{className:"text-xs",children:"Chats"})]})]})}function App(){const[e,t]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(""),[n,r]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),[i,s]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),[o,a]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),[c,l]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[u,h]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[d,f]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[p,g]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[m,_]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("light"),[v,y]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({}),[w,b]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(!p)return;const e=setTimeout((()=>g(!1)),3e3);return()=>clearTimeout(e)}),[p]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{document.documentElement.classList.toggle("dark","dark"===m)}),[m]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(!e)return;const t=(0,firebase_database__WEBPACK_IMPORTED_MODULE_3__.KR)(_firebase__WEBPACK_IMPORTED_MODULE_1__.$2,"status/".concat(window.userId));(0,firebase_database__WEBPACK_IMPORTED_MODULE_3__.yX)(t).set({name:e,online:!1}),(0,firebase_database__WEBPACK_IMPORTED_MODULE_3__.hZ)(t,{name:e,online:!0})}),[e]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const e=(0,firebase_database__WEBPACK_IMPORTED_MODULE_3__.KR)(_firebase__WEBPACK_IMPORTED_MODULE_1__.$2,"status");return(0,firebase_database__WEBPACK_IMPORTED_MODULE_3__.Zy)(e,(e=>{const t=[];e.forEach((e=>{const{name:n,online:r}=e.val();r&&e.key!==window.userId&&t.push({id:e.key,name:n})})),r(t)}))}),[]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(!e)return;const t=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.P)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.rJ)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db,"rooms"),(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__._M)("participants","array-contains",window.userId)),n=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.aQ)(t,(e=>{e.docs.forEach((e=>{const t=e.id,n=e.data().participants.find((e=>e!==window.userId)),r=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.P)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.rJ)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db,"rooms",t,"messages"),(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.My)("createdAt"));(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.aQ)(r,(e=>{let t=0;e.docChanges().forEach((e=>{"added"===e.type&&e.doc.data().uid!==window.userId&&n!==w&&t++})),t&&y((e=>(0,C_Users_Administrator_Desktop_Project2_sri_rudra_chat_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.A)((0,C_Users_Administrator_Desktop_Project2_sri_rudra_chat_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.A)({},e),{},{[n]:(e[n]||0)+t})))}))}))}));return()=>n()}),[e,w]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{w&&y((e=>{const t=(0,C_Users_Administrator_Desktop_Project2_sri_rudra_chat_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.A)({},e);return delete t[w],t}))}),[w]);return e?p?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(WelcomeScreen,{onFinish:()=>g(!1)}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex flex-col h-screen",children:[i?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(ChatRoom,{me:e,peer:i,roomId:o,onBack:()=>{s(null),a(null),b(null)}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(ChatList,{me:e,users:n,unread:v,onSelect:async e=>{const t=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.rJ)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db,"rooms"),n=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.P)(t,(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__._M)("participants","in",[[window.userId,e.id],[e.id,window.userId]])),r=await(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.GG)(n),i=r.empty?await(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.gS)(t,{participants:[window.userId,e.id],createdAt:(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_2__.O5)()}):r.docs[0];s(e),a(i.id),b(e.id)},onLogout:async()=>{const n=(0,firebase_database__WEBPACK_IMPORTED_MODULE_3__.KR)(_firebase__WEBPACK_IMPORTED_MODULE_1__.$2,"status/".concat(window.userId));await(0,firebase_database__WEBPACK_IMPORTED_MODULE_3__.hZ)(n,{name:e,online:!1}),await(0,firebase_database__WEBPACK_IMPORTED_MODULE_3__.TF)(n),t("")},theme:m,onToggle:()=>_((e=>"light"===e?"dark":"light"))}),!i&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(BottomNav,{onFood:()=>l(!0),onGames:()=>h(!0),onCalc:()=>f(!0),onChats:()=>{}}),c&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(Modal,{title:"Order Food",onClose:()=>l(!1),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:()=>window.open("https://swiggy.com","_blank"),className:"px-4 py-2 bg-red-500 text-white rounded",children:"Swiggy"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{onClick:()=>window.open("https://zomato.com","_blank"),className:"px-4 py-2 bg-yellow-500 text-white rounded",children:"Zomato"})]})}),u&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(Modal,{title:"Chess Game",onClose:()=>h(!1),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(ChessGame,{onClose:()=>h(!1)})}),d&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(Modal,{title:"Calculator",onClose:()=>f(!1),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(CalculatorModal,{onClose:()=>f(!1)})})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(LoginScreen,{onLogin:async(e,n)=>{await(0,_firebase__WEBPACK_IMPORTED_MODULE_1__.BW)(),window.userId=e,t(n),g(!0)}})}},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,s={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!c.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=l,t.jsxs=l},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function _(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function v(){}function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=_.prototype;var w=y.prototype=new v;w.constructor=y,g(w,_.prototype),w.isPureReactComponent=!0;var b=Array.isArray,E=Object.prototype.hasOwnProperty,I={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)E.call(t,i)&&!T.hasOwnProperty(i)&&(s[i]=t[i]);var c=arguments.length-2;if(1===c)s.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}if(e&&e.defaultProps)for(i in c=e.defaultProps)void 0===s[i]&&(s[i]=c[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:I.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function x(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return o=o(c=e),e=""===s?"."+x(c,0):s,b(o)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),P(o,t,i,"",(function(e){return e}))):null!=o&&(S(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+e)),t.push(o)),1;if(c=0,s=""===s?".":s+":",b(e))for(var l=0;l<e.length;l++){var u=s+x(a=e[l],l);c+=P(a,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)c+=P(a=a.value,t,i,u=s+x(a,l++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function A(e,t,n){if(null==e)return e;var r=[],i=0;return P(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},R={transition:null},N={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:R,ReactCurrentOwner:I};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=_,t.Fragment=i,t.Profiler=o,t.PureComponent=y,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=I.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)E.call(t,l)&&!T.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,c=e[a],l=a+1,u=e[l];if(0>s(c,n))l<i&&0>s(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[a]=n,r=a);else{if(!(l<i&&0>s(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var l=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,_="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(l,t)}t=r(u)}}function b(e){if(m=!1,w(e),!g)if(null!==r(l))g=!0,R(E);else{var t=r(u);null!==t&&N(b,t.startTime-e)}}function E(e,n){g=!1,m&&(m=!1,v(S),S=-1),p=!0;var s=f;try{for(w(n),d=r(l);null!==d&&(!(d.expirationTime>n)||e&&!P());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(l)&&i(l),w(n)}else i(l);d=r(l)}if(null!==d)var c=!0;else{var h=r(u);null!==h&&N(b,h.startTime-n),c=!1}return c}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var I,T=!1,C=null,S=-1,k=5,x=-1;function P(){return!(t.unstable_now()-x<k)}function A(){if(null!==C){var e=t.unstable_now();x=e;var n=!0;try{n=C(!0,e)}finally{n?I():(T=!1,C=null)}}else T=!1}if("function"===typeof y)I=function(){y(A)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,D=O.port2;O.port1.onmessage=A,I=function(){D.postMessage(null)}}else I=function(){_(A,0)};function R(e){C=e,T||(T=!0,I())}function N(e,n){S=_((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,R(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(l)&&e===r(u)&&(m?(v(S),S=-1):m=!0,N(b,s-o))):(e.sortIndex=a,n(l,e),g||p||(g=!0,R(E))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},247:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(995).A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},255:(e,t,n)=>{n.d(t,{$1:()=>vs,$w:()=>Qi,AU:()=>ss,CA:()=>Ls,D8:()=>qi,Di:()=>Rs,EO:()=>ds,EZ:()=>_t,FD:()=>cs,GV:()=>zs,HM:()=>ps,JK:()=>Es,Jt:()=>$i,KR:()=>Bi,Kd:()=>zr,M4:()=>ns,Mq:()=>js,O5:()=>Ks,P:()=>Ps,SF:()=>u,TF:()=>Wi,TS:()=>qs,U0:()=>is,V0:()=>Fs,VC:()=>zi,VJ:()=>Us,VR:()=>Ss,X1:()=>rs,YL:()=>Ni,Zy:()=>es,_O:()=>ts,c4:()=>Hs,eO:()=>Bs,hZ:()=>Hi,iz:()=>xs,j2:()=>Hr,jf:()=>Vi,kT:()=>ws,og:()=>Ts,pk:()=>ms,rf:()=>us,t2:()=>Ui,wu:()=>Ri,yX:()=>Ki,yo:()=>Yi,zm:()=>Gi});var r=n(52),i=n(812),s=n(529),o=n(443);const a="@firebase/database",c="1.0.19";let l="";function u(e){l=e}class h{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,s.As)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,s.$L)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class d{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,s.gR)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const f=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new h(t)}}catch(t){}return new d},p=f("localStorage"),g=f("sessionStorage"),m=new o.Vy("@firebase/database"),_=function(){let e=1;return function(){return e++}}(),v=function(e){const t=(0,s.kj)(e),n=new s.gz;n.update(t);const r=n.digest();return s.K3.encodeByteArray(r)},y=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=y.apply(null,n):e+="object"===typeof n?(0,s.As)(n):n,e+=" "}return e};let w=null,b=!0;const E=function(e,t){(0,s.vA)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(m.logLevel=o.$b.VERBOSE,w=m.log.bind(m),t&&g.set("logging_enabled",!0)):"function"===typeof e?w=e:(w=null,g.remove("logging_enabled"))},I=function(){if(!0===b&&(b=!1,null===w&&!0===g.get("logging_enabled")&&E(!0)),w){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=y.apply(null,t);w(r)}},T=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];I(e,...n)}},C=function(){const e="FIREBASE INTERNAL ERROR: "+y(...arguments);m.error(e)},S=function(){const e="FIREBASE FATAL ERROR: ".concat(y(...arguments));throw m.error(e),new Error(e)},k=function(){const e="FIREBASE WARNING: "+y(...arguments);m.warn(e)},x=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},P="[MIN_NAME]",A="[MAX_NAME]",O=function(e,t){if(e===t)return 0;if(e===P||t===A)return-1;if(t===P||e===A)return 1;{const n=j(e),r=j(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},D=function(e,t){return e===t?0:e<t?-1:1},R=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+(0,s.As)(t))},N=function(e){if("object"!==typeof e||null===e)return(0,s.As)(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=(0,s.As)(t[r]),n+=":",n+=N(e[t[r]]);return n+="}",n},M=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function L(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const F=function(e){(0,s.vA)(!x(e),"Invalid JSON number");const t=1023;let n,r,i,o,a;0===e?(r=0,i=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(o=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=o+t,i=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const c=[];for(a=52;a;a-=1)c.push(i%2?1:0),i=Math.floor(i/2);for(a=11;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(n?1:0),c.reverse();const l=c.join("");let u="";for(a=0;a<64;a+=8){let e=parseInt(l.substr(a,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()};const U=new RegExp("^-?(0*)\\d{1,10}$"),j=function(e){if(U.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},B=function(e){try{e()}catch(t){setTimeout((()=>{const e=t.stack||"";throw k("Exception was thrown by user callback.",e),t}),Math.floor(0))}},q=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class V{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,(0,r._isFirebaseServerApp)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then((e=>this.appCheck=e))}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){k('Provided AppCheck credentials for the app named "'.concat(this.appName,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}class K{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(I("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',k(e)}}class z{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}z.OWNER="owner";const W="5",H=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,G="ac",Q="websocket",Y="long_polling";class ${constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=p.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&p.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}function J(e,t,n){let r;if((0,s.vA)("string"===typeof t,"typeof type must == string"),(0,s.vA)("object"===typeof n,"typeof params must == object"),t===Q)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Y)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return L(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}class X{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,s.gR)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,s.A4)(this.counters_)}}const Z={},ee={};function te(e){const t=e.toString();return Z[t]||(Z[t]=new X),Z[t]}class ne{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&B((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const re="start";class ie{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T(e),this.stats_=te(t),this.urlFn=e=>(this.appCheckToken&&(e[G]=this.appCheckToken),J(t,Y,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ne(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if((0,s.$g)()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new se((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s,o,a,c]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===re)n.id=s,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,(()=>{n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,s)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[re]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=W,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[G]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&H.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ie.forceAllow_=!0}static forceDisallow(){ie.forceDisallow_=!0}static isAvailable(){return!(0,s.$g)()&&(!!ie.forceAllow_||!ie.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,s.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=(0,s.KA)(t),r=M(n,1840);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,s.$g)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,s.As)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class se{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,s.$g)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=_(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=se.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(i){I("frame writing exception"),i.stack&&I(i.stack),I(i)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||I("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){(0,s.$g)()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{I("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}}),Math.floor(1))}}let oe=null;"undefined"!==typeof MozWebSocket?oe=MozWebSocket:"undefined"!==typeof WebSocket&&(oe=WebSocket);class ae{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T(this.connId),this.stats_=te(t),this.connURL=ae.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const o={};return o.v=W,!(0,s.$g)()&&"undefined"!==typeof location&&location.hostname&&H.test(location.hostname)&&(o.r="f"),t&&(o.s=t),n&&(o.ls=n),r&&(o[G]=r),i&&(o.p=i),J(e,Q,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,p.set("previous_websocket_failure",!0);try{let e;if((0,s.$g)()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":"Firebase/".concat(W,"/").concat(l,"/").concat(process.platform,"/").concat(t),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"/rudra-chat",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(e.proxy={origin:r})}this.mySock=new oe(this.connURL,[],e)}catch(n){this.log_("Error instantiating WebSocket.");const e=n.message||n.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){ae.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==oe&&!ae.forceDisallow_}static previouslyFailed(){return p.isInMemoryStorage||!0===p.get("previous_websocket_failure")}markConnectionHealthy(){p.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=(0,s.$L)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,s.vA)(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=(0,s.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=M(t,16384);n.length>1&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ae.responsesRequiredToBeHealthy=2,ae.healthyTimeout=3e4;class ce{static get ALL_TRANSPORTS(){return[ie,ae]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=ae&&ae.isAvailable();let n=t&&!ae.previouslyFailed();if(e.webSocketOnly&&(t||k("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[ae];else{const e=this.transports_=[];for(const t of ce.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);ce.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ce.globalTransportInitialized_=!1;class le{constructor(e,t,n,r,i,s,o,a,c,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T("c:"+this.id+":"),this.transportManager_=new ce(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=q((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=R("t",e),n=R("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=R("t",e),n=R("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=R("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?C("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):C("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),W!==n&&k("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),q((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):q((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(p.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class ue{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class he{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,s.vA)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let e=0;e<i.length;e++)i[e].callback.apply(i[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}validateEventType_(e){(0,s.vA)(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class de extends he{static getInstance(){return new de}constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||(0,s.jZ)()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}getInitialEvent(e){return(0,s.vA)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class fe{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function pe(){return new fe("")}function ge(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function me(e){return e.pieces_.length-e.pieceNum_}function _e(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new fe(e.pieces_,t)}function ve(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function we(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new fe(t,0)}function be(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof fe)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new fe(n,0)}function Ee(e){return e.pieceNum_>=e.pieces_.length}function Ie(e,t){const n=ge(e),r=ge(t);if(null===n)return t;if(n===r)return Ie(_e(e),_e(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Te(e,t){const n=ye(e,0),r=ye(t,0);for(let i=0;i<n.length&&i<r.length;i++){const e=O(n[i],r[i]);if(0!==e)return e}return n.length===r.length?0:n.length<r.length?-1:1}function Ce(e,t){if(me(e)!==me(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Se(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(me(e)>me(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class ke{constructor(e,t){this.errorPrefix_=t,this.parts_=ye(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=(0,s.OE)(this.parts_[n]);xe(this)}}function xe(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Pe(e))}function Pe(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Ae extends he{static getInstance(){return new Ae}constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}getInitialEvent(e){return(0,s.vA)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Oe=1e3;class De extends ue{constructor(e,t,n,r,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=De.nextPersistentConnectionId_++,this.log_=T("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Oe,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!(0,s.$g)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Ae.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&de.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_((0,s.As)(i)),(0,s.vA)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new s.cY,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),(0,s.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,s.vA)(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;De.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&(0,s.gR)(e,"w")){const n=(0,s.yw)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();k("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(e," at ")+"".concat(n," to your security rules for better performance."))}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,s.qc)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=(0,s.Cv)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,s.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,s.As)(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):C("Unrecognized action received from server: "+(0,s.As)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,s.vA)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Oe,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Oe,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Oe),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=Math.max(0,(new Date).getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+De.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,n())},l=function(e){(0,s.vA)(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[s,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?I("getToken() completed but was canceled"):(I("getToken() completed. Creating connection."),this.authToken_=s&&s.accessToken,this.appCheckToken_=c&&c.token,a=new le(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{k(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(C){this.log_("Failed to get token: "+C),o||(this.repoInfo_.nodeAdmin&&k(C),c())}}}interrupt(e){I("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){I("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,s.Im)(this.interruptReasons_)&&(this.reconnectDelay_=Oe,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>N(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new fe(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){I("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){I("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";(0,s.$g)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+l.replace(/\./g,"-")]=1,(0,s.jZ)()?e["framework.cordova"]=1:(0,s.lV)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=de.getInstance().currentlyOnline();return(0,s.Im)(this.interruptReasons_)&&e}}De.nextPersistentConnectionId_=0,De.nextConnectionId_=0;class Re{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Re(e,t)}}class Ne{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Re(P,e),r=new Re(P,t);return 0!==this.compare(n,r)}minPost(){return Re.MIN}}let Me;class Le extends Ne{static get __EMPTY_NODE(){return Me}static set __EMPTY_NODE(e){Me=e}compare(e,t){return O(e.name,t.name)}isDefinedOn(e){throw(0,s.Hk)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Re.MIN}maxPost(){return new Re(A,Me)}makePost(e,t){return(0,s.vA)("string"===typeof e,"KeyIndex indexValue must always be a string."),new Re(e,Me)}toString(){return".key"}}const Fe=new Le;class Ue{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class je{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:je.RED,this.left=null!=r?r:Be.EMPTY_NODE,this.right=null!=i?i:Be.EMPTY_NODE}copy(e,t,n,r,i){return new je(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Be.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Be.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,je.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,je.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}je.RED=!0,je.BLACK=!1;class Be{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Be.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new Be(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,je.BLACK,null,null))}remove(e){return new Be(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,je.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ue(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ue(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ue(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ue(this.root_,null,this.comparator_,!0,e)}}function qe(e,t){return O(e.name,t.name)}function Ve(e,t){return O(e,t)}let Ke;Be.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new je(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const ze=function(e){return"number"===typeof e?"number:"+F(e):"string:"+e},We=function(e){if(e.isLeafNode()){const t=e.val();(0,s.vA)("string"===typeof t||"number"===typeof t||"object"===typeof t&&(0,s.gR)(t,".sv"),"Priority must be a string or number.")}else(0,s.vA)(e===Ke||e.isEmpty(),"priority of unexpected type.");(0,s.vA)(e===Ke||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let He,Ge,Qe;class Ye{static set __childrenNodeConstructor(e){He=e}static get __childrenNodeConstructor(){return He}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ye.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,(0,s.vA)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),We(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ye(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Ye.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ee(e)?this:".priority"===ge(e)?this.priorityNode_:Ye.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Ye.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=ge(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:((0,s.vA)(".priority"!==n||1===me(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Ye.__childrenNodeConstructor.EMPTY_NODE.updateChild(_e(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ze(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?F(this.value_):this.value_,this.lazyHash_=v(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ye.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ye.__childrenNodeConstructor?-1:((0,s.vA)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Ye.VALUE_TYPE_ORDER.indexOf(t),i=Ye.VALUE_TYPE_ORDER.indexOf(n);return(0,s.vA)(r>=0,"Unknown leaf type: "+t),(0,s.vA)(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Ye.VALUE_TYPE_ORDER=["object","boolean","number","string"];const $e=new class extends Ne{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?O(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Re.MIN}maxPost(){return new Re(A,new Ye("[PRIORITY-POST]",Qe))}makePost(e,t){const n=Ge(e);return new Re(t,new Ye("[PRIORITY-POST]",n))}toString(){return".priority"}},Je=Math.log(2);class Xe{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Je,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Ze=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new je(a,o.node,je.BLACK,null,null);{const c=parseInt(s/2,10)+t,l=i(t,c),u=i(c+1,r);return o=e[c],a=n?n(o):o,new je(a,o.node,je.BLACK,l,u)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const l=i(s+1,a),u=e[s],h=n?n(u):u;c(new je(h,u.node,r,null,l))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,je.BLACK):(a(r,je.BLACK),a(r,je.RED))}return s}(new Xe(e.length));return new Be(r||t,s)};let et;const tt={};class nt{static get Default(){return(0,s.vA)(tt&&$e,"ChildrenNode.ts has not been loaded"),et=et||new nt({".priority":tt},{".priority":$e}),et}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=(0,s.yw)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Be?t:null}hasIndex(e){return(0,s.gR)(this.indexSet_,e.toString())}addIndex(e,t){(0,s.vA)(e!==Fe,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Re.Wrap);let o,a=i.getNext();for(;a;)r=r||e.isDefinedOn(a.node),n.push(a),a=i.getNext();o=r?Ze(n,e.getCompare()):tt;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=o,new nt(u,l)}addToIndexes(e,t){const n=(0,s.kH)(this.indexes_,((n,r)=>{const i=(0,s.yw)(this.indexSet_,r);if((0,s.vA)(i,"Missing index implementation for "+r),n===tt){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Re.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),Ze(n,i.getCompare())}return tt}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Re(e.name,r))),i.insert(e,e.node)}}));return new nt(n,this.indexSet_)}removeFromIndexes(e,t){const n=(0,s.kH)(this.indexes_,(n=>{if(n===tt)return n;{const r=t.get(e.name);return r?n.remove(new Re(e.name,r)):n}}));return new nt(n,this.indexSet_)}}let rt;class it{static get EMPTY_NODE(){return rt||(rt=new it(new Be(Ve),null,nt.Default))}constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&We(this.priorityNode_),this.children_.isEmpty()&&(0,s.vA)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||rt}updatePriority(e){return this.children_.isEmpty()?this:new it(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?rt:t}}getChild(e){const t=ge(e);return null===t?this:this.getImmediateChild(t).getChild(_e(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if((0,s.vA)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Re(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?rt:this.priorityNode_;return new it(r,s,i)}}updateChild(e,t){const n=ge(e);if(null===n)return t;{(0,s.vA)(".priority"!==ge(e)||1===me(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(_e(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild($e,((s,o)=>{t[s]=o.val(e),n++,i&&it.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+ze(this.getPriority().val())+":"),this.forEachChild($e,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":v(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Re(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Re(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Re(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Re.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Re.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===st?-1:0}withIndex(e){if(e===Fe||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new it(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Fe||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator($e),n=t.getIterator($e);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===Fe?null:this.indexMap_.get(e.toString())}}it.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const st=new class extends it{constructor(){super(new Be(Ve),it.EMPTY_NODE,nt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return it.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Re,{MIN:{value:new Re(P,it.EMPTY_NODE)},MAX:{value:new Re(A,st)}}),Le.__EMPTY_NODE=it.EMPTY_NODE,Ye.__childrenNodeConstructor=it,Ke=st,function(e){Qe=e}(st);const ot=!0;function at(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return it.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),(0,s.vA)(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new Ye(e,at(t))}if(e instanceof Array||!ot){let n=it.EMPTY_NODE;return L(e,((t,r)=>{if((0,s.gR)(e,t)&&"."!==t.substring(0,1)){const e=at(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(at(t))}{const n=[];let r=!1;if(L(e,((e,t)=>{if("."!==e.substring(0,1)){const i=at(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Re(e,i)))}})),0===n.length)return it.EMPTY_NODE;const i=Ze(n,qe,(e=>e.name),Ve);if(r){const e=Ze(n,$e.getCompare());return new it(i,at(t),new nt({".priority":e},{".priority":$e}))}return new it(i,at(t),nt.Default)}}!function(e){Ge=e}(at);class ct extends Ne{constructor(e){super(),this.indexPath_=e,(0,s.vA)(!Ee(e)&&".priority"!==ge(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?O(e.name,t.name):i}makePost(e,t){const n=at(e),r=it.EMPTY_NODE.updateChild(this.indexPath_,n);return new Re(t,r)}maxPost(){const e=it.EMPTY_NODE.updateChild(this.indexPath_,st);return new Re(A,e)}toString(){return ye(this.indexPath_,0).join("/")}}const lt=new class extends Ne{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?O(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Re.MIN}maxPost(){return Re.MAX}makePost(e,t){const n=at(e);return new Re(t,n)}toString(){return".value"}};function ut(e){return{type:"value",snapshotNode:e}}function ht(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function dt(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function ft(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class pt{constructor(e){this.index_=e}updateChild(e,t,n,r,i,o){(0,s.vA)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(dt(t,a)):(0,s.vA)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ht(t,n)):o.trackChildChange(ft(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild($e,((e,r)=>{t.hasChild(e)||n.trackChildChange(dt(e,r))})),t.isLeafNode()||t.forEachChild($e,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(ft(t,r,i))}else n.trackChildChange(ht(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?it.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class gt{constructor(e){this.indexedFilter_=new pt(e.getIndex()),this.index_=e.getIndex(),this.startPost_=gt.getStartPost_(e),this.endPost_=gt.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new Re(t,n))||(n=it.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=it.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(it.EMPTY_NODE);const i=this;return t.forEachChild($e,((e,t)=>{i.matches(new Re(e,t))||(r=r.updateImmediateChild(e,it.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class mt{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new gt(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new Re(t,n))||(n=it.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=it.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=it.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(it.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,it.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let o;if(this.reverse_){const e=this.index_.getCompare();o=(t,n)=>e(n,t)}else o=this.index_.getCompare();const a=e;(0,s.vA)(a.numChildren()===this.limit_,"");const c=new Re(t,n),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(t)){const e=a.getImmediateChild(t);let s=r.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=s&&(s.name===t||a.hasChild(s.name));)s=r.getChildAfterChild(this.index_,s,this.reverse_);const h=null==s?1:o(s,c);if(u&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(ft(t,n,e)),a.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(dt(t,e));const n=a.updateImmediateChild(t,it.EMPTY_NODE);return null!=s&&this.rangedFilter_.matches(s)?(null!=i&&i.trackChildChange(ht(s.name,s.node)),n.updateImmediateChild(s.name,s.node)):n}}return n.isEmpty()?e:u&&o(l,c)>=0?(null!=i&&(i.trackChildChange(dt(l.name,l.node)),i.trackChildChange(ht(t,n))),a.updateImmediateChild(t,n).updateImmediateChild(l.name,it.EMPTY_NODE)):e}}class _t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$e}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,s.vA)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,s.vA)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:P}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,s.vA)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,s.vA)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:A}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,s.vA)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$e}copy(){const e=new _t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function vt(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function yt(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function wt(e,t){const n=e.copy();return n.index_=t,n}function bt(e){const t={};if(e.isDefault())return t;let n;if(e.index_===$e?n="$priority":e.index_===lt?n="$value":e.index_===Fe?n="$key":((0,s.vA)(e.index_ instanceof ct,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=(0,s.As)(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=(0,s.As)(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+(0,s.As)(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=(0,s.As)(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+(0,s.As)(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Et(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==$e&&(t.i=e.index_.toString()),t}class It extends ue{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,s.vA)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=T("p:rest:"),this.listens_={}}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=It.getListenId_(e,n),a={};this.listens_[o]=a;const c=bt(e._queryParams);this.restRequest_(i+".json",c,((e,t)=>{let c=t;if(404===e&&(c=null,e=null),null===e&&this.onDataUpdate_(i,c,!1,n),(0,s.yw)(this.listens_,o)===a){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=It.getListenId_(e,t);delete this.listens_[n]}get(e){const t=bt(e._queryParams),n=e._path.toString(),r=new s.cY;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((r=>{let[i,o]=r;i&&i.accessToken&&(t.auth=i.accessToken),o&&o.token&&(t.ac=o.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,s.Am)(t);this.log_("Sending REST request for "+a);const c=new XMLHttpRequest;c.onreadystatechange=()=>{if(n&&4===c.readyState){this.log_("REST Response for "+a+" received. status:",c.status,"response:",c.responseText);let t=null;if(c.status>=200&&c.status<300){try{t=(0,s.$L)(c.responseText)}catch(e){k("Failed to parse JSON response for "+a+": "+c.responseText)}n(null,t)}else 401!==c.status&&404!==c.status&&k("Got unsuccessful REST response for "+a+" Status: "+c.status),n(c.status);n=null}},c.open("GET",a,!0),c.send()}))}}class Tt{constructor(){this.rootNode_=it.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Ct(){return{value:null,children:new Map}}function St(e,t,n){if(Ee(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=ge(t);e.children.has(r)||e.children.set(r,Ct());St(e.children.get(r),t=_e(t),n)}}function kt(e,t){if(Ee(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild($e,((t,n)=>{St(e,new fe(t),n)})),kt(e,t)}}if(e.children.size>0){const n=ge(t);if(t=_e(t),e.children.has(n)){kt(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function xt(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{xt(r,new fe(t.toString()+"/"+e),n)}))}class Pt{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&L(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class At{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Pt(e);const n=1e4+2e4*Math.random();q(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;L(e,((e,r)=>{r>0&&(0,s.gR)(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),q(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ot;function Dt(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ot||(Ot={}));class Rt{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Ot.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Ee(this.path)){if(null!=this.affectedTree.value)return(0,s.vA)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new fe(e));return new Rt(pe(),t,this.revert)}}return(0,s.vA)(ge(this.path)===e,"operationForChild called for unrelated child."),new Rt(_e(this.path),this.affectedTree,this.revert)}}class Nt{constructor(e,t){this.source=e,this.path=t,this.type=Ot.LISTEN_COMPLETE}operationForChild(e){return Ee(this.path)?new Nt(this.source,pe()):new Nt(this.source,_e(this.path))}}class Mt{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Ot.OVERWRITE}operationForChild(e){return Ee(this.path)?new Mt(this.source,pe(),this.snap.getImmediateChild(e)):new Mt(this.source,_e(this.path),this.snap)}}class Lt{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Ot.MERGE}operationForChild(e){if(Ee(this.path)){const t=this.children.subtree(new fe(e));return t.isEmpty()?null:t.value?new Mt(this.source,pe(),t.value):new Lt(this.source,pe(),t)}return(0,s.vA)(ge(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Lt(this.source,_e(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Ft{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ee(e))return this.isFullyInitialized()&&!this.filtered_;const t=ge(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Ut{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function jt(e,t,n,r,i,o){const a=r.filter((e=>e.type===n));a.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw(0,s.Hk)("Should only compare child_ events.");const r=new Re(t.childName,t.snapshotNode),i=new Re(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),a.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,o);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Bt(e,t){return{eventCache:e,serverCache:t}}function qt(e,t,n,r){return Bt(new Ft(t,n,r),e.serverCache)}function Vt(e,t,n,r){return Bt(e.eventCache,new Ft(t,n,r))}function Kt(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function zt(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Wt;class Ht{static fromObject(e){let t=new Ht(null);return L(e,((e,n)=>{t=t.set(new fe(e),n)})),t}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(Wt||(Wt=new Be(D)),Wt);this.value=e,this.children=t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:pe(),value:this.value};if(Ee(e))return null;{const n=ge(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(_e(e),t);if(null!=i){return{path:be(new fe(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Ee(e))return this;{const t=ge(e),n=this.children.get(t);return null!==n?n.subtree(_e(e)):new Ht(null)}}set(e,t){if(Ee(e))return new Ht(t,this.children);{const n=ge(e),r=(this.children.get(n)||new Ht(null)).set(_e(e),t),i=this.children.insert(n,r);return new Ht(this.value,i)}}remove(e){if(Ee(e))return this.children.isEmpty()?new Ht(null):new Ht(null,this.children);{const t=ge(e),n=this.children.get(t);if(n){const r=n.remove(_e(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new Ht(null):new Ht(this.value,i)}return this}}get(e){if(Ee(e))return this.value;{const t=ge(e),n=this.children.get(t);return n?n.get(_e(e)):null}}setTree(e,t){if(Ee(e))return t;{const n=ge(e),r=(this.children.get(n)||new Ht(null)).setTree(_e(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Ht(this.value,i)}}fold(e){return this.fold_(pe(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(be(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,pe(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Ee(e))return null;{const r=ge(e),i=this.children.get(r);return i?i.findOnPath_(_e(e),be(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,pe(),t)}foreachOnPath_(e,t,n){if(Ee(e))return this;{this.value&&n(t,this.value);const r=ge(e),i=this.children.get(r);return i?i.foreachOnPath_(_e(e),be(t,r),n):new Ht(null)}}foreach(e){this.foreach_(pe(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(be(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class Gt{constructor(e){this.writeTree_=e}static empty(){return new Gt(new Ht(null))}}function Qt(e,t,n){if(Ee(t))return new Gt(new Ht(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=Ie(i,t);return s=s.updateChild(o,n),new Gt(e.writeTree_.set(i,s))}{const r=new Ht(n),i=e.writeTree_.setTree(t,r);return new Gt(i)}}}function Yt(e,t,n){let r=e;return L(n,((e,n)=>{r=Qt(r,be(t,e),n)})),r}function $t(e,t){if(Ee(t))return Gt.empty();{const n=e.writeTree_.setTree(t,new Ht(null));return new Gt(n)}}function Jt(e,t){return null!=Xt(e,t)}function Xt(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Ie(n.path,t)):null}function Zt(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild($e,((e,n)=>{t.push(new Re(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Re(e,n.value))})),t}function en(e,t){if(Ee(t))return e;{const n=Xt(e,t);return new Gt(null!=n?new Ht(n):e.writeTree_.subtree(t))}}function tn(e){return e.writeTree_.isEmpty()}function nn(e,t){return rn(pe(),e.writeTree_,t)}function rn(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?((0,s.vA)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=rn(be(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(be(e,".priority"),r)),n}}function sn(e,t){return vn(t,e)}function on(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));(0,s.vA)(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,o=!1,a=e.allWrites.length-1;for(;i&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=n&&an(t,r.path)?i=!1:Se(r.path,t.path)&&(o=!0)),a--}if(i){if(o)return function(e){e.visibleWrites=ln(e.allWrites,cn,pe()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=$t(e.visibleWrites,r.path);else{L(r.children,(t=>{e.visibleWrites=$t(e.visibleWrites,be(r.path,t))}))}return!0}return!1}function an(e,t){if(e.snap)return Se(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Se(be(e.path,n),t))return!0;return!1}function cn(e){return e.visible}function ln(e,t,n){let r=Gt.empty();for(let i=0;i<e.length;++i){const o=e[i];if(t(o)){const e=o.path;let t;if(o.snap)Se(n,e)?(t=Ie(n,e),r=Qt(r,t,o.snap)):Se(e,n)&&(t=Ie(e,n),r=Qt(r,pe(),o.snap.getChild(t)));else{if(!o.children)throw(0,s.Hk)("WriteRecord should have .snap or .children");if(Se(n,e))t=Ie(n,e),r=Yt(r,t,o.children);else if(Se(e,n))if(t=Ie(e,n),Ee(t))r=Yt(r,pe(),o.children);else{const e=(0,s.yw)(o.children,ge(t));if(e){const n=e.getChild(_e(t));r=Qt(r,pe(),n)}}}}}return r}function un(e,t,n,r,i){if(r||i){const s=en(e.visibleWrites,t);if(!i&&tn(s))return n;if(i||null!=n||Jt(s,pe())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Se(e.path,t)||Se(t,e.path))};return nn(ln(e.allWrites,s,t),n||it.EMPTY_NODE)}return null}{const r=Xt(e.visibleWrites,t);if(null!=r)return r;{const r=en(e.visibleWrites,t);if(tn(r))return n;if(null!=n||Jt(r,pe())){return nn(r,n||it.EMPTY_NODE)}return null}}}function hn(e,t,n,r){return un(e.writeTree,e.treePath,t,n,r)}function dn(e,t){return function(e,t,n){let r=it.EMPTY_NODE;const i=Xt(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild($e,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=en(e.visibleWrites,t);return n.forEachChild($e,((e,t)=>{const n=nn(en(i,new fe(e)),t);r=r.updateImmediateChild(e,n)})),Zt(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return Zt(en(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function fn(e,t,n,r){return function(e,t,n,r,i){(0,s.vA)(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=be(t,n);if(Jt(e.visibleWrites,o))return null;{const t=en(e.visibleWrites,o);return tn(t)?i.getChild(n):nn(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function pn(e,t){return function(e,t){return Xt(e.visibleWrites,t)}(e.writeTree,be(e.treePath,t))}function gn(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=en(e.visibleWrites,t),l=Xt(c,pe());if(null!=l)a=l;else{if(null==n)return[];a=nn(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function mn(e,t,n){return function(e,t,n,r){const i=be(t,n),s=Xt(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return nn(en(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function _n(e,t){return vn(be(e.treePath,t),e.writeTree)}function vn(e,t){return{treePath:e,writeTree:t}}class yn{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;(0,s.vA)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,s.vA)(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,ft(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,dt(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,ht(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw(0,s.Hk)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,ft(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const wn=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class bn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Ft(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return mn(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:zt(this.viewCache_),i=gn(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function En(e,t,n,r,i){const o=new yn;let a,c;if(n.type===Ot.OVERWRITE){const l=n;l.source.fromUser?a=Cn(e,t,l.path,l.snap,r,i,o):((0,s.vA)(l.source.fromServer,"Unknown source."),c=l.source.tagged||t.serverCache.isFiltered()&&!Ee(l.path),a=Tn(e,t,l.path,l.snap,r,i,c,o))}else if(n.type===Ot.MERGE){const l=n;l.source.fromUser?a=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const l=be(n,r);Sn(t,ge(l))&&(a=Cn(e,a,l,c,i,s,o))})),r.foreach(((r,c)=>{const l=be(n,r);Sn(t,ge(l))||(a=Cn(e,a,l,c,i,s,o))})),a}(e,t,l.path,l.children,r,i,o):((0,s.vA)(l.source.fromServer,"Unknown source."),c=l.source.tagged||t.serverCache.isFiltered(),a=xn(e,t,l.path,l.children,r,i,c,o))}else if(n.type===Ot.ACK_USER_WRITE){const c=n;a=c.revert?function(e,t,n,r,i,o){let a;if(null!=pn(r,n))return t;{const c=new bn(r,t,i),l=t.eventCache.getNode();let u;if(Ee(n)||".priority"===ge(n)){let n;if(t.serverCache.isFullyInitialized())n=hn(r,zt(t));else{const e=t.serverCache.getNode();(0,s.vA)(e instanceof it,"serverChildren would be complete if leaf node"),n=dn(r,e)}u=e.filter.updateFullNode(l,n,o)}else{const i=ge(n);let s=mn(r,i,t.serverCache);null==s&&t.serverCache.isCompleteForChild(i)&&(s=l.getImmediateChild(i)),u=null!=s?e.filter.updateChild(l,i,s,_e(n),c,o):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(l,i,it.EMPTY_NODE,_e(n),c,o):l,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=hn(r,zt(t)),a.isLeafNode()&&(u=e.filter.updateFullNode(u,a,o)))}return a=t.serverCache.isFullyInitialized()||null!=pn(r,pe()),qt(t,u,a,e.filter.filtersNodes())}}(e,t,c.path,r,i,o):function(e,t,n,r,i,s,o){if(null!=pn(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(Ee(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Tn(e,t,n,c.getNode().getChild(n),i,s,a,o);if(Ee(n)){let r=new Ht(null);return c.getNode().forEachChild(Fe,((e,t)=>{r=r.set(new fe(e),t)})),xn(e,t,n,r,i,s,a,o)}return t}{let l=new Ht(null);return r.foreach(((e,t)=>{const r=be(n,e);c.isCompleteForPath(r)&&(l=l.set(e,c.getNode().getChild(r)))})),xn(e,t,n,l,i,s,a,o)}}(e,t,c.path,c.affectedTree,r,i,o)}else{if(n.type!==Ot.LISTEN_COMPLETE)throw(0,s.Hk)("Unknown operation type: "+n.type);a=function(e,t,n,r,i){const s=t.serverCache,o=Vt(t,s.getNode(),s.isFullyInitialized()||Ee(n),s.isFiltered());return In(e,o,n,r,wn,i)}(e,t,n.path,r,o)}const l=o.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Kt(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(ut(Kt(t)))}}(t,a,l),{viewCache:a,changes:l}}function In(e,t,n,r,i,o){const a=t.eventCache;if(null!=pn(r,n))return t;{let c,l;if(Ee(n))if((0,s.vA)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=zt(t),i=dn(r,n instanceof it?n:it.EMPTY_NODE);c=e.filter.updateFullNode(t.eventCache.getNode(),i,o)}else{const n=hn(r,zt(t));c=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const u=ge(n);if(".priority"===u){(0,s.vA)(1===me(n),"Can't have a priority with additional path components");const i=a.getNode();l=t.serverCache.getNode();const o=fn(r,n,i,l);c=null!=o?e.filter.updatePriority(i,o):a.getNode()}else{const s=_e(n);let h;if(a.isCompleteForChild(u)){l=t.serverCache.getNode();const e=fn(r,n,a.getNode(),l);h=null!=e?a.getNode().getImmediateChild(u).updateChild(s,e):a.getNode().getImmediateChild(u)}else h=mn(r,u,t.serverCache);c=null!=h?e.filter.updateChild(a.getNode(),u,h,s,i,o):a.getNode()}}return qt(t,c,a.isFullyInitialized()||Ee(n),e.filter.filtersNodes())}}function Tn(e,t,n,r,i,s,o,a){const c=t.serverCache;let l;const u=o?e.filter:e.filter.getIndexedFilter();if(Ee(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),e,null)}else{const e=ge(n);if(!c.isCompleteForPath(n)&&me(n)>1)return t;const i=_e(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);l=".priority"===e?u.updatePriority(c.getNode(),s):u.updateChild(c.getNode(),e,s,i,wn,null)}const h=Vt(t,l,c.isFullyInitialized()||Ee(n),u.filtersNodes());return In(e,h,n,i,new bn(i,h,s),a)}function Cn(e,t,n,r,i,s,o){const a=t.eventCache;let c,l;const u=new bn(i,t,s);if(Ee(n))l=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=qt(t,l,!0,e.filter.filtersNodes());else{const i=ge(n);if(".priority"===i)l=e.filter.updatePriority(t.eventCache.getNode(),r),c=qt(t,l,a.isFullyInitialized(),a.isFiltered());else{const s=_e(n),l=a.getNode().getImmediateChild(i);let h;if(Ee(s))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===ve(s)&&e.getChild(we(s)).isEmpty()?e:e.updateChild(s,r):it.EMPTY_NODE}if(l.equals(h))c=t;else{c=qt(t,e.filter.updateChild(a.getNode(),i,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function Sn(e,t){return e.eventCache.isCompleteForChild(t)}function kn(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function xn(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,l=t;c=Ee(n)?r:new Ht(null).setTree(n,r);const u=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const c=kn(0,t.serverCache.getNode().getImmediateChild(n),r);l=Tn(e,l,new fe(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!c){const c=kn(0,t.serverCache.getNode().getImmediateChild(n),r);l=Tn(e,l,new fe(n),c,i,s,o,a)}})),l}class Pn{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new pt(n.getIndex()),i=(s=n).loadsAllData()?new pt(s.getIndex()):s.hasLimit()?new mt(s):new gt(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(it.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(it.EMPTY_NODE,a.getNode(),null),u=new Ft(c,o.isFullyInitialized(),r.filtersNodes()),h=new Ft(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Bt(h,u),this.eventGenerator_=new Ut(this.query_)}get query(){return this.query_}}function An(e,t){const n=zt(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Ee(t)&&!n.getImmediateChild(ge(t)).isEmpty())?n.getChild(t):null}function On(e){return 0===e.eventRegistrations_.length}function Dn(e,t,n){const r=[];if(n){(0,s.vA)(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function Rn(e,t,n,r){t.type===Ot.MERGE&&null!==t.source.queryId&&((0,s.vA)(zt(e.viewCache_),"We should always have a full cache before handling merges"),(0,s.vA)(Kt(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,o=En(e.processor_,i,t,n,r);var a,c;return a=e.processor_,c=o.viewCache,(0,s.vA)(c.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),(0,s.vA)(c.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),(0,s.vA)(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,Nn(e,o.changes,o.viewCache.eventCache.getNode(),null)}function Nn(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),jt(e,i,"child_removed",t,r,n),jt(e,i,"child_added",t,r,n),jt(e,i,"child_moved",s,r,n),jt(e,i,"child_changed",t,r,n),jt(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let Mn,Ln;class Fn{constructor(){this.views=new Map}}function Un(e,t,n,r){const i=t.source.queryId;if(null!==i){const o=e.views.get(i);return(0,s.vA)(null!=o,"SyncTree gave us an op for an invalid query."),Rn(o,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(Rn(s,t,n,r));return i}}function jn(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=hn(n,i?r:null),s=!1;e?s=!0:r instanceof it?(e=dn(n,r),s=!1):(e=it.EMPTY_NODE,s=!1);const o=Bt(new Ft(e,s,!1),new Ft(r,i,!1));return new Pn(t,o)}return o}function Bn(e,t,n,r,i,s){const o=jn(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild($e,((e,t)=>{r.push(ht(e,t))}));return n.isFullyInitialized()&&r.push(ut(n.getNode())),Nn(e,r,n.getNode(),t)}(o,n)}function qn(e,t,n,r){const i=t._queryIdentifier,o=[];let a=[];const c=Hn(e);if("default"===i)for(const[s,l]of e.views.entries())a=a.concat(Dn(l,n,r)),On(l)&&(e.views.delete(s),l.query._queryParams.loadsAllData()||o.push(l.query));else{const t=e.views.get(i);t&&(a=a.concat(Dn(t,n,r)),On(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||o.push(t.query)))}return c&&!Hn(e)&&o.push(new((0,s.vA)(Mn,"Reference.ts has not been loaded"),Mn)(t._repo,t._path)),{removed:o,events:a}}function Vn(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Kn(e,t){let n=null;for(const r of e.views.values())n=n||An(r,t);return n}function zn(e,t){if(t._queryParams.loadsAllData())return Gn(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Wn(e,t){return null!=zn(e,t)}function Hn(e){return null!=Gn(e)}function Gn(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Qn=1;class Yn{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ht(null),this.pendingWriteTree_={visibleWrites:Gt.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function $n(e,t,n,r,i){return function(e,t,n,r,i){(0,s.vA)(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Qt(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?sr(e,new Mt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Jn(e,t,n,r){!function(e,t,n,r){(0,s.vA)(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Yt(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=Ht.fromObject(n);return sr(e,new Lt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function Xn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(on(e.pendingWriteTree_,t)){let t=new Ht(null);return null!=r.snap?t=t.set(pe(),!0):L(r.children,(e=>{t=t.set(new fe(e),!0)})),sr(e,new Rt(r.path,t,n))}return[]}function Zn(e,t,n){return sr(e,new Mt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function er(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||Wn(o,t))){const c=qn(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const l=c.removed;if(a=c.events,!i){const n=-1!==l.findIndex((e=>e._queryParams.loadsAllData())),i=e.syncPointTree_.findOnPath(s,((e,t)=>Hn(t)));if(n&&!i){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&Hn(t)){return[Gn(t)]}{let e=[];return t&&(e=Vn(t)),L(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=cr(e,r);e.listenProvider_.startListening(pr(i),lr(e,i),s.hashFn,s.onComplete)}}}if(!i&&l.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(pr(t),n)}else l.forEach((t=>{const n=e.queryToTagMap.get(ur(t));e.listenProvider_.stopListening(pr(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=ur(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,l)}return a}function tr(e,t,n,r){const i=hr(e,r);if(null!=i){const r=dr(i),s=r.path,o=r.queryId,a=Ie(s,t);return fr(e,s,new Mt(Dt(o),a,n))}return[]}function nr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t._path;let o=null,a=!1;e.syncPointTree_.foreachOnPath(i,((e,t)=>{const n=Ie(e,i);o=o||Kn(t,n),a=a||Hn(t)}));let c,l=e.syncPointTree_.get(i);if(l?(a=a||Hn(l),o=o||Kn(l,pe())):(l=new Fn,e.syncPointTree_=e.syncPointTree_.set(i,l)),null!=o)c=!0;else{c=!1,o=it.EMPTY_NODE;e.syncPointTree_.subtree(i).foreachChild(((e,t)=>{const n=Kn(t,pe());n&&(o=o.updateImmediateChild(e,n))}))}const u=Wn(l,t);if(!u&&!t._queryParams.loadsAllData()){const n=ur(t);(0,s.vA)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=Qn++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let h=Bn(l,t,n,sn(e.pendingWriteTree_,i),o,c);if(!u&&!a&&!r){const n=zn(l,t);h=h.concat(function(e,t,n){const r=t._path,i=lr(e,t),o=cr(e,n),a=e.listenProvider_.startListening(pr(t),i,o.hashFn,o.onComplete),c=e.syncPointTree_.subtree(r);if(i)(0,s.vA)(!Hn(c.value),"If we're adding a query, it shouldn't be shadowed");else{const t=c.fold(((e,t,n)=>{if(!Ee(e)&&t&&Hn(t))return[Gn(t).query];{let e=[];return t&&(e=e.concat(Vn(t).map((e=>e.query)))),L(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(pr(r),lr(e,r))}}return a}(e,t,n))}return h}function rr(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=Kn(n,Ie(e,t));if(r)return r}));return un(r,t,i,n,!0)}function ir(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=Ie(e,n);r=r||Kn(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||Kn(i,pe()):(i=new Fn,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new Ft(r,!0,!1):null;return function(e){return Kt(e.viewCache_)}(jn(i,t,sn(e.pendingWriteTree_,t._path),s?o.getNode():it.EMPTY_NODE,s))}function sr(e,t){return or(t,e.syncPointTree_,null,sn(e.pendingWriteTree_,pe()))}function or(e,t,n,r){if(Ee(e.path))return ar(e,t,n,r);{const i=t.get(pe());null==n&&null!=i&&(n=Kn(i,pe()));let s=[];const o=ge(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=_n(r,o);s=s.concat(or(a,c,e,t))}return i&&(s=s.concat(Un(i,e,r,n))),s}}function ar(e,t,n,r){const i=t.get(pe());null==n&&null!=i&&(n=Kn(i,pe()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=_n(r,t),c=e.operationForChild(t);c&&(s=s.concat(ar(c,i,o,a)))})),i&&(s=s.concat(Un(i,e,r,n))),s}function cr(e,t){const n=t.query,r=lr(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||it.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=hr(e,n);if(r){const n=dr(r),i=n.path,s=n.queryId,o=Ie(i,t);return fr(e,i,new Nt(Dt(s),o))}return[]}(e,n._path,r):function(e,t){return sr(e,new Nt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return er(e,n,null,r)}}}}function lr(e,t){const n=ur(t);return e.queryToTagMap.get(n)}function ur(e){return e._path.toString()+"$"+e._queryIdentifier}function hr(e,t){return e.tagToQueryMap.get(t)}function dr(e){const t=e.indexOf("$");return(0,s.vA)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new fe(e.substr(0,t))}}function fr(e,t,n){const r=e.syncPointTree_.get(t);(0,s.vA)(r,"Missing sync point for query tag that we're tracking");return Un(r,n,sn(e.pendingWriteTree_,t),null)}function pr(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new((0,s.vA)(Ln,"Reference.ts has not been loaded"),Ln)(e._repo,e._path):e}class gr{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new gr(t)}node(){return this.node_}}class mr{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=be(this.path_,e);return new mr(this.syncTree_,t)}node(){return rr(this.syncTree_,this.path_)}}const _r=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},vr=function(e,t,n){return e&&"object"===typeof e?((0,s.vA)(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?yr(e[".sv"],t,n):"object"===typeof e[".sv"]?wr(e[".sv"],t):void(0,s.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},yr=function(e,t,n){if("timestamp"===e)return n.timestamp;(0,s.vA)(!1,"Unexpected server value: "+e)},wr=function(e,t,n){e.hasOwnProperty("increment")||(0,s.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!==typeof r&&(0,s.vA)(!1,"Unexpected increment value: "+r);const i=t.node();if((0,s.vA)(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!==typeof o?r:o+r},br=function(e,t,n,r){return Ir(t,new mr(n,e),r)},Er=function(e,t,n){return Ir(e,new gr(t),n)};function Ir(e,t,n){const r=e.getPriority().val(),i=vr(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=vr(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new Ye(s,at(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new Ye(i))),r.forEachChild($e,((e,r)=>{const i=Ir(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}class Tr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function Cr(e,t){let n=t instanceof fe?t:new fe(t),r=e,i=ge(n);for(;null!==i;){const e=(0,s.yw)(r.node.children,i)||{children:{},childCount:0};r=new Tr(i,r,e),n=_e(n),i=ge(n)}return r}function Sr(e){return e.node.value}function kr(e,t){e.node.value=t,Dr(e)}function xr(e){return e.node.childCount>0}function Pr(e,t){L(e.node.children,((n,r)=>{t(new Tr(n,e,r))}))}function Ar(e,t,n,r){n&&!r&&t(e),Pr(e,(e=>{Ar(e,t,!0,r)})),n&&r&&t(e)}function Or(e){return new fe(null===e.parent?e.name:Or(e.parent)+"/"+e.name)}function Dr(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===Sr(e)&&!xr(e)}(n),i=(0,s.gR)(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Dr(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Dr(e))}(e.parent,e.name,e)}const Rr=/[\[\].#$\/\u0000-\u001F\u007F]/,Nr=/[\[\].#$\u0000-\u001F\u007F]/,Mr=10485760,Lr=function(e){return"string"===typeof e&&0!==e.length&&!Rr.test(e)},Fr=function(e){return"string"===typeof e&&0!==e.length&&!Nr.test(e)},Ur=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!x(e)||e&&"object"===typeof e&&(0,s.gR)(e,".sv")},jr=function(e,t,n,r){r&&void 0===t||Br((0,s.dI)(e,"value"),t,n)},Br=function(e,t,n){const r=n instanceof fe?new ke(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Pe(r));if("function"===typeof t)throw new Error(e+"contains a function "+Pe(r)+" with contents = "+t.toString());if(x(t))throw new Error(e+"contains "+t.toString()+" "+Pe(r));if("string"===typeof t&&t.length>Mr/3&&(0,s.OE)(t)>Mr)throw new Error(e+"contains a string greater than "+Mr+" utf8 bytes "+Pe(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,i=!1;if(L(t,((t,o)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Lr(t)))throw new Error(e+" contains an invalid key ("+t+") "+Pe(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=(0,s.OE)(t),xe(e)}(r,t),Br(e,o,r),function(e){const t=e.parts_.pop();e.byteLength_-=(0,s.OE)(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Pe(r)+" in addition to actual children.")}},qr=function(e,t,n,r){if(r&&void 0===t)return;const i=(0,s.dI)(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const o=[];L(t,((e,t)=>{const r=new fe(e);if(Br(i,t,be(n,r)),".priority"===ve(r)&&!Ur(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=ye(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!Lr(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Te);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&Se(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,o)},Vr=function(e,t,n){if(!n||void 0!==t){if(x(t))throw new Error((0,s.dI)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ur(t))throw new Error((0,s.dI)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Kr=function(e,t,n,r){if((!r||void 0!==n)&&!Lr(n))throw new Error((0,s.dI)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},zr=function(e,t,n,r){if((!r||void 0!==n)&&!Fr(n))throw new Error((0,s.dI)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Wr=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),zr(e,t,n,r)},Hr=function(e,t){if(".info"===ge(t))throw new Error(e+" failed = Can't modify data under /.info/")},Gr=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!Lr(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Fr(e)}(n))throw new Error((0,s.dI)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Qr{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Yr(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||Ce(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function $r(e,t,n){Yr(e,n),Xr(e,(e=>Ce(e,t)))}function Jr(e,t,n){Yr(e,n),Xr(e,(e=>Se(e,t)||Se(t,e)))}function Xr(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(Zr(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Zr(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();w&&I("event: "+n.toString()),B(r)}}}const ei="repo_interrupt",ti=25;class ni{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Qr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ct(),this.transactionQueueTree_=new Tr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ri(e,t,n){if(e.stats_=te(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new It(e.repoInfo_,((t,n,r,i)=>{oi(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>ai(e,!0)),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,s.As)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new De(e.repoInfo_,t,((t,n,r,i)=>{oi(e,t,n,r,i)}),(t=>{ai(e,t)}),(t=>{!function(e,t){L(t,((t,n)=>{ci(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return ee[n]||(ee[n]=t()),ee[n]}(e.repoInfo_,(()=>new At(e.stats_,e.server_))),e.infoData_=new Tt,e.infoSyncTree_=new Yn({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=Zn(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),ci(e,"connected",!1),e.serverSyncTree_=new Yn({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);Jr(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function ii(e){const t=e.infoData_.getNode(new fe(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function si(e){return _r({timestamp:ii(e)})}function oi(e,t,n,r,i){e.dataUpdateCount++;const o=new fe(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let a=[];if(i)if(r){const t=(0,s.kH)(n,(e=>at(e)));a=function(e,t,n,r){const i=hr(e,r);if(i){const r=dr(i),s=r.path,o=r.queryId,a=Ie(s,t),c=Ht.fromObject(n);return fr(e,s,new Lt(Dt(o),a,c))}return[]}(e.serverSyncTree_,o,t,i)}else{const t=at(n);a=tr(e.serverSyncTree_,o,t,i)}else if(r){const t=(0,s.kH)(n,(e=>at(e)));a=function(e,t,n){const r=Ht.fromObject(n);return sr(e,new Lt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,o,t)}else{const t=at(n);a=Zn(e.serverSyncTree_,o,t)}let c=o;a.length>0&&(c=yi(e,o)),Jr(e.eventQueue_,c,a)}function ai(e,t){ci(e,"connected",t),!1===t&&function(e){gi(e,"onDisconnectEvents");const t=si(e),n=Ct();xt(e.onDisconnect_,pe(),((r,i)=>{const s=br(r,i,e.serverSyncTree_,t);St(n,r,s)}));let r=[];xt(n,pe(),((t,n)=>{r=r.concat(Zn(e.serverSyncTree_,t,n));const i=Ti(e,t);yi(e,i)})),e.onDisconnect_=Ct(),Jr(e.eventQueue_,pe(),r)}(e)}function ci(e,t,n){const r=new fe("/.info/"+t),i=at(n);e.infoData_.updateSnapshot(r,i);const s=Zn(e.infoSyncTree_,r,i);Jr(e.eventQueue_,r,s)}function li(e){return e.nextWriteId_++}function ui(e,t,n,r,i){gi(e,"set",{path:t.toString(),value:n,priority:r});const s=si(e),o=at(n,r),a=rr(e.serverSyncTree_,t),c=Er(o,a,s),l=li(e),u=$n(e.serverSyncTree_,t,c,l,!0);Yr(e.eventQueue_,u),e.server_.put(t.toString(),o.val(!0),((n,r)=>{const s="ok"===n;s||k("set at "+t+" failed: "+n);const o=Xn(e.serverSyncTree_,l,!s);Jr(e.eventQueue_,t,o),mi(e,i,n,r)}));const h=Ti(e,t);yi(e,h),Jr(e.eventQueue_,h,[])}function hi(e,t,n){e.server_.onDisconnectCancel(t.toString(),((r,i)=>{"ok"===r&&kt(e.onDisconnect_,t),mi(e,n,r,i)}))}function di(e,t,n,r){const i=at(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),((n,s)=>{"ok"===n&&St(e.onDisconnect_,t,i),mi(e,r,n,s)}))}function fi(e,t,n){let r;r=".info"===ge(t._path)?er(e.infoSyncTree_,t,n):er(e.serverSyncTree_,t,n),$r(e.eventQueue_,t._path,r)}function pi(e){e.persistentConnection_&&e.persistentConnection_.interrupt(ei)}function gi(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];I(t,...r)}function mi(e,t,n,r){t&&B((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function _i(e,t,n){return rr(e.serverSyncTree_,t,n)||it.EMPTY_NODE}function vi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||Ii(e,t),Sr(t)){const n=bi(e,t);(0,s.vA)(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=_i(e,t,r);let o=i;const a=i.hash();for(let u=0;u<n.length;u++){const e=n[u];(0,s.vA)(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const r=Ie(t,e.path);o=o.updateChild(r,e.currentOutputSnapshotRaw)}const c=o.val(!0),l=t;e.server_.put(l.toString(),c,(r=>{gi(e,"transaction put response",{path:l.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(Xn(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();Ii(e,Cr(e.transactionQueueTree_,t)),vi(e,e.transactionQueueTree_),Jr(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)B(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{k("transaction at "+l.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}yi(e,t)}}),a)}(e,Or(t),n)}else xr(t)&&Pr(t,(t=>{vi(e,t)}))}function yi(e,t){const n=wi(e,t),r=Or(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const o=t.filter((e=>0===e.status)),a=o.map((e=>e.currentWriteId));for(let l=0;l<t.length;l++){const o=t[l],u=Ie(n,o.path);let h,d=!1;if((0,s.vA)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===o.status)d=!0,h=o.abortReason,i=i.concat(Xn(e.serverSyncTree_,o.currentWriteId,!0));else if(0===o.status)if(o.retryCount>=ti)d=!0,h="maxretry",i=i.concat(Xn(e.serverSyncTree_,o.currentWriteId,!0));else{const n=_i(e,o.path,a);o.currentInputSnapshot=n;const r=t[l].update(n.val());if(void 0!==r){Br("transaction failed: Data returned ",r,o.path);let t=at(r);"object"===typeof r&&null!=r&&(0,s.gR)(r,".priority")||(t=t.updatePriority(n.getPriority()));const c=o.currentWriteId,l=si(e),u=Er(t,n,l);o.currentOutputSnapshotRaw=t,o.currentOutputSnapshotResolved=u,o.currentWriteId=li(e),a.splice(a.indexOf(c),1),i=i.concat($n(e.serverSyncTree_,o.path,u,o.currentWriteId,o.applyLocally)),i=i.concat(Xn(e.serverSyncTree_,c,!0))}else d=!0,h="nodata",i=i.concat(Xn(e.serverSyncTree_,o.currentWriteId,!0))}Jr(e.eventQueue_,n,i),i=[],d&&(t[l].status=2,c=t[l].unwatcher,setTimeout(c,Math.floor(0)),t[l].onComplete&&("nodata"===h?r.push((()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot))):r.push((()=>t[l].onComplete(new Error(h),!1,null)))))}var c;Ii(e,e.transactionQueueTree_);for(let s=0;s<r.length;s++)B(r[s]);vi(e,e.transactionQueueTree_)}(e,bi(e,n),r),r}function wi(e,t){let n,r=e.transactionQueueTree_;for(n=ge(t);null!==n&&void 0===Sr(r);)r=Cr(r,n),n=ge(t=_e(t));return r}function bi(e,t){const n=[];return Ei(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function Ei(e,t,n){const r=Sr(t);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Pr(t,(t=>{Ei(e,t,n)}))}function Ii(e,t){const n=Sr(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,kr(t,n.length>0?n:void 0)}Pr(t,(t=>{Ii(e,t)}))}function Ti(e,t){const n=Or(wi(e,t)),r=Cr(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{Ci(e,t)})),Ci(e,r),Ar(r,(t=>{Ci(e,t)})),n}function Ci(e,t){const n=Sr(t);if(n){const r=[];let i=[],o=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?((0,s.vA)(o===t-1,"All SENT items should be at beginning of queue."),o=t,n[t].status=3,n[t].abortReason="set"):((0,s.vA)(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(Xn(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?kr(t,void 0):n.length=o+1,Jr(e.eventQueue_,Or(t),i);for(let e=0;e<r.length;e++)B(r[e])}}const Si=function(e,t){const n=ki(e),r=n.namespace;"firebase.com"===n.domain&&S(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||S("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&k("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new $(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new fe(n.pathString)}},ki=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"===typeof e){let l=e.indexOf("//");l>=0&&(a=e.substring(0,l-1),e=e.substring(l+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let e=n[i];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(r){}t+="/"+e}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):k("Invalid query segment '".concat(n,"' in query '").concat(e,"'"))}return t}(e.substring(Math.min(e.length,h)));l=t.indexOf(":"),l>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(l+1),10)):l=t.length;const f=t.slice(0,l);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},xi="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Pi=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const o=new Array(8);for(i=7;i>=0;i--)o[i]=xi.charAt(n%64),n=Math.floor(n/64);(0,s.vA)(0===n,"Cannot push at time == 0");let a=o.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)a+=xi.charAt(t[i]);return(0,s.vA)(20===a.length,"nextPushId: Length should be 20."),a}}();class Ai{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,s.As)(this.snapshot.exportVal())}}class Oi{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Di{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,s.vA)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Ri{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new s.cY;return hi(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){Hr("OnDisconnect.remove",this._path);const e=new s.cY;return di(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){Hr("OnDisconnect.set",this._path),jr("OnDisconnect.set",e,this._path,!1);const t=new s.cY;return di(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){Hr("OnDisconnect.setWithPriority",this._path),jr("OnDisconnect.setWithPriority",e,this._path,!1),Vr("OnDisconnect.setWithPriority",t,!1);const n=new s.cY;return function(e,t,n,r,i){const s=at(n,r);e.server_.onDisconnectPut(t.toString(),s.val(!0),((n,r)=>{"ok"===n&&St(e.onDisconnect_,t,s),mi(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){Hr("OnDisconnect.update",this._path),qr("OnDisconnect.update",e,this._path,!1);const t=new s.cY;return function(e,t,n,r){if((0,s.Im)(n))return I("onDisconnect().update() called with empty data.  Don't do anything."),void mi(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,((i,s)=>{"ok"===i&&L(n,((n,r)=>{const i=at(r);St(e.onDisconnect_,be(t,n),i)})),mi(0,r,i,s)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}class Ni{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Ee(this._path)?null:ve(this._path)}get ref(){return new Ui(this._repo,this._path)}get _queryIdentifier(){const e=Et(this._queryParams),t=N(e);return"{}"===t?"default":t}get _queryObject(){return Et(this._queryParams)}isEqual(e){if(!((e=(0,s.Ku)(e))instanceof Ni))return!1;const t=this._repo===e._repo,n=Ce(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function Mi(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Li(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Fe){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==P)throw new Error(r);if("string"!==typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==A)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(e.getIndex()===$e){if(null!=t&&!Ur(t)||null!=n&&!Ur(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,s.vA)(e.getIndex()instanceof ct||e.getIndex()===lt,"unknown index type."),null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Fi(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ui extends Ni{constructor(e,t){super(e,t,new _t,!1)}get parent(){const e=we(this._path);return null===e?null:new Ui(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class ji{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new fe(e),n=Vi(this.ref,e);return new ji(this._node.getChild(t),n,$e)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new ji(n,Vi(this.ref,t),$e))))}hasChild(e){const t=new fe(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Bi(e,t){return(e=(0,s.Ku)(e))._checkNotDeleted("ref"),void 0!==t?Vi(e._root,t):e._root}function qi(e,t){(e=(0,s.Ku)(e))._checkNotDeleted("refFromURL");const n=Si(t,e._repo.repoInfo_.nodeAdmin);Gr("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||S("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Bi(e,n.path.toString())}function Vi(e,t){return null===ge((e=(0,s.Ku)(e))._path)?Wr("child","path",t,!1):zr("child","path",t,!1),new Ui(e._repo,be(e._path,t))}function Ki(e){return e=(0,s.Ku)(e),new Ri(e._repo,e._path)}function zi(e,t){e=(0,s.Ku)(e),Hr("push",e._path),jr("push",t,e._path,!0);const n=ii(e._repo),r=Pi(n),i=Vi(e,r),o=Vi(e,r);let a;return a=null!=t?Hi(o,t).then((()=>o)):Promise.resolve(o),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function Wi(e){return Hr("remove",e._path),Hi(e,null)}function Hi(e,t){e=(0,s.Ku)(e),Hr("set",e._path),jr("set",t,e._path,!1);const n=new s.cY;return ui(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function Gi(e,t){e=(0,s.Ku)(e),Hr("setPriority",e._path),Vr("setPriority",t,!1);const n=new s.cY;return ui(e._repo,be(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}function Qi(e,t,n){if(Hr("setWithPriority",e._path),jr("setWithPriority",t,e._path,!1),Vr("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new s.cY;return ui(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}function Yi(e,t){qr("update",t,e._path,!1);const n=new s.cY;return function(e,t,n,r){gi(e,"update",{path:t.toString(),value:n});let i=!0;const s=si(e),o={};if(L(n,((n,r)=>{i=!1,o[n]=br(be(t,n),at(r),e.serverSyncTree_,s)})),i)I("update() called with empty data.  Don't do anything."),mi(0,r,"ok",void 0);else{const i=li(e),s=Jn(e.serverSyncTree_,t,o,i);Yr(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||k("update at "+t+" failed: "+n);const a=Xn(e.serverSyncTree_,i,!o),c=a.length>0?yi(e,t):t;Jr(e.eventQueue_,c,a),mi(0,r,n,s)})),L(n,(n=>{const r=Ti(e,be(t,n));yi(e,r)})),Jr(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function $i(e){e=(0,s.Ku)(e);const t=new Di((()=>{})),n=new Ji(t);return function(e,t,n){const r=ir(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const i=at(r).withIndex(t._queryParams.getIndex());let s;if(nr(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())s=Zn(e.serverSyncTree_,t._path,i);else{const n=lr(e.serverSyncTree_,t);s=tr(e.serverSyncTree_,t._path,i,n)}return Jr(e.eventQueue_,t._path,s),er(e.serverSyncTree_,t,n,null,!0),i}),(n=>(gi(e,"get for query "+(0,s.As)(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new ji(t,new Ui(e._repo,e._path),e._queryParams.getIndex())))}class Ji{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new Ai("value",this,new ji(e.snapshotNode,new Ui(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Oi(this,e,t):null}matches(e){return e instanceof Ji&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Xi{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Oi(this,e,t):null}createEvent(e,t){(0,s.vA)(null!=e.childName,"Child events should have a childName.");const n=Vi(new Ui(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Ai(e.type,this,new ji(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Xi&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function Zi(e,t,n,r,i){let s;if("object"===typeof r&&(s=void 0,i=r),"function"===typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{fi(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new Di(n,s||void 0),a="value"===t?new Ji(o):new Xi(t,o);return function(e,t,n){let r;r=".info"===ge(t._path)?nr(e.infoSyncTree_,t,n):nr(e.serverSyncTree_,t,n),$r(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>fi(e._repo,e,a)}function es(e,t,n,r){return Zi(e,"value",t,n,r)}function ts(e,t,n,r){return Zi(e,"child_added",t,n,r)}function ns(e,t,n,r){return Zi(e,"child_changed",t,n,r)}function rs(e,t,n,r){return Zi(e,"child_moved",t,n,r)}function is(e,t,n,r){return Zi(e,"child_removed",t,n,r)}function ss(e,t,n){let r=null;const i=n?new Di(n):null;"value"===t?r=new Ji(i):t&&(r=new Xi(t,i)),fi(e._repo,e,r)}class os{}class as extends os{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){jr("endAt",this._value,e._path,!0);const t=yt(e._queryParams,this._value,this._key);if(Fi(t),Li(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ni(e._repo,e._path,t,e._orderByCalled)}}function cs(e,t){return Kr("endAt","key",t,!0),new as(e,t)}class ls extends os{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){jr("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===Fe||n?yt(e,t,n):yt(e,t,P),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(Fi(t),Li(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ni(e._repo,e._path,t,e._orderByCalled)}}function us(e,t){return Kr("endBefore","key",t,!0),new ls(e,t)}class hs extends os{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){jr("startAt",this._value,e._path,!0);const t=vt(e._queryParams,this._value,this._key);if(Fi(t),Li(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ni(e._repo,e._path,t,e._orderByCalled)}}function ds(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return Kr("startAt","key",t,!0),new hs(e,t)}class fs extends os{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){jr("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===Fe||n?vt(e,t,n):vt(e,t,A),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(Fi(t),Li(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ni(e._repo,e._path,t,e._orderByCalled)}}function ps(e,t){return Kr("startAfter","key",t,!0),new fs(e,t)}class gs extends os{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ni(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}function ms(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new gs(e)}class _s extends os{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ni(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}function vs(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new _s(e)}class ys extends os{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Mi(e,"orderByChild");const t=new fe(this._path);if(Ee(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new ct(t),r=wt(e._queryParams,n);return Li(r),new Ni(e._repo,e._path,r,!0)}}function ws(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return zr("orderByChild","path",e,!1),new ys(e)}class bs extends os{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Mi(e,"orderByKey");const t=wt(e._queryParams,Fe);return Li(t),new Ni(e._repo,e._path,t,!0)}}function Es(){return new bs}class Is extends os{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Mi(e,"orderByPriority");const t=wt(e._queryParams,$e);return Li(t),new Ni(e._repo,e._path,t,!0)}}function Ts(){return new Is}class Cs extends os{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Mi(e,"orderByValue");const t=wt(e._queryParams,lt);return Li(t),new Ni(e._repo,e._path,t,!0)}}function Ss(){return new Cs}class ks extends os{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(jr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new as(this._value,this._key)._apply(new hs(this._value,this._key)._apply(e))}}function xs(e,t){return Kr("equalTo","key",t,!0),new ks(e,t)}function Ps(e){let t=(0,s.Ku)(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(const s of r)t=s._apply(t);return t}!function(e){(0,s.vA)(!Mn,"__referenceConstructor has already been defined"),Mn=e}(Ui),function(e){(0,s.vA)(!Ln,"__referenceConstructor has already been defined"),Ln=e}(Ui);const As="FIREBASE_DATABASE_EMULATOR_HOST",Os={};let Ds=!1;function Rs(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||S("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),I("Using default host for project ",e.options.projectId),s="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));let o,a,c=Si(s,i),l=c.repoInfo;"undefined"!==typeof process&&(a={NODE_ENV:"production",PUBLIC_URL:"/rudra-chat",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[As]),a?(o=!0,s="http://".concat(a,"?ns=").concat(l.namespace),c=Si(s,i),l=c.repoInfo):o=!c.repoInfo.secure;const u=i&&o?new z(z.OWNER):new K(e.name,e.options,t);Gr("Invalid Firebase Database URL",c),Ee(c.path)||S("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=Os[t.name];i||(i={},Os[t.name]=i);let s=i[e.toURLString()];s&&S("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new ni(e,Ds,n,r),i[e.toURLString()]=s,s}(l,e,u,new V(e,n));return new Ns(h,e)}class Ns{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ri(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ui(this._repo,pe())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=Os[t];n&&n[e.key]===e||S("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),pi(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&S("Cannot call "+e+" on a deleted database.")}}function Ms(){ce.IS_TRANSPORT_INITIALIZED&&k("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Ls(){Ms(),ie.forceDisallow()}function Fs(){Ms(),ae.forceDisallow(),ie.forceAllow()}function Us(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=(0,s.Ku)(e))._checkNotDeleted("useEmulator");const i="".concat(t,":").concat(n),o=e._repoInternal;if(e._instanceStarted){if(i===e._repoInternal.repoInfo_.host&&(0,s.bD)(r,o.repoInfo_.emulatorOptions))return;S("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&S('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new z(z.OWNER);else if(r.mockUserToken){const t="string"===typeof r.mockUserToken?r.mockUserToken:(0,s.Fy)(r.mockUserToken,e.app.options.projectId);a=new z(t)}(0,s.zJ)(t)&&((0,s.gE)(t),(0,s.P1)("Database",!0)),function(e,t,n,r){const i=t.lastIndexOf(":"),o=t.substring(0,i),a=(0,s.zJ)(o);e.repoInfo_=new $(t,a,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(e.authTokenProvider_=r)}(o,i,r,a)}function js(e){(e=(0,s.Ku)(e))._checkNotDeleted("goOffline"),pi(e._repo)}function Bs(e){var t;(e=(0,s.Ku)(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(ei)}function qs(e,t){E(e,t)}const Vs={".sv":"timestamp"};function Ks(){return Vs}function zs(e){return{".sv":{increment:e}}}class Ws{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Hs(e,t,n){var r;if(e=(0,s.Ku)(e),Hr("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,o=new s.cY,a=es(e,(()=>{}));return function(e,t,n,r,i,o){gi(e,"transaction on "+t);const a={path:t,update:n,onComplete:r,status:null,order:_(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},c=_i(e,t,void 0);a.currentInputSnapshot=c;const l=a.update(c.val());if(void 0===l)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{Br("transaction failed: Data returned ",l,a.path),a.status=0;const n=Cr(e.transactionQueueTree_,t),r=Sr(n)||[];let i;r.push(a),kr(n,r),"object"===typeof l&&null!==l&&(0,s.gR)(l,".priority")?(i=(0,s.yw)(l,".priority"),(0,s.vA)(Ur(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(rr(e.serverSyncTree_,t)||it.EMPTY_NODE).getPriority().val();const o=si(e),u=at(l,i),h=Er(u,c,o);a.currentOutputSnapshotRaw=u,a.currentOutputSnapshotResolved=h,a.currentWriteId=li(e);const d=$n(e.serverSyncTree_,t,h,a.currentWriteId,a.applyLocally);Jr(e.eventQueue_,t,d),vi(e,e.transactionQueueTree_)}}(e._repo,e._path,t,((t,n,r)=>{let i=null;t?o.reject(t):(i=new ji(r,new Ui(e._repo,e._path),$e),o.resolve(new Ws(n,i)))}),a,i),o.promise}De.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},De.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Gs;u(r.SDK_VERSION),(0,r._registerComponent)(new i.uA("database",((e,t)=>{let{instanceIdentifier:n}=t;return Rs(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),(0,r.registerVersion)(a,c,Gs),(0,r.registerVersion)(a,c,"esm2017")},314:(e,t,n)=>{n.d(t,{d$:()=>G});var r=n(379),i=n(705),s=n(607);const o=0xffffffffffffffffn;function a(e,t){return 0xffffffffffffffffn&(e<<t|e>>64n-t)}function c(e,t){return e*t&o}const l=(u=0xa187eb39cdcaed8f31c4b365b102e01en,function(){let e=BigInt(u&o),t=BigInt(u>>64n&o);const n=c(a(c(e,5n),7n),9n);return t^=e,e=(a(e,24n)^t^t<<16n)&o,t=a(t,37n),u=t<<64n|e,n});var u;const h=Array.from({length:2},(()=>Array.from({length:6},(()=>Array.from({length:128},(()=>l())))))),d=Array.from({length:8},(()=>l())),f=Array.from({length:16},(()=>l())),p=l(),g="w",m="b",_="p",v="b",y="r",w="q",b="k",E="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class I{constructor(e,t){(0,i.A)(this,"color",void 0),(0,i.A)(this,"from",void 0),(0,i.A)(this,"to",void 0),(0,i.A)(this,"piece",void 0),(0,i.A)(this,"captured",void 0),(0,i.A)(this,"promotion",void 0),(0,i.A)(this,"flags",void 0),(0,i.A)(this,"san",void 0),(0,i.A)(this,"lan",void 0),(0,i.A)(this,"before",void 0),(0,i.A)(this,"after",void 0);const{color:n,piece:r,from:s,to:o,flags:a,captured:c,promotion:l}=t,u=V(s),h=V(o);this.color=n,this.piece=r,this.from=u,this.to=h,this.san=e._moveToSan(t,e._moves({legal:!0})),this.lan=u+h,this.before=e.fen(),e._makeMove(t),this.after=e.fen(),e._undoMove(),this.flags="";for(const i in S)S[i]&a&&(this.flags+=C[i]);c&&(this.captured=c),l&&(this.promotion=l,this.lan+=l)}isCapture(){return this.flags.indexOf(C.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(C.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(C.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(C.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(C.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(C.BIG_PAWN)>-1}}const T=-1,C={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},S={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},k={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},x=(0,r.A)((0,r.A)({},k),{WhiteTitle:null,BlackTitle:null,WhiteElo:null,BlackElo:null,WhiteUSCF:null,BlackUSCF:null,WhiteNA:null,BlackNA:null,WhiteType:null,BlackType:null,EventDate:null,EventSponsor:null,Section:null,Stage:null,Board:null,Opening:null,Variation:null,SubVariation:null,ECO:null,NIC:null,Time:null,UTCTime:null,UTCDate:null,TimeControl:null,SetUp:null,FEN:null,Termination:null,Annotator:null,Mode:null,PlyCount:null}),P={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},A={b:[16,32,17,15],w:[-16,-32,-17,-15]},O={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},D=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],R=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],N={p:1,n:2,b:4,r:8,q:16,k:32},M=["n",v,y,w],L={[b]:S.KSIDE_CASTLE,[w]:S.QSIDE_CASTLE},F={w:[{square:P.a1,flag:S.QSIDE_CASTLE},{square:P.h1,flag:S.KSIDE_CASTLE}],b:[{square:P.a8,flag:S.QSIDE_CASTLE},{square:P.h8,flag:S.KSIDE_CASTLE}]},U={b:1,w:6};function j(e){return e>>4}function B(e){return 15&e}function q(e){return-1!=="0123456789".indexOf(e)}function V(e){const t=B(e),n=j(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(n,n+1)}function K(e){return e===g?m:g}function z(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:S.NORMAL;const a=j(r);if(i!==_||7!==a&&0!==a)e.push({color:t,from:n,to:r,piece:i,captured:s,flags:o});else for(let c=0;c<M.length;c++){const a=M[c];e.push({color:t,from:n,to:r,piece:i,captured:s,promotion:a,flags:o|S.PROMOTION})}}function W(e){let t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return _}return t=t.toLowerCase(),"o"===t?b:t}function H(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class G{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,{skipValidation:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.A)(this,"_board",new Array(128)),(0,i.A)(this,"_turn",g),(0,i.A)(this,"_header",{}),(0,i.A)(this,"_kings",{w:T,b:T}),(0,i.A)(this,"_epSquare",-1),(0,i.A)(this,"_halfMoves",0),(0,i.A)(this,"_moveNumber",0),(0,i.A)(this,"_history",[]),(0,i.A)(this,"_comments",{}),(0,i.A)(this,"_castling",{w:0,b:0}),(0,i.A)(this,"_hash",0n),(0,i.A)(this,"_positionCount",new Map),this.load(e,{skipValidation:t})}clear(){let{preserveHeaders:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._board=new Array(128),this._kings={w:T,b:T},this._turn=g,this._castling={w:0,b:0},this._epSquare=T,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:(0,r.A)({},x),this._hash=this._computeHash(),this._positionCount=new Map,this._header.SetUp=null,this._header.FEN=null}load(e){let{skipValidation:t=!1,preserveHeaders:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.split(/\s+/);if(r.length>=2&&r.length<6){const t=["-","-","0","1"];e=r.concat(t.slice(-(6-r.length))).join(" ")}if(r=e.split(/\s+/),!t){const{ok:t,error:n}=function(e){const t=e.split(/\s+/);if(6!==t.length)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const n=parseInt(t[5],10);if(isNaN(n)||n<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const r=parseInt(t[4],10);if(isNaN(r)||r<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=t[0].split("/");if(8!==i.length)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let o=0;o<i.length;o++){let e=0,t=!1;for(let n=0;n<i[o].length;n++)if(q(i[o][n])){if(t)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};e+=parseInt(i[o][n],10),t=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[o][n]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};e+=1,t=!1}if(8!==e)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if("3"==t[3][1]&&"w"==t[1]||"6"==t[3][1]&&"b"==t[1])return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const s=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:o,regex:a}of s){if(!a.test(t[0]))return{ok:!1,error:"Invalid FEN: missing ".concat(o," king")};if((t[0].match(a)||[]).length>1)return{ok:!1,error:"Invalid FEN: too many ".concat(o," kings")}}return Array.from(i[0]+i[7]).some((e=>"P"===e.toUpperCase()))?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}(e);if(!t)throw new Error(n)}const i=r[0];let s=0;this.clear({preserveHeaders:n});for(let o=0;o<i.length;o++){const e=i.charAt(o);if("/"===e)s+=8;else if(q(e))s+=parseInt(e,10);else{const t=e<"a"?g:m;this._put({type:e.toLowerCase(),color:t},V(s)),s++}}this._turn=r[1],r[2].indexOf("K")>-1&&(this._castling.w|=S.KSIDE_CASTLE),r[2].indexOf("Q")>-1&&(this._castling.w|=S.QSIDE_CASTLE),r[2].indexOf("k")>-1&&(this._castling.b|=S.KSIDE_CASTLE),r[2].indexOf("q")>-1&&(this._castling.b|=S.QSIDE_CASTLE),this._epSquare="-"===r[3]?T:P[r[3]],this._halfMoves=parseInt(r[4],10),this._moveNumber=parseInt(r[5],10),this._hash=this._computeHash(),this._updateSetup(e),this._incPositionCount()}fen(){let{forceEnpassantSquare:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,n="";for(let a=P.a8;a<=P.h1;a++){if(this._board[a]){t>0&&(n+=t,t=0);const{color:e,type:r}=this._board[a];n+=e===g?r.toUpperCase():r.toLowerCase()}else t++;a+1&136&&(t>0&&(n+=t),a!==P.h1&&(n+="/"),t=0,a+=8)}let r="";this._castling[g]&S.KSIDE_CASTLE&&(r+="K"),this._castling[g]&S.QSIDE_CASTLE&&(r+="Q"),this._castling[m]&S.KSIDE_CASTLE&&(r+="k"),this._castling[m]&S.QSIDE_CASTLE&&(r+="q"),r=r||"-";let i="-";if(this._epSquare!==T)if(e)i=V(this._epSquare);else{const e=this._epSquare+(this._turn===g?16:-16),t=[e+1,e-1];for(const n of t){var s,o;if(136&n)continue;const e=this._turn;if((null===(s=this._board[n])||void 0===s?void 0:s.color)===e&&(null===(o=this._board[n])||void 0===o?void 0:o.type)===_){this._makeMove({color:e,from:n,to:this._epSquare,piece:_,captured:_,flags:S.EP_CAPTURE});const t=!this._isKingAttacked(e);if(this._undoMove(),t){i=V(this._epSquare);break}}}}return[n,this._turn,r,i,this._halfMoves,this._moveNumber].join(" ")}_pieceKey(e){if(!this._board[e])return 0n;const{color:t,type:n}=this._board[e],r={p:0,n:1,b:2,r:3,q:4,k:5}[n];return h[{w:0,b:1}[t]][r][e]}_epKey(){return this._epSquare===T?0n:d[7&this._epSquare]}_castlingKey(){const e=this._castling.w>>5|this._castling.b>>3;return f[e]}_computeHash(){let e=0n;for(let t=P.a8;t<=P.h1;t++)136&t?t+=7:this._board[t]&&(e^=this._pieceKey(t));return e^=this._epKey(),e^=this._castlingKey(),"b"===this._turn&&(e^=p),e}_updateSetup(e){this._history.length>0||(e!==E?(this._header.SetUp="1",this._header.FEN=e):(this._header.SetUp=null,this._header.FEN=null))}reset(){this.load(E)}get(e){return this._board[P[e]]}findPiece(e){const t=[];for(let r=P.a8;r<=P.h1;r++){var n;136&r?r+=7:this._board[r]&&(null===(n=this._board[r])||void 0===n?void 0:n.color)===e.color&&this._board[r].color===e.color&&this._board[r].type===e.type&&t.push(V(r))}return t}put(e,t){let{type:n,color:r}=e;return!!this._put({type:n,color:r},t)&&(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}_set(e,t){this._hash^=this._pieceKey(e),this._board[e]=t,this._hash^=this._pieceKey(e)}_put(e,t){let{type:n,color:r}=e;if(-1==="pnbrqkPNBRQK".indexOf(n.toLowerCase()))return!1;if(!(t in P))return!1;const i=P[t];if(n==b&&this._kings[r]!=T&&this._kings[r]!=i)return!1;const s=this._board[i];return s&&s.type===b&&(this._kings[s.color]=T),this._set(i,{type:n,color:r}),n===b&&(this._kings[r]=i),!0}_clear(e){this._hash^=this._pieceKey(e),delete this._board[e]}remove(e){const t=this.get(e);return this._clear(P[e]),t&&t.type===b&&(this._kings[t.color]=T),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),t}_updateCastlingRights(){var e,t,n,r,i,s,o,a,c,l,u,h;this._hash^=this._castlingKey();const d=(null===(e=this._board[P.e1])||void 0===e?void 0:e.type)===b&&(null===(t=this._board[P.e1])||void 0===t?void 0:t.color)===g,f=(null===(n=this._board[P.e8])||void 0===n?void 0:n.type)===b&&(null===(r=this._board[P.e8])||void 0===r?void 0:r.color)===m;d&&(null===(i=this._board[P.a1])||void 0===i?void 0:i.type)===y&&(null===(s=this._board[P.a1])||void 0===s?void 0:s.color)===g||(this._castling.w&=~S.QSIDE_CASTLE),d&&(null===(o=this._board[P.h1])||void 0===o?void 0:o.type)===y&&(null===(a=this._board[P.h1])||void 0===a?void 0:a.color)===g||(this._castling.w&=~S.KSIDE_CASTLE),f&&(null===(c=this._board[P.a8])||void 0===c?void 0:c.type)===y&&(null===(l=this._board[P.a8])||void 0===l?void 0:l.color)===m||(this._castling.b&=~S.QSIDE_CASTLE),f&&(null===(u=this._board[P.h8])||void 0===u?void 0:u.type)===y&&(null===(h=this._board[P.h8])||void 0===h?void 0:h.color)===m||(this._castling.b&=~S.KSIDE_CASTLE),this._hash^=this._castlingKey()}_updateEnPassantSquare(){var e,t;if(this._epSquare===T)return;const n=this._epSquare+(this._turn===g?-16:16),r=this._epSquare+(this._turn===g?16:-16),i=[r+1,r-1];if(null!==this._board[n]||null!==this._board[this._epSquare]||(null===(e=this._board[r])||void 0===e?void 0:e.color)!==K(this._turn)||(null===(t=this._board[r])||void 0===t?void 0:t.type)!==_)return this._hash^=this._epKey(),void(this._epSquare=T);i.some((e=>{var t,n;return!(136&e)&&(null===(t=this._board[e])||void 0===t?void 0:t.color)===this._turn&&(null===(n=this._board[e])||void 0===n?void 0:n.type)===_}))||(this._hash^=this._epKey(),this._epSquare=T)}_attacked(e,t,n){const r=[];for(let i=P.a8;i<=P.h1;i++){if(136&i){i+=7;continue}if(void 0===this._board[i]||this._board[i].color!==e)continue;const s=this._board[i],o=i-t;if(0===o)continue;const a=o+119;if(D[a]&N[s.type]){if(s.type===_){if(o>0&&s.color===g||o<=0&&s.color===m){if(!n)return!0;r.push(V(i))}continue}if("n"===s.type||"k"===s.type){if(n){r.push(V(i));continue}return!0}const e=R[a];let c=i+e,l=!1;for(;c!==t;){if(null!=this._board[c]){l=!0;break}c+=e}if(!l){if(n){r.push(V(i));continue}return!0}}}return!!n&&r}attackers(e,t){return t?this._attacked(t,P[e],!0):this._attacked(this._turn,P[e],!0)}_isKingAttacked(e){const t=this._kings[e];return-1!==t&&this._attacked(K(e),t)}hash(){return this._hash.toString(16)}isAttacked(e,t){return this._attacked(t,P[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&0===this._moves().length}isStalemate(){return!this.isCheck()&&0===this._moves().length}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},t=[];let n=0,r=0;for(let i=P.a8;i<=P.h1;i++){if(r=(r+1)%2,136&i){i+=7;continue}const s=this._board[i];s&&(e[s.type]=s.type in e?e[s.type]+1:1,s.type===v&&t.push(r),n++)}if(2===n)return!0;if(3===n&&(1===e[v]||1===e.n))return!0;if(n===e[v]+2){let e=0;const n=t.length;for(let r=0;r<n;r++)e+=t[r];if(0===e||e===n)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this._hash)>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isDraw()}moves(){let{verbose:e=!1,square:t,piece:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this._moves({square:t,piece:n});return e?r.map((e=>new I(this,e))):r.map((e=>this._moveToSan(e,r)))}_moves(){let{legal:e=!0,piece:t,square:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=n?n.toLowerCase():void 0,i=null===t||void 0===t?void 0:t.toLowerCase(),s=[],o=this._turn,a=K(o);let c=P.a8,l=P.h1,u=!1;if(r){if(!(r in P))return[];c=l=P[r],u=!0}for(let f=c;f<=l;f++){if(136&f){f+=7;continue}if(!this._board[f]||this._board[f].color===a)continue;const{type:e}=this._board[f];let t;if(e===_){if(i&&i!==e)continue;t=f+A[o][0],this._board[t]||(z(s,o,f,t,_),t=f+A[o][1],U[o]!==j(f)||this._board[t]||z(s,o,f,t,_,void 0,S.BIG_PAWN));for(let e=2;e<4;e++){var h;t=f+A[o][e],136&t||((null===(h=this._board[t])||void 0===h?void 0:h.color)===a?z(s,o,f,t,_,this._board[t].type,S.CAPTURE):t===this._epSquare&&z(s,o,f,t,_,_,S.EP_CAPTURE))}}else{if(i&&i!==e)continue;for(let n=0,r=O[e].length;n<r;n++){const r=O[e][n];for(t=f;t+=r,!(136&t);){if(this._board[t]){if(this._board[t].color===o)break;z(s,o,f,t,e,this._board[t].type,S.CAPTURE);break}if(z(s,o,f,t,e),"n"===e||e===b)break}}}}if((void 0===i||i===b)&&(!u||l===this._kings[o])){if(this._castling[o]&S.KSIDE_CASTLE){const e=this._kings[o],t=e+2;this._board[e+1]||this._board[t]||this._attacked(a,this._kings[o])||this._attacked(a,e+1)||this._attacked(a,t)||z(s,o,this._kings[o],t,b,void 0,S.KSIDE_CASTLE)}if(this._castling[o]&S.QSIDE_CASTLE){const e=this._kings[o],t=e-2;this._board[e-1]||this._board[e-2]||this._board[e-3]||this._attacked(a,this._kings[o])||this._attacked(a,e-1)||this._attacked(a,t)||z(s,o,this._kings[o],t,b,void 0,S.QSIDE_CASTLE)}}if(!e||-1===this._kings[o])return s;const d=[];for(let f=0,p=s.length;f<p;f++)this._makeMove(s[f]),this._isKingAttacked(o)||d.push(s[f]),this._undoMove();return d}move(e){let{strict:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null;if("string"===typeof e)n=this._moveFromSan(e,t);else if("object"===typeof e){const t=this._moves();for(let r=0,i=t.length;r<i;r++)if(e.from===V(t[r].from)&&e.to===V(t[r].to)&&(!("promotion"in t[r])||e.promotion===t[r].promotion)){n=t[r];break}}if(!n)throw"string"===typeof e?new Error("Invalid move: ".concat(e)):new Error("Invalid move: ".concat(JSON.stringify(e)));const r=new I(this,n);return this._makeMove(n),this._incPositionCount(),r}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_movePiece(e,t){this._hash^=this._pieceKey(e),this._board[t]=this._board[e],delete this._board[e],this._hash^=this._pieceKey(t)}_makeMove(e){const t=this._turn,n=K(t);if(this._push(e),this._hash^=this._epKey(),this._hash^=this._castlingKey(),e.captured&&(this._hash^=this._pieceKey(e.to)),this._movePiece(e.from,e.to),e.flags&S.EP_CAPTURE&&(this._turn===m?this._clear(e.to-16):this._clear(e.to+16)),e.promotion&&(this._clear(e.to),this._set(e.to,{type:e.promotion,color:t})),this._board[e.to].type===b){if(this._kings[t]=e.to,e.flags&S.KSIDE_CASTLE){const t=e.to-1,n=e.to+1;this._movePiece(n,t)}else if(e.flags&S.QSIDE_CASTLE){const t=e.to+1,n=e.to-2;this._movePiece(n,t)}this._castling[t]=0}if(this._castling[t])for(let a=0,c=F[t].length;a<c;a++)if(e.from===F[t][a].square&&this._castling[t]&F[t][a].flag){this._castling[t]^=F[t][a].flag;break}if(this._castling[n])for(let a=0,c=F[n].length;a<c;a++)if(e.to===F[n][a].square&&this._castling[n]&F[n][a].flag){this._castling[n]^=F[n][a].flag;break}if(this._hash^=this._castlingKey(),e.flags&S.BIG_PAWN){var r,i,s,o;let a;a=t===m?e.to-16:e.to+16,(e.to-1&136||(null===(r=this._board[e.to-1])||void 0===r?void 0:r.type)!==_||(null===(i=this._board[e.to-1])||void 0===i?void 0:i.color)!==n)&&(e.to+1&136||(null===(s=this._board[e.to+1])||void 0===s?void 0:s.type)!==_||(null===(o=this._board[e.to+1])||void 0===o?void 0:o.color)!==n)?this._epSquare=T:(this._epSquare=a,this._hash^=this._epKey())}else this._epSquare=T;e.piece===_||e.flags&(S.CAPTURE|S.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,t===m&&this._moveNumber++,this._turn=n,this._hash^=p}undo(){const e=this._hash,t=this._undoMove();if(t){const n=new I(this,t);return this._decPositionCount(e),n}return null}_undoMove(){const e=this._history.pop();if(void 0===e)return null;this._hash^=this._epKey(),this._hash^=this._castlingKey();const t=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber,this._hash^=this._epKey(),this._hash^=this._castlingKey(),this._hash^=p;const n=this._turn,r=K(n);if(this._movePiece(t.to,t.from),t.piece&&(this._clear(t.from),this._set(t.from,{type:t.piece,color:n})),t.captured)if(t.flags&S.EP_CAPTURE){let e;e=n===m?t.to-16:t.to+16,this._set(e,{type:_,color:r})}else this._set(t.to,{type:t.captured,color:r});if(t.flags&(S.KSIDE_CASTLE|S.QSIDE_CASTLE)){let e,n;t.flags&S.KSIDE_CASTLE?(e=t.to+1,n=t.to-1):(e=t.to-2,n=t.to+1),this._movePiece(n,e)}return t}pgn(){let{newline:e="\n",maxWidth:t=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=[];let r=!1;for(const h in this._header){this._header[h]&&n.push("[".concat(h,' "').concat(this._header[h],'"]')+e),r=!0}r&&this._history.length&&n.push(e);const i=e=>{const t=this._comments[this.fen()];if("undefined"!==typeof t){const n=e.length>0?" ":"";e="".concat(e).concat(n,"{").concat(t,"}")}return e},s=[];for(;this._history.length>0;)s.push(this._undoMove());const o=[];let a="";for(0===s.length&&o.push(i(""));s.length>0;){a=i(a);const e=s.pop();if(!e)break;if(this._history.length||"b"!==e.color)"w"===e.color&&(a.length&&o.push(a),a=this._moveNumber+".");else{const e="".concat(this._moveNumber,". ...");a=a?"".concat(a," ").concat(e):e}a=a+" "+this._moveToSan(e,this._moves({legal:!0})),this._makeMove(e)}if(a.length&&o.push(i(a)),o.push(this._header.Result||"*"),0===t)return n.join("")+o.join(" ");const c=function(){return n.length>0&&" "===n[n.length-1]&&(n.pop(),!0)},l=function(r,i){for(const s of i.split(" "))if(s){if(r+s.length>t){for(;c();)r--;n.push(e),r=0}n.push(s),r+=s.length,n.push(" "),r++}return c()&&r--,r};let u=0;for(let h=0;h<o.length;h++)u+o[h].length>t&&o[h].includes("{")?u=l(u,o[h]):(u+o[h].length>t&&0!==h?(" "===n[n.length-1]&&n.pop(),n.push(e),u=0):0!==h&&(n.push(" "),u++),n.push(o[h]),u+=o[h].length);return n.join("")}header(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;r+=2)"string"===typeof t[r]&&"string"===typeof t[r+1]&&(this._header[t[r]]=t[r+1]);return this._header}setHeader(e,t){var n;return this._header[e]=null!==(n=null!==t&&void 0!==t?t:k[e])&&void 0!==n?n:null,this.getHeaders()}removeHeader(e){return e in this._header&&(this._header[e]=k[e]||null,!0)}getHeaders(){const e={};for(const[t,n]of Object.entries(this._header))null!==n&&(e[t]=n);return e}loadPgn(e){let{strict:t=!1,newlineChar:n="\r?\n"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"\r?\n"!==n&&(e=e.replace(new RegExp(n,"g"),"\n"));const r=(0,s.parse)(e);this.reset();const i=r.headers;let o="";for(const s in i)"fen"===s.toLowerCase()&&(o=i[s]),this.header(s,i[s]);if(t){if("1"===i.SetUp){if(!("FEN"in i))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(i.FEN,{preserveHeaders:!0})}}else o&&this.load(o,{preserveHeaders:!0});let a=r.root;for(;a;){if(a.move){const e=this._moveFromSan(a.move,t);if(null==e)throw new Error("Invalid move in PGN: ".concat(a.move));this._makeMove(e),this._incPositionCount()}void 0!==a.comment&&(this._comments[this.fen()]=a.comment),a=a.variations[0]}const c=r.result;c&&Object.keys(this._header).length&&this._header.Result!==c&&this.setHeader("Result",c)}_moveToSan(e,t){let n="";if(e.flags&S.KSIDE_CASTLE)n="O-O";else if(e.flags&S.QSIDE_CASTLE)n="O-O-O";else{if(e.piece!==_){const r=function(e,t){const n=e.from,r=e.to,i=e.piece;let s=0,o=0,a=0;for(let c=0,l=t.length;c<l;c++){const e=t[c].from,l=t[c].to;i===t[c].piece&&n!==e&&r===l&&(s++,j(n)===j(e)&&o++,B(n)===B(e)&&a++)}return s>0?o>0&&a>0?V(n):a>0?V(n).charAt(1):V(n).charAt(0):""}(e,t);n+=e.piece.toUpperCase()+r}e.flags&(S.CAPTURE|S.EP_CAPTURE)&&(e.piece===_&&(n+=V(e.from)[0]),n+="x"),n+=V(e.to),e.promotion&&(n+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?n+="#":n+="+"),this._undoMove(),n}_moveFromSan(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=H(e);t||("0-0"===n?n="O-O":"0-0-0"===n&&(n="O-O-O"));let r,i,s,o,a,c=W(n),l=this._moves({legal:!0,piece:c});for(let h=0,d=l.length;h<d;h++)if(n===H(this._moveToSan(l[h],l)))return l[h];if(t)return null;let u=!1;if(i=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),i?(r=i[1],s=i[2],o=i[3],a=i[4],1==s.length&&(u=!0)):(i=n.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),i&&(r=i[1],s=i[2],o=i[3],a=i[4],1==s.length&&(u=!0))),c=W(n),l=this._moves({legal:!0,piece:r||c}),!o)return null;for(let h=0,d=l.length;h<d;h++)if(s){if(!(r&&r.toLowerCase()!=l[h].piece||P[s]!=l[h].from||P[o]!=l[h].to||a&&a.toLowerCase()!=l[h].promotion))return l[h];if(u){const e=V(l[h].from);if((!r||r.toLowerCase()==l[h].piece)&&P[o]==l[h].to&&(s==e[0]||s==e[1])&&(!a||a.toLowerCase()==l[h].promotion))return l[h]}}else if(n===H(this._moveToSan(l[h],l)).replace("x",""))return l[h];return null}ascii(){let e="   +------------------------+\n";for(let t=P.a8;t<=P.h1;t++){if(0===B(t)&&(e+=" "+"87654321"[j(t)]+" |"),this._board[t]){const n=this._board[t].type;e+=" "+(this._board[t].color===g?n.toUpperCase():n.toLowerCase())+" "}else e+=" . ";t+1&136&&(e+="|\n",t+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h",e}perft(e){const t=this._moves({legal:!1});let n=0;const r=this._turn;for(let i=0,s=t.length;i<s;i++)this._makeMove(t[i]),this._isKingAttacked(r)||(e-1>0?n+=this.perft(e-1):n++),this._undoMove();return n}turn(){return this._turn}board(){const e=[];let t=[];for(let n=P.a8;n<=P.h1;n++)null==this._board[n]?t.push(null):t.push({square:V(n),type:this._board[n].type,color:this._board[n].color}),n+1&136&&(e.push(t),t=[],n+=8);return e}squareColor(e){if(e in P){const t=P[e];return(j(t)+B(t))%2===0?"light":"dark"}return null}history(){let{verbose:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[],n=[];for(;this._history.length>0;)t.push(this._undoMove());for(;;){const r=t.pop();if(!r)break;e?n.push(new I(this,r)):n.push(this._moveToSan(r,this._moves())),this._makeMove(r)}return n}_getPositionCount(e){var t;return null!==(t=this._positionCount.get(e))&&void 0!==t?t:0}_incPositionCount(){var e;this._positionCount.set(this._hash,(null!==(e=this._positionCount.get(this._hash))&&void 0!==e?e:0)+1)}_decPositionCount(e){var t;const n=null!==(t=this._positionCount.get(e))&&void 0!==t?t:0;1===n?this._positionCount.delete(e):this._positionCount.set(e,n-1)}_pruneComments(){const e=[],t={},n=e=>{e in this._comments&&(t[e]=this._comments[e])};for(;this._history.length>0;)e.push(this._undoMove());for(n(this.fen());;){const t=e.pop();if(!t)break;this._makeMove(t),n(this.fen())}this._comments=t}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map((e=>({fen:e,comment:this._comments[e]})))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map((e=>{const t=this._comments[e];return delete this._comments[e],{fen:e,comment:t}}))}setCastlingRights(e,t){for(const r of[b,w])void 0!==t[r]&&(t[r]?this._castling[e]|=L[r]:this._castling[e]&=~L[r]);this._updateCastlingRights();const n=this.getCastlingRights(e);return(void 0===t[b]||t[b]===n[b])&&(void 0===t[w]||t[w]===n[w])}getCastlingRights(e){return{[b]:0!==(this._castling[e]&L[b]),[w]:0!==(this._castling[e]&L[w])}}moveNumber(){return this._moveNumber}}},379:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(705);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},393:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(995).A)("Moon",[["path",{d:"M12 3a6.364 6.364 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"1rit1i"}]])},408:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(995).A)("Pizza",[["path",{d:"M15 11h.01",key:"rns66s"}],["path",{d:"M11 15h.01",key:"k85uqc"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"m2 16 20 6-6-20A20 20 0 0 0 2 16",key:"e4slt2"}],["path",{d:"M5.71 17.11a17.04 17.04 0 0 1 11.4-11.4",key:"rerf8f"}]])},443:(e,t,n)=>{n.d(t,{$b:()=>i,Ey:()=>h,He:()=>u,Vy:()=>l});const r=[];var i;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));const s={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},o=i.INFO,a={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},c=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=a[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class l{constructor(e){this.name=e,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...t),this._logHandler(this,i.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...t),this._logHandler(this,i.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.INFO,...t),this._logHandler(this,i.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.WARN,...t),this._logHandler(this,i.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.ERROR,...t),this._logHandler(this,i.ERROR,...t)}}function u(e){r.forEach((t=>{t.setLogLevel(e)}))}function h(e,t){for(const n of r){let r=null;t&&t.level&&(r=s[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var s=arguments.length,o=new Array(s>2?s-2:0),a=2;a<s;a++)o[a-2]=arguments[a];const c=o.map((e=>{if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((e=>e)).join(" ");n>=(null!==r&&void 0!==r?r:t.logLevel)&&e({level:i[n].toLowerCase(),message:c,args:o,type:t.name})}}}},469:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(995).A)("ArrowLeft",[["line",{x1:"19",x2:"5",y1:"12",y2:"12",key:"9fu2vq"}],["polyline",{points:"12 19 5 12 12 5",key:"1ksm0z"}]])},529:(e,t,n)=>{n.d(t,{cY:()=>v,FA:()=>q,g:()=>B,gz:()=>re,dM:()=>j,vA:()=>i,Hk:()=>s,K3:()=>a,u:()=>h,KA:()=>l,Uj:()=>u,gR:()=>Q,Fy:()=>b,tD:()=>ie,A4:()=>d,bD:()=>X,zw:()=>f,dI:()=>ce,hp:()=>ne,T9:()=>m,XA:()=>_,mS:()=>p,Ku:()=>fe,ZQ:()=>C,qc:()=>G,Bd:()=>x,sr:()=>O,zJ:()=>y,c1:()=>A,Im:()=>$,lT:()=>R,zW:()=>F,jZ:()=>S,Ll:()=>k,$g:()=>N,lV:()=>D,nr:()=>M,Ov:()=>L,Cv:()=>H,p7:()=>P,$L:()=>K,kH:()=>J,gE:()=>w,Am:()=>ee,I9:()=>te,yw:()=>Y,OE:()=>de,kj:()=>he,As:()=>z,P1:()=>T,od:()=>ae,oD:()=>le,HN:()=>ue,eX:()=>U});const r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(e,t){if(!e)throw s(t)},s=function(e){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},o=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,c=a?e[i+2]:0,l=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new c;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const l=function(e){const t=o(e);return a.encodeByteArray(t,!0)},u=function(e){return l(e).replace(/\./g,"")},h=function(e){try{return a.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function d(e){return f(void 0,e)}function f(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=f(e[n],t[n]));return e}function p(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const g=()=>{try{return p().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/rudra-chat",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&h(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},m=()=>{var e;return null===(e=g())||void 0===e?void 0:e.config},_=e=>{var t;return null===(t=g())||void 0===t?void 0:t["_".concat(e)]};class v{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function y(e){return e.endsWith(".cloudworkstations.dev")}async function w(e){return(await fetch(e,{credentials:"include"})).ok}function b(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[u(JSON.stringify({alg:"none",type:"JWT"})),u(JSON.stringify(s)),""].join(".")}const E={};let I=!1;function T(e,t){if("undefined"===typeof window||"undefined"===typeof document||!y(window.location.host)||E[e]===t||E[e]||I)return;function n(e){return"__firebase__banner__".concat(e)}E[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(E))E[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{I=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),o=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),c=document.getElementById(a)||document.createElement("a"),l=n("preprendIcon"),u=document.getElementById(l)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(c,a);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,l),t.append(u,o,c,n),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function C(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function S(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(C())}function k(){var e;const t=null===(e=g())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function x(){return"undefined"!==typeof window||P()}function P(){return"undefined"!==typeof WorkerGlobalScope&&"undefined"!==typeof self&&self instanceof WorkerGlobalScope}function A(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function O(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function D(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function R(){const e=C();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function N(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN}function M(){return!k()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L(){return!k()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function F(){try{return"object"===typeof indexedDB}catch(e){return!1}}function U(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}function j(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}class B extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,B.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,q.prototype.create)}}class q{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(V,((e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new B(n,s,t)}}const V=/\{\$([^}]+)}/g;function K(e){return JSON.parse(e)}function z(e){return JSON.stringify(e)}const W=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=K(h(s[0])||""),n=K(h(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(s){}return{header:t,claims:n,data:r,signature:i}},H=function(e){const t=W(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")},G=function(e){const t=W(e).claims;return"object"===typeof t&&!0===t.admin};function Q(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Y(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function $(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function J(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function X(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Z(n)&&Z(s)){if(!X(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Z(e){return null!==e&&"object"===typeof e}function ee(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function te(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function ne(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class re{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let u=0;u<16;u++)n[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)n[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){const e=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=4294967295&(e<<1|e>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):u<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const e=(s<<5|s>>>27)+r+l+i+n[u]&4294967295;l=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[r]>>t&255,++n;return e}}function ie(e,t){const n=new se(e,t);return n.subscribe.bind(n)}class se{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=oe),void 0===r.error&&(r.error=oe),void 0===r.complete&&(r.complete=oe);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function oe(){}const ae=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}};function ce(e,t){return"".concat(e," failed: ").concat(t," argument ")}function le(e,t,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(ce(e,t)+"must be a valid function.")}function ue(e,t,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(ce(e,t)+"must be a valid context object.")}const he=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);if(s>=55296&&s<=56319){const t=s-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate.");s=65536+(t<<10)+(e.charCodeAt(r)-56320)}s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):s<65536?(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},de=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function fe(e){return e&&e._delegate?e._delegate:e}},550:(e,t,n)=>{n.d(t,{GG:()=>r.GG,My:()=>r.My,O5:()=>r.O5,P:()=>r.P,_M:()=>r._M,aQ:()=>r.aQ,gS:()=>r.gS,rJ:()=>r.rJ});var r=n(814)},554:(e,t,n)=>{n.d(t,{gf:()=>Y,ni:()=>$,xD:()=>J});n(942);var r=n(812),i=n(799),s=n(529),o=n(52);const a="/firebase-messaging-sw.js",c="/firebase-cloud-messaging-push-scope",l="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",u="https://fcmregistrations.googleapis.com/v1",h="google.c.a.c_id",d=1e4;var f,p;function g(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function m(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(f||(f={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(p||(p={}));const _="fcm_token_details_db",v=5,y="fcm_token_object_Store";const w="firebase-messaging-database",b=1,E="firebase-messaging-store";let I=null;function T(){return I||(I=(0,i.P2)(w,b,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(E)}})),I}async function C(e){const t=k(e),n=await T(),r=await n.transaction(E).objectStore(E).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map((e=>e.name));if(!e.includes(_))return null}let t=null;return(await(0,i.P2)(_,v,{upgrade:async(n,r,i,s)=>{var o;if(r<2)return;if(!n.objectStoreNames.contains(y))return;const a=s.objectStore(y),c=await a.index("fcmSenderId").get(e);if(await a.clear(),c)if(2===r){const e=c;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(o=e.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"===typeof e.vapidKey?e.vapidKey:g(e.vapidKey)}}}else if(3===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:g(e.auth),p256dh:g(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:g(e.vapidKey)}}}else if(4===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:g(e.auth),p256dh:g(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:g(e.vapidKey)}}}}})).close(),await(0,i.MR)(_),await(0,i.MR)("fcm_vapid_details_db"),await(0,i.MR)("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"===typeof e.createTime&&e.createTime>0&&"string"===typeof e.token&&e.token.length>0&&"string"===typeof t.auth&&t.auth.length>0&&"string"===typeof t.p256dh&&t.p256dh.length>0&&"string"===typeof t.endpoint&&t.endpoint.length>0&&"string"===typeof t.swScope&&t.swScope.length>0&&"string"===typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await S(e,t),t}}async function S(e,t){const n=k(e),r=(await T()).transaction(E,"readwrite");return await r.objectStore(E).put(t,n),await r.done,t}function k(e){let{appConfig:t}=e;return t.appId}const x={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},P=new s.FA("messaging","Messaging",x);async function A(e,t){const n={method:"DELETE",headers:await D(e)};try{const r=await fetch("".concat(O(e.appConfig),"/").concat(t),n),i=await r.json();if(i.error){const e=i.error.message;throw P.create("token-unsubscribe-failed",{errorInfo:e})}}catch(r){throw P.create("token-unsubscribe-failed",{errorInfo:null===r||void 0===r?void 0:r.toString()})}}function O(e){let{projectId:t}=e;return"".concat(u,"/projects/").concat(t,"/registrations")}async function D(e){let{appConfig:t,installations:n}=e;const r=await n.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(r)})}function R(e){let{p256dh:t,auth:n,endpoint:r,vapidKey:i}=e;const s={web:{endpoint:r,auth:n,p256dh:t}};return i!==l&&(s.web.applicationPubKey=i),s}const N=6048e5;async function M(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:m(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:g(t.getKey("auth")),p256dh:g(t.getKey("p256dh"))},r=await C(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}(r.subscriptionOptions,n))return Date.now()>=r.createTime+N?async function(e,t){try{const n=await async function(e,t){const n=await D(e),r=R(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch("".concat(O(e.appConfig),"/").concat(t.token),i);s=await n.json()}catch(o){throw P.create("token-update-failed",{errorInfo:null===o||void 0===o?void 0:o.toString()})}if(s.error){const e=s.error.message;throw P.create("token-update-failed",{errorInfo:e})}if(!s.token)throw P.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await S(e.firebaseDependencies,r),n}catch(n){throw n}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await A(e.firebaseDependencies,r.token)}catch(i){console.warn(i)}return F(e.firebaseDependencies,n)}return F(e.firebaseDependencies,n)}async function L(e){const t=await C(e.firebaseDependencies);t&&(await A(e.firebaseDependencies,t.token),await async function(e){const t=k(e),n=(await T()).transaction(E,"readwrite");await n.objectStore(E).delete(t),await n.done}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function F(e,t){const n=await async function(e,t){const n=await D(e),r=R(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(O(e.appConfig),i);s=await t.json()}catch(o){throw P.create("token-subscribe-failed",{errorInfo:null===o||void 0===o?void 0:o.toString()})}if(s.error){const e=s.error.message;throw P.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw P.create("token-subscribe-no-token");return s.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await S(e,r),r.token}function U(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i);const s=t.notification.icon;s&&(e.notification.icon=s)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,i,s,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const a=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(s=t.notification)||void 0===s?void 0:s.click_action;a&&(e.fcmOptions.link=a);const c=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;c&&(e.fcmOptions.analyticsLabel=c)}(t,e),t}function j(e){return P.create("missing-app-config-values",{valueName:e})}!function(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));n.join("")}("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class B{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw j("App Configuration Object");if(!e.name)throw j("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const r of t)if(!n[r])throw j(r);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}async function q(e){try{e.swRegistration=await navigator.serviceWorker.register(a,{scope:c}),e.swRegistration.update().catch((()=>{})),await async function(e){return new Promise(((t,n)=>{const r=setTimeout((()=>n(new Error("Service worker not registered after ".concat(d," ms")))),d),i=e.installing||e.waiting;e.active?(clearTimeout(r),t()):i?i.onstatechange=e=>{var n;"activated"===(null===(n=e.target)||void 0===n?void 0:n.state)&&(i.onstatechange=null,clearTimeout(r),t())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))}))}(e.swRegistration)}catch(t){throw P.create("failed-service-worker-registration",{browserErrorMessage:null===t||void 0===t?void 0:t.message})}}async function V(e,t){if(!navigator)throw P.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw P.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=l)}(e,null===t||void 0===t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await q(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw P.create("invalid-sw-registration");e.swRegistration=t}}(e,null===t||void 0===t?void 0:t.serviceWorkerRegistration),M(e)}async function K(e,t,n){const r=function(e){switch(e){case p.NOTIFICATION_CLICKED:return"notification_open";case p.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[h],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function z(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===p.PUSH_RECEIVED&&("function"===typeof e.onMessageHandler?e.onMessageHandler(U(n)):e.onMessageHandler.next(U(n)));const r=n.data;var i;"object"===typeof(i=r)&&i&&h in i&&"1"===r["google.c.a.e"]&&await K(e,n.messageType,r)}const W="@firebase/messaging",H="0.12.21",G=e=>{const t=new B(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(e=>z(t,e))),t},Q=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>V(t,e)}};async function Y(e,t){return V(e=(0,s.Ku)(e),t)}function $(e){return async function(e){if(!navigator)throw P.create("only-available-in-window");return e.swRegistration||await q(e),L(e)}(e=(0,s.Ku)(e))}function J(e,t){return function(e,t){if(!navigator)throw P.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=(0,s.Ku)(e),t)}(0,o._registerComponent)(new r.uA("messaging",G,"PUBLIC")),(0,o._registerComponent)(new r.uA("messaging-internal",Q,"PRIVATE")),(0,o.registerVersion)(W,H),(0,o.registerVersion)(W,H,"esm2017")},579:(e,t,n)=>{e.exports=n(153)},607:e=>{function t(e,n,r,i){var s=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(s,t.prototype),s.expected=n,s.found=r,s.location=i,s.name="SyntaxError",s}function n(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,e+(n+=n.repeat(t)).slice(0,t))}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(t,Error),t.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var r,i=null;for(r=0;r<e.length;r++)if(e[r].source===this.location.source){i=e[r].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,o=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(s):s,a=this.location.source+":"+o.line+":"+o.column;if(i){var c=this.location.end,l=n("",o.line.toString().length," "),u=i[s.line-1],h=(s.line===c.line?c.column:u.length+1)-s.column||1;t+="\n --\x3e "+a+"\n"+l+" |\n"+o.line+" | "+u+"\n"+l+" | "+n("",s.column-1," ")+n("",h,"^")}else t+="\n at "+a}return t},t.buildMessage=function(e,t){var n={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?s(e[0])+"-"+s(e[1]):s(e)}));return"["+(e.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function o(e){return n[e.type](e)}return"Expected "+function(e){var t,n,r=e.map(o);if(r.sort(),r.length>0){for(t=1,n=1;t<r.length;t++)r[t-1]!==r[t]&&(r[n]=r[t],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},e.exports={StartRules:["pgn"],SyntaxError:t,parse:function(e,n){var r,i={},s=(n=void 0!==n?n:{}).grammarSource,o={pgn:We},a=We,c="[",l='"',u="]",h=".",d="O-O-O",f="O-O",p="0-0-0",g="0-0",m="$",_="{",v="}",y=";",w="(",b=")",E="1-0",I="0-1",T="1/2-1/2",C="*",S=/^[a-zA-Z]/,k=/^[^"]/,x=/^[0-9]/,P=/^[.]/,A=/^[a-zA-Z1-8\-=]/,O=/^[+#]/,D=/^[!?]/,R=/^[^}]/,N=/^[^\r\n]/,M=/^[ \t\r\n]/,L=Be("tag pair"),F=Ue("[",!1),U=Ue('"',!1),j=Ue("]",!1),B=Be("tag name"),q=je([["a","z"],["A","Z"]],!1,!1),V=Be("tag value"),K=je(['"'],!0,!1),z=Be("move number"),W=je([["0","9"]],!1,!1),H=Ue(".",!1),G=je(["."],!1,!1),Q=Be("standard algebraic notation"),Y=Ue("O-O-O",!1),$=Ue("O-O",!1),J=Ue("0-0-0",!1),X=Ue("0-0",!1),Z=je([["a","z"],["A","Z"],["1","8"],"-","="],!1,!1),ee=je(["+","#"],!1,!1),te=Be("suffix annotation"),ne=je(["!","?"],!1,!1),re=Be("NAG"),ie=Ue("$",!1),se=Be("brace comment"),oe=Ue("{",!1),ae=je(["}"],!0,!1),ce=Ue("}",!1),le=Be("rest of line comment"),ue=Ue(";",!1),he=je(["\r","\n"],!0,!1),de=Be("variation"),fe=Ue("(",!1),pe=Ue(")",!1),ge=Be("game termination marker"),me=Ue("1-0",!1),_e=Ue("0-1",!1),ve=Ue("1/2-1/2",!1),ye=Ue("*",!1),we=Be("whitespace"),be=je([" ","\t","\r","\n"],!1,!1),Ee=function(e,t){return function(e,t){var n;if(t.marker&&t.marker.comment){let e=t.root;for(;;){const n=e.variations[0];if(!n){e.comment=t.marker.comment;break}e=n}}return{headers:e,root:t.root,result:null!==(n=t.marker&&t.marker.result)&&void 0!==n?n:void 0}}(e,t)},Ie=function(e){return Object.fromEntries(e)},Te=function(e,t){return[e,t]},Ce=function(e,t){return{root:e,marker:t}},Se=function(e,t){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=t;let s=r;for(const o of i)null!==o&&(s.variations=[o,...o.variations],o.variations=[],s=o);return r}(function(e){return null!==e?{comment:e,variations:[]}:{variations:[]}}(e),...t.flat())},ke=function(e,t,n,r,i){return function(e,t,n,r,i){const s={move:e,variations:i};return t&&(s.suffix=t),n&&(s.nag=n),null!==r&&(s.comment=r),s}(e,t,n,r,i)},xe=function(e){return e},Pe=function(e){return e.replace(/[\r\n]+/g," ")},Ae=function(e){return e.trim()},Oe=function(e){return e},De=function(e,t){return{result:e,comment:t}},Re=0|n.peg$currPos,Ne=[{line:1,column:1}],Me=Re,Le=n.peg$maxFailExpected||[],Fe=0|n.peg$silentFails;if(n.startRule){if(!(n.startRule in o))throw new Error("Can't start parsing from rule \""+n.startRule+'".');a=o[n.startRule]}function Ue(e,t){return{type:"literal",text:e,ignoreCase:t}}function je(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function Be(e){return{type:"other",description:e}}function qe(t){var n,r=Ne[t];if(r)return r;if(t>=Ne.length)n=Ne.length-1;else for(n=t;!Ne[--n];);for(r={line:(r=Ne[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return Ne[t]=r,r}function Ve(e,t,n){var r=qe(e),i=qe(t),o={source:s,start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:i.line,column:i.column}};return n&&s&&"function"===typeof s.offset&&(o.start=s.offset(o.start),o.end=s.offset(o.end)),o}function Ke(e){Re<Me||(Re>Me&&(Me=Re,Le=[]),Le.push(e))}function ze(e,n,r){return new t(t.buildMessage(e,n),e,n,r)}function We(){var t,n,r;return t=Re,n=function(){var e,t,n;e=Re,t=[],n=He();for(;n!==i;)t.push(n),n=He();return n=Xe(),e=Ie(t),e}(),r=function(){var t,n,r;t=Re,n=Ge(),Xe(),r=function(){var t,n,r;Fe++,t=Re,e.substr(Re,3)===E?(n=E,Re+=3):(n=i,0===Fe&&Ke(me));n===i&&(e.substr(Re,3)===I?(n=I,Re+=3):(n=i,0===Fe&&Ke(_e)),n===i&&(e.substr(Re,7)===T?(n=T,Re+=7):(n=i,0===Fe&&Ke(ve)),n===i&&(42===e.charCodeAt(Re)?(n=C,Re++):(n=i,0===Fe&&Ke(ye)))));n!==i?(Xe(),(r=$e())===i&&(r=null),t=De(n,r)):(Re=t,t=i);Fe--,t===i&&(n=i,0===Fe&&Ke(ge));return t}(),r===i&&(r=null);return Xe(),t=Ce(n,r),t}(),t=Ee(n,r)}function He(){var t,n,r,s,o,a,h;return Fe++,t=Re,Xe(),91===e.charCodeAt(Re)?(n=c,Re++):(n=i,0===Fe&&Ke(F)),n!==i?(Xe(),r=function(){var t,n,r;Fe++,t=Re,n=[],r=e.charAt(Re),S.test(r)?Re++:(r=i,0===Fe&&Ke(q));if(r!==i)for(;r!==i;)n.push(r),r=e.charAt(Re),S.test(r)?Re++:(r=i,0===Fe&&Ke(q));else n=i;t=n!==i?e.substring(t,Re):n;Fe--,t===i&&(n=i,0===Fe&&Ke(B));return t}(),r!==i?(Xe(),34===e.charCodeAt(Re)?(s=l,Re++):(s=i,0===Fe&&Ke(U)),s!==i?(o=function(){var t,n,r;Fe++,t=Re,n=[],r=e.charAt(Re),k.test(r)?Re++:(r=i,0===Fe&&Ke(K));for(;r!==i;)n.push(r),r=e.charAt(Re),k.test(r)?Re++:(r=i,0===Fe&&Ke(K));t=e.substring(t,Re),Fe--,n=i,0===Fe&&Ke(V);return t}(),34===e.charCodeAt(Re)?(a=l,Re++):(a=i,0===Fe&&Ke(U)),a!==i?(Xe(),93===e.charCodeAt(Re)?(h=u,Re++):(h=i,0===Fe&&Ke(j)),h!==i?t=Te(r,o):(Re=t,t=i)):(Re=t,t=i)):(Re=t,t=i)):(Re=t,t=i)):(Re=t,t=i),Fe--,t===i&&(0===Fe&&Ke(L)),t}function Ge(){var e,t,n,r;for(e=Re,(t=$e())===i&&(t=null),n=[],r=Qe();r!==i;)n.push(r),r=Qe();return e=Se(t,n)}function Qe(){var t,n,r,s,o,a,c,l,u;if(t=Re,Xe(),n=function(){var t,n,r,s,o,a;Fe++,t=Re,n=[],r=e.charAt(Re),x.test(r)?Re++:(r=i,0===Fe&&Ke(W));for(;r!==i;)n.push(r),r=e.charAt(Re),x.test(r)?Re++:(r=i,0===Fe&&Ke(W));46===e.charCodeAt(Re)?(r=h,Re++):(r=i,0===Fe&&Ke(H));if(r!==i){for(s=Xe(),o=[],a=e.charAt(Re),P.test(a)?Re++:(a=i,0===Fe&&Ke(G));a!==i;)o.push(a),a=e.charAt(Re),P.test(a)?Re++:(a=i,0===Fe&&Ke(G));t=n=[n,r,s,o]}else Re=t,t=i;Fe--,t===i&&(n=i,0===Fe&&Ke(z));return t}(),n===i&&(n=null),Xe(),r=function(){var t,n,r,s,o,a;Fe++,t=Re,n=Re,e.substr(Re,5)===d?(r=d,Re+=5):(r=i,0===Fe&&Ke(Y));if(r===i&&(e.substr(Re,3)===f?(r=f,Re+=3):(r=i,0===Fe&&Ke($)),r===i&&(e.substr(Re,5)===p?(r=p,Re+=5):(r=i,0===Fe&&Ke(J)),r===i&&(e.substr(Re,3)===g?(r=g,Re+=3):(r=i,0===Fe&&Ke(X)),r===i))))if(r=Re,s=e.charAt(Re),S.test(s)?Re++:(s=i,0===Fe&&Ke(q)),s!==i){if(o=[],a=e.charAt(Re),A.test(a)?Re++:(a=i,0===Fe&&Ke(Z)),a!==i)for(;a!==i;)o.push(a),a=e.charAt(Re),A.test(a)?Re++:(a=i,0===Fe&&Ke(Z));else o=i;o!==i?r=s=[s,o]:(Re=r,r=i)}else Re=r,r=i;r!==i?(s=e.charAt(Re),O.test(s)?Re++:(s=i,0===Fe&&Ke(ee)),s===i&&(s=null),n=r=[r,s]):(Re=n,n=i);t=n!==i?e.substring(t,Re):n;Fe--,t===i&&(n=i,0===Fe&&Ke(Q));return t}(),r!==i){for(s=function(){var t,n,r;Fe++,t=Re,n=[],r=e.charAt(Re),D.test(r)?Re++:(r=i,0===Fe&&Ke(ne));for(;r!==i;)n.push(r),n.length>=2?r=i:(r=e.charAt(Re),D.test(r)?Re++:(r=i,0===Fe&&Ke(ne)));n.length<1?(Re=t,t=i):t=n;Fe--,t===i&&(n=i,0===Fe&&Ke(te));return t}(),s===i&&(s=null),o=[],a=Ye();a!==i;)o.push(a),a=Ye();for(a=Xe(),(c=$e())===i&&(c=null),l=[],u=Je();u!==i;)l.push(u),u=Je();t=ke(r,s,o,c,l)}else Re=t,t=i;return t}function Ye(){var t,n,r,s,o;if(Fe++,t=Re,Xe(),36===e.charCodeAt(Re)?(n=m,Re++):(n=i,0===Fe&&Ke(ie)),n!==i){if(r=Re,s=[],o=e.charAt(Re),x.test(o)?Re++:(o=i,0===Fe&&Ke(W)),o!==i)for(;o!==i;)s.push(o),o=e.charAt(Re),x.test(o)?Re++:(o=i,0===Fe&&Ke(W));else s=i;(r=s!==i?e.substring(r,Re):s)!==i?t=xe(r):(Re=t,t=i)}else Re=t,t=i;return Fe--,t===i&&(0===Fe&&Ke(re)),t}function $e(){var t;return(t=function(){var t,n,r,s,o;Fe++,t=Re,123===e.charCodeAt(Re)?(n=_,Re++):(n=i,0===Fe&&Ke(oe));if(n!==i){for(r=Re,s=[],o=e.charAt(Re),R.test(o)?Re++:(o=i,0===Fe&&Ke(ae));o!==i;)s.push(o),o=e.charAt(Re),R.test(o)?Re++:(o=i,0===Fe&&Ke(ae));r=e.substring(r,Re),125===e.charCodeAt(Re)?(s=v,Re++):(s=i,0===Fe&&Ke(ce)),s!==i?t=Pe(r):(Re=t,t=i)}else Re=t,t=i;Fe--,t===i&&(n=i,0===Fe&&Ke(se));return t}())===i&&(t=function(){var t,n,r,s,o;Fe++,t=Re,59===e.charCodeAt(Re)?(n=y,Re++):(n=i,0===Fe&&Ke(ue));if(n!==i){for(r=Re,s=[],o=e.charAt(Re),N.test(o)?Re++:(o=i,0===Fe&&Ke(he));o!==i;)s.push(o),o=e.charAt(Re),N.test(o)?Re++:(o=i,0===Fe&&Ke(he));r=e.substring(r,Re),t=Ae(r)}else Re=t,t=i;Fe--,t===i&&(n=i,0===Fe&&Ke(le));return t}()),t}function Je(){var t,n,r,s;return Fe++,t=Re,Xe(),40===e.charCodeAt(Re)?(n=w,Re++):(n=i,0===Fe&&Ke(fe)),n!==i&&(r=Ge())!==i?(Xe(),41===e.charCodeAt(Re)?(s=b,Re++):(s=i,0===Fe&&Ke(pe)),s!==i?t=Oe(r):(Re=t,t=i)):(Re=t,t=i),Fe--,t===i&&(0===Fe&&Ke(de)),t}function Xe(){var t,n;for(Fe++,t=[],n=e.charAt(Re),M.test(n)?Re++:(n=i,0===Fe&&Ke(be));n!==i;)t.push(n),n=e.charAt(Re),M.test(n)?Re++:(n=i,0===Fe&&Ke(be));return Fe--,n=i,0===Fe&&Ke(we),t}if(r=a(),n.peg$library)return{peg$result:r,peg$currPos:Re,peg$FAILED:i,peg$maxFailExpected:Le,peg$maxFailPos:Me};if(r!==i&&Re===e.length)return r;throw r!==i&&Re<e.length&&Ke({type:"end"}),ze(Le,Me<e.length?e.charAt(Me):null,Me<e.length?Ve(Me,Me+1):Ve(Me,Me))}}},645:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(995).A)("Gamepad",[["line",{x1:"6",x2:"10",y1:"12",y2:"12",key:"161bw2"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"15",x2:"15.01",y1:"13",y2:"13",key:"dqpgro"}],["line",{x1:"18",x2:"18.01",y1:"11",y2:"11",key:"meh2c"}],["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]])},669:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(995).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},705:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{A:()=>s})},730:(e,t,n)=>{var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var _=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function y(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(_,v);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(_,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(_,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),E=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),k=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var L,F=Object.assign;function U(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var j=!1;function B(e,t){if(!e||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var c="\n"+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=o&&0<=a);break}}}finally{j=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function q(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case I:return"Fragment";case E:return"Portal";case C:return"Profiler";case T:return"StrictMode";case P:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case x:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function K(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function z(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=z(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function X(e,t){J(e,t);var n=z(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,z(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+z(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:z(n)}}function se(e,t){var n=z(t.value),r=z(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var _e=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(_e[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,Ie=null,Te=null;function Ce(e){if(e=yi(e)){if("function"!==typeof Ee)throw Error(s(280));var t=e.stateNode;t&&(t=bi(t),Ee(e.stateNode,e.type,t))}}function Se(e){Ie?Te?Te.push(e):Te=[e]:Ie=e}function ke(){if(Ie){var e=Ie,t=Te;if(Te=Ie=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function xe(e,t){return e(t)}function Pe(){}var Ae=!1;function Oe(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return xe(e,t,n)}finally{Ae=!1,(null!==Ie||null!==Te)&&(Pe(),ke())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=bi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Re=!1;if(u)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(ue){Re=!1}function Me(e,t,n,r,i,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Le=!1,Fe=null,Ue=!1,je=null,Be={onError:function(e){Le=!0,Fe=e}};function qe(e,t,n,r,i,s,o,a,c){Le=!1,Fe=null,Me.apply(Be,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ke(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function ze(e){if(Ve(e)!==e)throw Error(s(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return ze(i),e;if(o===r)return ze(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ge=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,$e=i.unstable_requestPaint,Je=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/ct|0)|0},at=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ht(a):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~i)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _t(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var yt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,Et,It,Tt,Ct,St=!1,kt=[],xt=null,Pt=null,At=null,Ot=new Map,Dt=new Map,Rt=[],Nt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":xt=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Lt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=vi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ke(n)))return e.blockedOn=t,void Ct(e.priority,(function(){It(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yi(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function jt(e,t,n){Ut(e)&&n.delete(t)}function Bt(){St=!1,null!==xt&&Ut(xt)&&(xt=null),null!==Pt&&Ut(Pt)&&(Pt=null),null!==At&&Ut(At)&&(At=null),Ot.forEach(jt),Dt.forEach(jt)}function qt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function Vt(e){function t(t){return qt(t,e)}if(0<kt.length){qt(kt[0],e);for(var n=1;n<kt.length;n++){var r=kt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==xt&&qt(xt,e),null!==Pt&&qt(Pt,e),null!==At&&qt(At,e),Ot.forEach(t),Dt.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Rt.shift()}var Kt=w.ReactCurrentBatchConfig,zt=!0;function Wt(e,t,n,r){var i=yt,s=Kt.transition;Kt.transition=null;try{yt=1,Gt(e,t,n,r)}finally{yt=i,Kt.transition=s}}function Ht(e,t,n,r){var i=yt,s=Kt.transition;Kt.transition=null;try{yt=4,Gt(e,t,n,r)}finally{yt=i,Kt.transition=s}}function Gt(e,t,n,r){if(zt){var i=Yt(e,t,n,r);if(null===i)zr(e,t,r,Qt,n),Mt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return xt=Lt(xt,e,t,n,r,i),!0;case"dragenter":return Pt=Lt(Pt,e,t,n,r,i),!0;case"mouseover":return At=Lt(At,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ot.set(s,Lt(Ot.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Dt.set(s,Lt(Dt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Nt.indexOf(e)){for(;null!==i;){var s=yi(i);if(null!==s&&bt(s),null===(s=Yt(e,t,n,r))&&zr(e,t,r,Qt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else zr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=vi(e=be(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ke(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(ln),hn=F({},ln,{view:0,detail:0}),dn=sn(hn),fn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(on=e.screenX-cn.screenX,an=e.screenY-cn.screenY):an=on=0,cn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),gn=sn(F({},fn,{dataTransfer:0})),mn=sn(F({},hn,{relatedTarget:0})),_n=sn(F({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=sn(vn),wn=sn(F({},ln,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},In={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=In[e])&&!!t[e]}function Cn(){return Tn}var Sn=F({},hn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=sn(Sn),xn=sn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=sn(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),An=sn(F({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(On),Rn=[9,13,27,32],Nn=u&&"CompositionEvent"in window,Mn=null;u&&"documentMode"in document&&(Mn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Mn,Fn=u&&(!Nn||Mn&&8<Mn&&11>=Mn),Un=String.fromCharCode(32),jn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Kn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Kn[e.type]:"textarea"===t}function Wn(e,t,n,r){Se(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Gn=null;function Qn(e){Ur(e,0)}function Yn(e){if(G(wi(e)))return e}function $n(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Gn=Hn=null)}function nr(e){if("value"===e.propertyName&&Yn(Gn)){var t=[];Wn(t,Gn,e,be(e)),Oe(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Gn)}function sr(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var o=ur(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,_r=null,vr=null,yr=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==mr||mr!==Q(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&cr(vr,r)||(vr=r,0<(r=Hr(_r,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function br(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},Ir={},Tr={};function Cr(e){if(Ir[e])return Ir[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Tr)return Ir[e]=n[t];return e}u&&(Tr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var Sr=Cr("animationend"),kr=Cr("animationiteration"),xr=Cr("animationstart"),Pr=Cr("transitionend"),Ar=new Map,Or="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Ar.set(e,t),c(t,[e])}for(var Rr=0;Rr<Or.length;Rr++){var Nr=Or[Rr];Dr(Nr.toLowerCase(),"on"+(Nr[0].toUpperCase()+Nr.slice(1)))}Dr(Sr,"onAnimationEnd"),Dr(kr,"onAnimationIteration"),Dr(xr,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Pr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,c,l){if(qe.apply(this,arguments),Le){if(!Le)throw Error(s(198));var u=Fe;Le=!1,Fe=null,Ue||(Ue=!0,je=u)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;Fr(i,a,l),s=c}else for(o=0;o<r.length;o++){if(c=(a=r[o]).instance,l=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;Fr(i,a,l),s=c}}}if(Ue)throw e=je,Ue=!1,je=null,e}function jr(e,t){var n=t[gi];void 0===n&&(n=t[gi]=new Set);var r=e+"__bubble";n.has(r)||(Kr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),Kr(n,e,r,t)}var qr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[qr]){e[qr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qr]||(t[qr]=!0,Br("selectionchange",!1,t))}}function Kr(e,t,n,r){switch($t(t)){case 1:var i=Wt;break;case 4:i=Ht;break;default:i=Gt}n=i.bind(null,t,n,e),i=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function zr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===i||8===c.nodeType&&c.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=vi(a)))return;if(5===(c=o.tag)||6===c){r=s=o;continue e}a=a.parentNode}}r=r.return}Oe((function(){var r=s,i=be(n),o=[];e:{var a=Ar.get(e);if(void 0!==a){var c=un,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=kn;break;case"focusin":l="focus",c=mn;break;case"focusout":l="blur",c=mn;break;case"beforeblur":case"afterblur":c=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Pn;break;case Sr:case kr:case xr:c=_n;break;case Pr:c=An;break;case"scroll":c=dn;break;case"wheel":c=Dn;break;case"copy":case"cut":case"paste":c=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=xn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=De(p,d))&&u.push(Wr(p,g,f)))),h)break;p=p.return}0<u.length&&(a=new c(a,l,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(l=n.relatedTarget||n.fromElement)||!vi(l)&&!l[pi])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?vi(l):null)&&(l!==(h=Ve(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=pn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=xn,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==c?a:wi(c),f=null==l?a:wi(l),(a=new u(g,p+"leave",c,n,i)).target=h,a.relatedTarget=f,g=null,vi(i)===r&&((u=new u(d,p+"enter",l,n,i)).target=f,u.relatedTarget=h,g=u),h=g,c&&l)e:{for(d=l,p=0,f=u=c;f;f=Gr(f))p++;for(f=0,g=d;g;g=Gr(g))f++;for(;0<p-f;)u=Gr(u),p--;for(;0<f-p;)d=Gr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Gr(u),d=Gr(d)}u=null}else u=null;null!==c&&Qr(o,a,c,u,!1),null!==l&&null!==h&&Qr(o,h,l,u,!0)}if("select"===(c=(a=r?wi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var m=$n;else if(zn(a))if(Jn)m=or;else{m=ir;var _=rr}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=sr);switch(m&&(m=m(e,r))?Wn(o,m,n,i):(_&&_(e,a,r),"focusout"===e&&(_=a._wrapperState)&&_.controlled&&"number"===a.type&&ee(a,"number",a.value)),_=r?wi(r):window,e){case"focusin":(zn(_)||"true"===_.contentEditable)&&(mr=_,_r=r,vr=null);break;case"focusout":vr=_r=mr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,wr(o,n,i);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":wr(o,n,i)}var v;if(Nn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Vn?Bn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Fn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Vn&&(v=en()):(Xt="value"in(Jt=i)?Jt.value:Jt.textContent,Vn=!0)),0<(_=Hr(r,y)).length&&(y=new wn(y,e,null,n,i),o.push({event:y,listeners:_}),v?y.data=v:null!==(v=qn(n))&&(y.data=v))),(v=Ln?function(e,t){switch(e){case"compositionend":return qn(t);case"keypress":return 32!==t.which?null:(jn=!0,Un);case"textInput":return(e=t.data)===Un&&jn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Nn&&Bn(e,t)?(e=en(),Zt=Xt=Jt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=v))}Ur(o,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=De(e,n))&&r.unshift(Wr(e,s,i)),null!=(s=De(e,t))&&r.push(Wr(e,s,i))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(null!==c&&c===r)break;5===a.tag&&null!==l&&(a=l,i?null!=(c=De(n,s))&&o.unshift(Wr(n,c,a)):i||null!=(c=De(n,s))&&o.push(Wr(n,c,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace($r,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function ci(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,gi="__reactEvents$"+hi,mi="__reactListeners$"+hi,_i="__reactHandles$"+hi;function vi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function yi(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function bi(e){return e[fi]||null}var Ei=[],Ii=-1;function Ti(e){return{current:e}}function Ci(e){0>Ii||(e.current=Ei[Ii],Ei[Ii]=null,Ii--)}function Si(e,t){Ii++,Ei[Ii]=e.current,e.current=t}var ki={},xi=Ti(ki),Pi=Ti(!1),Ai=ki;function Oi(e,t){var n=e.type.contextTypes;if(!n)return ki;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Di(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ri(){Ci(Pi),Ci(xi)}function Ni(e,t,n){if(xi.current!==ki)throw Error(s(168));Si(xi,t),Si(Pi,n)}function Mi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,K(e)||"Unknown",i));return F({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,Ai=xi.current,Si(xi,e),Si(Pi,Pi.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Mi(e,t,Ai),r.__reactInternalMemoizedMergedChildContext=e,Ci(Pi),Ci(xi),Si(xi,e)):Ci(Pi),Si(Pi,n)}var Ui=null,ji=!1,Bi=!1;function qi(e){null===Ui?Ui=[e]:Ui.push(e)}function Vi(){if(!Bi&&null!==Ui){Bi=!0;var e=0,t=yt;try{var n=Ui;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,ji=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(e+1)),Ge(Ze,Vi),i}finally{yt=t,Bi=!1}}return null}var Ki=[],zi=0,Wi=null,Hi=0,Gi=[],Qi=0,Yi=null,$i=1,Ji="";function Xi(e,t){Ki[zi++]=Hi,Ki[zi++]=Wi,Wi=e,Hi=t}function Zi(e,t,n){Gi[Qi++]=$i,Gi[Qi++]=Ji,Gi[Qi++]=Yi,Yi=e;var r=$i;e=Ji;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,$i=1<<32-ot(t)+i|n<<i|r,Ji=s+e}else $i=1<<s|n<<i|r,Ji=e}function es(e){null!==e.return&&(Xi(e,1),Zi(e,1,0))}function ts(e){for(;e===Wi;)Wi=Ki[--zi],Ki[zi]=null,Hi=Ki[--zi],Ki[zi]=null;for(;e===Yi;)Yi=Gi[--Qi],Gi[Qi]=null,Ji=Gi[--Qi],Gi[Qi]=null,$i=Gi[--Qi],Gi[Qi]=null}var ns=null,rs=null,is=!1,ss=null;function os(e,t){var n=Ol(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:$i,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ol(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function cs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ls(e){if(is){var t=rs;if(t){var n=t;if(!as(e,t)){if(cs(e))throw Error(s(418));t=li(n.nextSibling);var r=ns;t&&as(e,t)?os(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(cs(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(cs(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=li(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?li(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=rs;e;)e=li(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var gs=w.ReactCurrentBatchConfig;function ms(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function _s(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function ys(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Rl(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Fl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var s=n.type;return s===I?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===D&&vs(s)===t.type)?((r=i(t,n.props)).ref=ms(e,t,n),r.return=e,r):((r=Nl(n.type,n.key,n.props,null,e.mode,r)).ref=ms(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ul(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Ml(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Nl(t.type,t.key,t.props,null,e.mode,n)).ref=ms(e,null,t),n.return=e,n;case E:return(t=Ul(t,e.mode,n)).return=e,t;case D:return d(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Ml(t,e.mode,n,null)).return=e,t;_s(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?l(e,t,n,r):null;case E:return n.key===i?u(e,t,n,r):null;case D:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||M(n))return null!==i?null:h(e,t,n,r,null);_s(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case D:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||M(r))return h(t,e=e.get(n)||null,r,i,null);_s(t,r)}return null}function g(i,s,a,c){for(var l=null,u=null,h=s,g=s=0,m=null;null!==h&&g<a.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var _=f(i,h,a[g],c);if(null===_){null===h&&(h=m);break}e&&h&&null===_.alternate&&t(i,h),s=o(_,s,g),null===u?l=_:u.sibling=_,u=_,h=m}if(g===a.length)return n(i,h),is&&Xi(i,g),l;if(null===h){for(;g<a.length;g++)null!==(h=d(i,a[g],c))&&(s=o(h,s,g),null===u?l=h:u.sibling=h,u=h);return is&&Xi(i,g),l}for(h=r(i,h);g<a.length;g++)null!==(m=p(h,i,g,a[g],c))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),s=o(m,s,g),null===u?l=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(i,e)})),is&&Xi(i,g),l}function m(i,a,c,l){var u=M(c);if("function"!==typeof u)throw Error(s(150));if(null==(c=u.call(c)))throw Error(s(151));for(var h=u=null,g=a,m=a=0,_=null,v=c.next();null!==g&&!v.done;m++,v=c.next()){g.index>m?(_=g,g=null):_=g.sibling;var y=f(i,g,v.value,l);if(null===y){null===g&&(g=_);break}e&&g&&null===y.alternate&&t(i,g),a=o(y,a,m),null===h?u=y:h.sibling=y,h=y,g=_}if(v.done)return n(i,g),is&&Xi(i,m),u;if(null===g){for(;!v.done;m++,v=c.next())null!==(v=d(i,v.value,l))&&(a=o(v,a,m),null===h?u=v:h.sibling=v,h=v);return is&&Xi(i,m),u}for(g=r(i,g);!v.done;m++,v=c.next())null!==(v=p(g,i,m,v.value,l))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=o(v,a,m),null===h?u=v:h.sibling=v,h=v);return e&&g.forEach((function(e){return t(i,e)})),is&&Xi(i,m),u}return function e(r,s,o,c){if("object"===typeof o&&null!==o&&o.type===I&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case b:e:{for(var l=o.key,u=s;null!==u;){if(u.key===l){if((l=o.type)===I){if(7===u.tag){n(r,u.sibling),(s=i(u,o.props.children)).return=r,r=s;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===D&&vs(l)===u.type){n(r,u.sibling),(s=i(u,o.props)).ref=ms(r,u,o),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===I?((s=Ml(o.props.children,r.mode,c,o.key)).return=r,r=s):((c=Nl(o.type,o.key,o.props,null,r.mode,c)).ref=ms(r,s,o),c.return=r,r=c)}return a(r);case E:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Ul(o,r.mode,c)).return=r,r=s}return a(r);case D:return e(r,s,(u=o._init)(o._payload),c)}if(te(o))return g(r,s,o,c);if(M(o))return m(r,s,o,c);_s(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Fl(o,r.mode,c)).return=r,r=s),a(r)):n(r,s)}}var ws=ys(!0),bs=ys(!1),Es=Ti(null),Is=null,Ts=null,Cs=null;function Ss(){Cs=Ts=Is=null}function ks(e){var t=Es.current;Ci(Es),e._currentValue=t}function xs(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ps(e,t){Is=e,Cs=Ts=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ya=!0),e.firstContext=null)}function As(e){var t=e._currentValue;if(Cs!==e)if(e={context:e,memoizedValue:t,next:null},null===Ts){if(null===Is)throw Error(s(308));Ts=e,Is.dependencies={lanes:0,firstContext:e}}else Ts=Ts.next=e;return t}var Os=null;function Ds(e){null===Os?Os=[e]:Os.push(e)}function Rs(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ds(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ns(e,r)}function Ns(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ms=!1;function Ls(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Us(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function js(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&xc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ns(e,n)}return null===(i=r.interleaved)?(t.next=t,Ds(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ns(e,n)}function Bs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function qs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vs(e,t,n,r){var i=e.updateQueue;Ms=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var c=a,l=c.next;c.next=null,null===o?s=l:o.next=l,o=c;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(null!==s){var h=i.baseState;for(o=0,u=l=c=null,a=s;;){var d=a.lane,f=a.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(d=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break e;h=F({},h,d);break e;case 2:Ms=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=f,c=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(c=h),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Lc|=o,e.lanes=o,e.memoizedState=h}}function Ks(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var zs={},Ws=Ti(zs),Hs=Ti(zs),Gs=Ti(zs);function Qs(e){if(e===zs)throw Error(s(174));return e}function Ys(e,t){switch(Si(Gs,t),Si(Hs,e),Si(Ws,zs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ci(Ws),Si(Ws,t)}function $s(){Ci(Ws),Ci(Hs),Ci(Gs)}function Js(e){Qs(Gs.current);var t=Qs(Ws.current),n=ce(t,e.type);t!==n&&(Si(Hs,e),Si(Ws,n))}function Xs(e){Hs.current===e&&(Ci(Ws),Ci(Hs))}var Zs=Ti(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=w.ReactCurrentDispatcher,io=w.ReactCurrentBatchConfig,so=0,oo=null,ao=null,co=null,lo=!1,uo=!1,ho=0,fo=0;function po(){throw Error(s(321))}function go(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function mo(e,t,n,r,i,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Zo:ea,e=n(r,i),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(s(301));o+=1,co=ao=null,t.updateQueue=null,ro.current=ta,e=n(r,i)}while(uo)}if(ro.current=Xo,t=null!==ao&&null!==ao.next,so=0,co=ao=oo=null,lo=!1,t)throw Error(s(300));return e}function _o(){var e=0!==ho;return ho=0,e}function vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===co?oo.memoizedState=co=e:co=co.next=e,co}function yo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===co?oo.memoizedState:co.next;if(null!==t)co=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===co?oo.memoizedState=co=e:co=co.next=e}return co}function wo(e,t){return"function"===typeof t?t(e):t}function bo(e){var t=yo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ao,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var c=a=null,l=null,u=o;do{var h=u.lane;if((so&h)===h)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=d,a=r):l=l.next=d,oo.lanes|=h,Lc|=h}u=u.next}while(null!==u&&u!==o);null===l?a=r:l.next=c,ar(r,t.memoizedState)||(ya=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,oo.lanes|=o,Lc|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Eo(e){var t=yo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ar(o,t.memoizedState)||(ya=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Io(){}function To(e,t){var n=oo,r=yo(),i=t(),o=!ar(r.memoizedState,i);if(o&&(r.memoizedState=i,ya=!0),r=r.queue,Lo(ko.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==co&&1&co.memoizedState.tag){if(n.flags|=2048,Oo(9,So.bind(null,n,r,i,t),void 0,null),null===Pc)throw Error(s(349));0!==(30&so)||Co(n,t,i)}return i}function Co(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function So(e,t,n,r){t.value=n,t.getSnapshot=r,xo(t)&&Po(e)}function ko(e,t,n){return n((function(){xo(t)&&Po(e)}))}function xo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Po(e){var t=Ns(e,1);null!==t&&nl(t,e,1,-1)}function Ao(e){var t=vo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Qo.bind(null,oo,e),[t.memoizedState,e]}function Oo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Do(){return yo().memoizedState}function Ro(e,t,n,r){var i=vo();oo.flags|=e,i.memoizedState=Oo(1|t,n,void 0,void 0===r?null:r)}function No(e,t,n,r){var i=yo();r=void 0===r?null:r;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==r&&go(r,o.deps))return void(i.memoizedState=Oo(t,n,s,r))}oo.flags|=e,i.memoizedState=Oo(1|t,n,s,r)}function Mo(e,t){return Ro(8390656,8,e,t)}function Lo(e,t){return No(2048,8,e,t)}function Fo(e,t){return No(4,2,e,t)}function Uo(e,t){return No(4,4,e,t)}function jo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,No(4,4,jo.bind(null,t,e),n)}function qo(){}function Vo(e,t){var n=yo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ko(e,t){var n=yo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function zo(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,ya=!0),e.memoizedState=n):(ar(n,t)||(n=gt(),oo.lanes|=n,Lc|=n,e.baseState=!0),t)}function Wo(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=io.transition;io.transition={};try{e(!1),t()}finally{yt=n,io.transition=r}}function Ho(){return yo().memoizedState}function Go(e,t,n){var r=tl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Yo(e))$o(t,n);else if(null!==(n=Rs(e,t,n,r))){nl(n,e,r,el()),Jo(n,t,r)}}function Qo(e,t,n){var r=tl(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yo(e))$o(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var c=t.interleaved;return null===c?(i.next=i,Ds(t)):(i.next=c.next,c.next=i),void(t.interleaved=i)}}catch(l){}null!==(n=Rs(e,t,i,r))&&(nl(n,e,r,i=el()),Jo(n,t,r))}}function Yo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function $o(e,t){uo=lo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Xo={readContext:As,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},Zo={readContext:As,useCallback:function(e,t){return vo().memoizedState=[e,void 0===t?null:t],e},useContext:As,useEffect:Mo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ro(4194308,4,jo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ro(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ro(4,2,e,t)},useMemo:function(e,t){var n=vo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Go.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vo().memoizedState=e},useState:Ao,useDebugValue:qo,useDeferredValue:function(e){return vo().memoizedState=e},useTransition:function(){var e=Ao(!1),t=e[0];return e=Wo.bind(null,e[1]),vo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,i=vo();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Pc)throw Error(s(349));0!==(30&so)||Co(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Mo(ko.bind(null,r,o,e),[e]),r.flags|=2048,Oo(9,So.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=vo(),t=Pc.identifierPrefix;if(is){var n=Ji;t=":"+t+"R"+(n=($i&~(1<<32-ot($i)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:As,useCallback:Vo,useContext:As,useEffect:Lo,useImperativeHandle:Bo,useInsertionEffect:Fo,useLayoutEffect:Uo,useMemo:Ko,useReducer:bo,useRef:Do,useState:function(){return bo(wo)},useDebugValue:qo,useDeferredValue:function(e){return zo(yo(),ao.memoizedState,e)},useTransition:function(){return[bo(wo)[0],yo().memoizedState]},useMutableSource:Io,useSyncExternalStore:To,useId:Ho,unstable_isNewReconciler:!1},ta={readContext:As,useCallback:Vo,useContext:As,useEffect:Lo,useImperativeHandle:Bo,useInsertionEffect:Fo,useLayoutEffect:Uo,useMemo:Ko,useReducer:Eo,useRef:Do,useState:function(){return Eo(wo)},useDebugValue:qo,useDeferredValue:function(e){var t=yo();return null===ao?t.memoizedState=e:zo(t,ao.memoizedState,e)},useTransition:function(){return[Eo(wo)[0],yo().memoizedState]},useMutableSource:Io,useSyncExternalStore:To,useId:Ho,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ra(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=el(),i=tl(e),s=Us(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=js(e,s,i))&&(nl(t,e,i,r),Bs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=el(),i=tl(e),s=Us(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=js(e,s,i))&&(nl(t,e,i,r),Bs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=el(),r=tl(e),i=Us(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=js(e,i,r))&&(nl(t,e,r,n),Bs(t,e,r))}};function sa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(i,s))}function oa(e,t,n){var r=!1,i=ki,s=t.contextType;return"object"===typeof s&&null!==s?s=As(s):(i=Di(t)?Ai:xi.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oi(e,i):ki),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function ca(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ls(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=As(s):(s=Di(t)?Ai:xi.current,i.context=Oi(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ra(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ia.enqueueReplaceState(i,i.state,null),Vs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function la(e,t){try{var n="",r=t;do{n+=q(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var da="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Us(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){zc||(zc=!0,Wc=r),ha(0,t)},n}function pa(e,t,n){(n=Us(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof r&&(null===Hc?Hc=new Set([this]):Hc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ga(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new da;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Cl.bind(null,e,t,n),t.then(e,e))}function ma(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function _a(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Us(-1,1)).tag=2,js(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var va=w.ReactCurrentOwner,ya=!1;function wa(e,t,n,r){t.child=null===e?bs(t,null,n,r):ws(t,e.child,n,r)}function ba(e,t,n,r,i){n=n.render;var s=t.ref;return Ps(t,i),r=mo(e,t,n,r,s,i),n=_o(),null===e||ya?(is&&n&&es(t),t.flags|=1,wa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,za(e,t,i))}function Ea(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Dl(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Nl(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ia(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(o,r)&&e.ref===t.ref)return za(e,t,i)}return t.flags|=1,(e=Rl(s,r)).ref=t.ref,e.return=t,t.child=e}function Ia(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(cr(s,r)&&e.ref===t.ref){if(ya=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,za(e,t,i);0!==(131072&e.flags)&&(ya=!0)}}return Sa(e,t,n,r,i)}function Ta(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Si(Rc,Dc),Dc|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Si(Rc,Dc),Dc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Si(Rc,Dc),Dc|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Si(Rc,Dc),Dc|=r;return wa(e,t,i,n),t.child}function Ca(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Sa(e,t,n,r,i){var s=Di(n)?Ai:xi.current;return s=Oi(t,s),Ps(t,i),n=mo(e,t,n,r,s,i),r=_o(),null===e||ya?(is&&r&&es(t),t.flags|=1,wa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,za(e,t,i))}function ka(e,t,n,r,i){if(Di(n)){var s=!0;Li(t)}else s=!1;if(Ps(t,i),null===t.stateNode)Ka(e,t),oa(t,n,r),ca(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var c=o.context,l=n.contextType;"object"===typeof l&&null!==l?l=As(l):l=Oi(t,l=Di(n)?Ai:xi.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||c!==l)&&aa(t,o,r,l),Ms=!1;var d=t.memoizedState;o.state=d,Vs(t,r,o,i),c=t.memoizedState,a!==r||d!==c||Pi.current||Ms?("function"===typeof u&&(ra(t,n,u,r),c=t.memoizedState),(a=Ms||sa(t,n,a,r,d,c,l))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=l,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Fs(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:na(t.type,a),o.props=l,h=t.pendingProps,d=o.context,"object"===typeof(c=n.contextType)&&null!==c?c=As(c):c=Oi(t,c=Di(n)?Ai:xi.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==c)&&aa(t,o,r,c),Ms=!1,d=t.memoizedState,o.state=d,Vs(t,r,o,i);var p=t.memoizedState;a!==h||d!==p||Pi.current||Ms?("function"===typeof f&&(ra(t,n,f,r),p=t.memoizedState),(l=Ms||sa(t,n,l,r,d,p,c)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=c,r=l):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return xa(e,t,n,r,s,i)}function xa(e,t,n,r,i,s){Ca(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),za(e,t,s);r=t.stateNode,va.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,a,s)):wa(e,t,a,s),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Pa(e){var t=e.stateNode;t.pendingContext?Ni(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ni(0,t.context,!1),Ys(e,t.containerInfo)}function Aa(e,t,n,r,i){return fs(),ps(i),t.flags|=256,wa(e,t,n,r),t.child}var Oa,Da,Ra,Na,Ma={dehydrated:null,treeContext:null,retryLane:0};function La(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fa(e,t,n){var r,i=t.pendingProps,o=Zs.current,a=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Si(Zs,1&o),null===e)return ls(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=i.children,e=i.fallback,a?(i=t.mode,a=t.child,c={mode:"hidden",children:c},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=c):a=Ll(c,i,0,null),e=Ml(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=La(n),t.memoizedState=Ma,e):Ua(t,c));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,ja(e,t,a,r=ua(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Ll({mode:"visible",children:r.children},i,0,null),(o=Ml(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,a),t.child.memoizedState=La(a),t.memoizedState=Ma,o);if(0===(1&t.mode))return ja(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var c=r.dgst;return r=c,ja(e,t,a,r=ua(o=Error(s(419)),r,void 0))}if(c=0!==(a&e.childLanes),ya||c){if(null!==(r=Pc)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ns(e,i),nl(r,e,i,-1))}return gl(),ja(e,t,a,r=ua(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=kl.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,rs=li(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Gi[Qi++]=$i,Gi[Qi++]=Ji,Gi[Qi++]=Yi,$i=e.id,Ji=e.overflow,Yi=t),t=Ua(t,r.children),t.flags|=4096,t)}(e,t,c,i,r,o,n);if(a){a=i.fallback,c=t.mode,r=(o=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&c)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Rl(o,l)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Rl(r,a):(a=Ml(a,c,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,c=null===(c=e.child.memoizedState)?La(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~n,t.memoizedState=Ma,i}return e=(a=e.child).sibling,i=Rl(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ua(e,t){return(t=Ll({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ja(e,t,n,r){return null!==r&&ps(r),ws(t,e.child,null,n),(e=Ua(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ba(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xs(e.return,t,n)}function qa(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Va(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wa(e,t,r.children,n),0!==(2&(r=Zs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ba(e,n,t);else if(19===e.tag)Ba(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Si(Zs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),qa(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}qa(t,!0,n,null,s);break;case"together":qa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ka(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function za(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Lc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Rl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wa(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ha(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ga(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ha(t),null;case 1:case 17:return Di(t.type)&&Ri(),Ha(t),null;case 3:return r=t.stateNode,$s(),Ci(Pi),Ci(xi),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ol(ss),ss=null))),Da(e,t),Ha(t),null;case 5:Xs(t);var i=Qs(Gs.current);if(n=t.type,null!==e&&null!=t.stateNode)Ra(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ha(t),null}if(e=Qs(Ws.current),hs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":jr("cancel",r),jr("close",r);break;case"iframe":case"object":case"embed":jr("load",r);break;case"video":case"audio":for(i=0;i<Mr.length;i++)jr(Mr[i],r);break;case"source":jr("error",r);break;case"img":case"image":case"link":jr("error",r),jr("load",r);break;case"details":jr("toggle",r);break;case"input":$(r,o),jr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},jr("invalid",r);break;case"textarea":ie(r,o),jr("invalid",r)}for(var c in ve(n,o),i=null,o)if(o.hasOwnProperty(c)){var l=o[c];"children"===c?"string"===typeof l?r.textContent!==l&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,l,e),i=["children",""+l]):a.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&jr("scroll",r)}switch(n){case"input":H(r),Z(r,o,!0);break;case"textarea":H(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[di]=t,e[fi]=r,Oa(e,t,!1,!1),t.stateNode=e;e:{switch(c=ye(n,r),n){case"dialog":jr("cancel",e),jr("close",e),i=r;break;case"iframe":case"object":case"embed":jr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Mr.length;i++)jr(Mr[i],e);i=r;break;case"source":jr("error",e),i=r;break;case"img":case"image":case"link":jr("error",e),jr("load",e),i=r;break;case"details":jr("toggle",e),i=r;break;case"input":$(e,r),i=Y(e,r),jr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),jr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),jr("invalid",e)}for(o in ve(n,i),l=i)if(l.hasOwnProperty(o)){var u=l[o];"style"===o?me(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&jr("scroll",e):null!=u&&y(e,o,u,c))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+z(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ha(t),null;case 6:if(e&&null!=t.stateNode)Na(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Qs(Gs.current),Qs(Ws.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Ha(t),null;case 13:if(Ci(Zs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))ds(),fs(),t.flags|=98560,o=!1;else if(o=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[di]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ha(t),o=!1}else null!==ss&&(ol(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Nc&&(Nc=3):gl())),null!==t.updateQueue&&(t.flags|=4),Ha(t),null);case 4:return $s(),Da(e,t),null===e&&Vr(t.stateNode.containerInfo),Ha(t),null;case 10:return ks(t.type._context),Ha(t),null;case 19:if(Ci(Zs),null===(o=t.memoizedState))return Ha(t),null;if(r=0!==(128&t.flags),null===(c=o.rendering))if(r)Wa(o,!1);else{if(0!==Nc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=eo(e))){for(t.flags|=128,Wa(o,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,e=c.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Si(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>Vc&&(t.flags|=128,r=!0,Wa(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!c.alternate&&!is)return Ha(t),null}else 2*Je()-o.renderingStartTime>Vc&&1073741824!==n&&(t.flags|=128,r=!0,Wa(o,!1),t.lanes=4194304);o.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=o.last)?n.sibling=c:t.child=c,o.last=c)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,n=Zs.current,Si(Zs,r?1&n|2:1&n),t):(Ha(t),null);case 22:case 23:return hl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dc)&&(Ha(t),6&t.subtreeFlags&&(t.flags|=8192)):Ha(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qa(e,t){switch(ts(t),t.tag){case 1:return Di(t.type)&&Ri(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $s(),Ci(Pi),Ci(xi),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xs(t),null;case 13:if(Ci(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ci(Zs),null;case 4:return $s(),null;case 10:return ks(t.type._context),null;case 22:case 23:return hl(),null;default:return null}}Oa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Da=function(){},Ra=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qs(Ws.current);var s,o=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var c=i[u];for(s in c)c.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(c=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(s in c)!c.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&c[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(o=o||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&jr("scroll",e),o||c===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Na=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ya=!1,$a=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Xa=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Tl(e,t,r)}else n.current=null}function ec(e,t,n){try{n()}catch(r){Tl(e,t,r)}}var tc=!1;function nc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&ec(t,n,s)}i=i.next}while(i!==r)}}function rc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ic(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sc(e){var t=e.alternate;null!==t&&(e.alternate=null,sc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[gi],delete t[mi],delete t[_i])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function oc(e){return 5===e.tag||3===e.tag||4===e.tag}function ac(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||oc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cc(e,t,n),e=e.sibling;null!==e;)cc(e,t,n),e=e.sibling}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}var uc=null,hc=!1;function dc(e,t,n){for(n=n.child;null!==n;)fc(e,t,n),n=n.sibling}function fc(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:$a||Za(n,t);case 6:var r=uc,i=hc;uc=null,dc(e,t,n),hc=i,null!==(uc=r)&&(hc?(e=uc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):uc.removeChild(n.stateNode));break;case 18:null!==uc&&(hc?(e=uc,n=n.stateNode,8===e.nodeType?ci(e.parentNode,n):1===e.nodeType&&ci(e,n),Vt(e)):ci(uc,n.stateNode));break;case 4:r=uc,i=hc,uc=n.stateNode.containerInfo,hc=!0,dc(e,t,n),uc=r,hc=i;break;case 0:case 11:case 14:case 15:if(!$a&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&ec(n,t,o),i=i.next}while(i!==r)}dc(e,t,n);break;case 1:if(!$a&&(Za(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Tl(n,t,a)}dc(e,t,n);break;case 21:dc(e,t,n);break;case 22:1&n.mode?($a=(r=$a)||null!==n.memoizedState,dc(e,t,n),$a=r):dc(e,t,n);break;default:dc(e,t,n)}}function pc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ja),t.forEach((function(t){var r=xl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,hc=!1;break e;case 3:case 4:uc=c.stateNode.containerInfo,hc=!0;break e}c=c.return}if(null===uc)throw Error(s(160));fc(o,a,i),uc=null,hc=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(u){Tl(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mc(t,e),t=t.sibling}function mc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),_c(e),4&r){try{nc(3,e,e.return),rc(3,e)}catch(m){Tl(e,e.return,m)}try{nc(5,e,e.return)}catch(m){Tl(e,e.return,m)}}break;case 1:gc(t,e),_c(e),512&r&&null!==n&&Za(n,n.return);break;case 5:if(gc(t,e),_c(e),512&r&&null!==n&&Za(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(m){Tl(e,e.return,m)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===o.type&&null!=o.name&&J(i,o),ye(c,a);var u=ye(c,o);for(a=0;a<l.length;a+=2){var h=l[a],d=l[a+1];"style"===h?me(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):y(i,h,d,u)}switch(c){case"input":X(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(m){Tl(e,e.return,m)}}break;case 6:if(gc(t,e),_c(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(m){Tl(e,e.return,m)}}break;case 3:if(gc(t,e),_c(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(m){Tl(e,e.return,m)}break;case 4:default:gc(t,e),_c(e);break;case 13:gc(t,e),_c(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(qc=Je())),4&r&&pc(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?($a=(u=$a)||h,gc(t,e),$a=u):gc(t,e),_c(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Xa=e,h=e.child;null!==h;){for(d=Xa=h;null!==Xa;){switch(p=(f=Xa).child,f.tag){case 0:case 11:case 14:case 15:nc(4,f,f.return);break;case 1:Za(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Tl(r,n,m)}}break;case 5:Za(f,f.return);break;case 22:if(null!==f.memoizedState){bc(d);continue}}null!==p?(p.return=f,Xa=p):bc(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(c=d.stateNode,a=void 0!==(l=d.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=ge("display",a))}catch(m){Tl(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Tl(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gc(t,e),_c(e),4&r&&pc(e);case 21:}}function _c(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(oc(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),lc(e,ac(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;cc(e,ac(e),o);break;default:throw Error(s(161))}}catch(a){Tl(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vc(e,t,n){Xa=e,yc(e,t,n)}function yc(e,t,n){for(var r=0!==(1&e.mode);null!==Xa;){var i=Xa,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Ya;if(!o){var a=i.alternate,c=null!==a&&null!==a.memoizedState||$a;a=Ya;var l=$a;if(Ya=o,($a=c)&&!l)for(Xa=i;null!==Xa;)c=(o=Xa).child,22===o.tag&&null!==o.memoizedState?Ec(i):null!==c?(c.return=o,Xa=c):Ec(i);for(;null!==s;)Xa=s,yc(s,t,n),s=s.sibling;Xa=i,Ya=a,$a=l}wc(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Xa=s):wc(e)}}function wc(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$a||rc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$a)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ks(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ks(t,a,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Vt(d)}}}break;default:throw Error(s(163))}$a||512&t.flags&&ic(t)}catch(f){Tl(t,t.return,f)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function bc(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function Ec(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rc(4,t)}catch(c){Tl(t,n,c)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(c){Tl(t,i,c)}}var s=t.return;try{ic(t)}catch(c){Tl(t,s,c)}break;case 5:var o=t.return;try{ic(t)}catch(c){Tl(t,o,c)}}}catch(c){Tl(t,t.return,c)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var Ic,Tc=Math.ceil,Cc=w.ReactCurrentDispatcher,Sc=w.ReactCurrentOwner,kc=w.ReactCurrentBatchConfig,xc=0,Pc=null,Ac=null,Oc=0,Dc=0,Rc=Ti(0),Nc=0,Mc=null,Lc=0,Fc=0,Uc=0,jc=null,Bc=null,qc=0,Vc=1/0,Kc=null,zc=!1,Wc=null,Hc=null,Gc=!1,Qc=null,Yc=0,$c=0,Jc=null,Xc=-1,Zc=0;function el(){return 0!==(6&xc)?Je():-1!==Xc?Xc:Xc=Je()}function tl(e){return 0===(1&e.mode)?1:0!==(2&xc)&&0!==Oc?Oc&-Oc:null!==gs.transition?(0===Zc&&(Zc=gt()),Zc):0!==(e=yt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nl(e,t,n,r){if(50<$c)throw $c=0,Jc=null,Error(s(185));_t(e,n,r),0!==(2&xc)&&e===Pc||(e===Pc&&(0===(2&xc)&&(Fc|=n),4===Nc&&al(e,Oc)),rl(e,r),1===n&&0===xc&&0===(1&t.mode)&&(Vc=Je()+500,ji&&Vi()))}function rl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,c=i[o];-1===c?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):c<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=dt(e,e===Pc?Oc:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){ji=!0,qi(e)}(cl.bind(null,e)):qi(cl.bind(null,e)),oi((function(){0===(6&xc)&&Vi()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pl(n,il.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function il(e,t){if(Xc=-1,Zc=0,0!==(6&xc))throw Error(s(327));var n=e.callbackNode;if(El()&&e.callbackNode!==n)return null;var r=dt(e,e===Pc?Oc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=ml(e,r);else{t=r;var i=xc;xc|=2;var o=pl();for(Pc===e&&Oc===t||(Kc=null,Vc=Je()+500,dl(e,t));;)try{vl();break}catch(c){fl(e,c)}Ss(),Cc.current=o,xc=i,null!==Ac?t=0:(Pc=null,Oc=0,t=Nc)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=sl(e,i))),1===t)throw n=Mc,dl(e,0),al(e,r),rl(e,Je()),n;if(6===t)al(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=ml(e,r))&&(0!==(o=pt(e))&&(r=o,t=sl(e,o))),1===t))throw n=Mc,dl(e,0),al(e,r),rl(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:bl(e,Bc,Kc);break;case 3:if(al(e,r),(130023424&r)===r&&10<(t=qc+500-Je())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){el(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(bl.bind(null,e,Bc,Kc),t);break}bl(e,Bc,Kc);break;case 4:if(al(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tc(r/1960))-r)){e.timeoutHandle=ri(bl.bind(null,e,Bc,Kc),r);break}bl(e,Bc,Kc);break;default:throw Error(s(329))}}}return rl(e,Je()),e.callbackNode===n?il.bind(null,e):null}function sl(e,t){var n=jc;return e.current.memoizedState.isDehydrated&&(dl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=Bc,Bc=n,null!==t&&ol(t)),e}function ol(e){null===Bc?Bc=e:Bc.push.apply(Bc,e)}function al(e,t){for(t&=~Uc,t&=~Fc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cl(e){if(0!==(6&xc))throw Error(s(327));El();var t=dt(e,0);if(0===(1&t))return rl(e,Je()),null;var n=ml(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sl(e,r))}if(1===n)throw n=Mc,dl(e,0),al(e,t),rl(e,Je()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bl(e,Bc,Kc),rl(e,Je()),null}function ll(e,t){var n=xc;xc|=1;try{return e(t)}finally{0===(xc=n)&&(Vc=Je()+500,ji&&Vi())}}function ul(e){null!==Qc&&0===Qc.tag&&0===(6&xc)&&El();var t=xc;xc|=1;var n=kc.transition,r=yt;try{if(kc.transition=null,yt=1,e)return e()}finally{yt=r,kc.transition=n,0===(6&(xc=t))&&Vi()}}function hl(){Dc=Rc.current,Ci(Rc)}function dl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Ac)for(n=Ac.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ri();break;case 3:$s(),Ci(Pi),Ci(xi),no();break;case 5:Xs(r);break;case 4:$s();break;case 13:case 19:Ci(Zs);break;case 10:ks(r.type._context);break;case 22:case 23:hl()}n=n.return}if(Pc=e,Ac=e=Rl(e.current,null),Oc=Dc=t,Nc=0,Mc=null,Uc=Fc=Lc=0,Bc=jc=null,null!==Os){for(t=0;t<Os.length;t++)if(null!==(r=(n=Os[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Os=null}return e}function fl(e,t){for(;;){var n=Ac;try{if(Ss(),ro.current=Xo,lo){for(var r=oo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}lo=!1}if(so=0,co=ao=oo=null,uo=!1,ho=0,Sc.current=null,null===n||null===n.return){Nc=1,Mc=t,Ac=null;break}e:{var o=e,a=n.return,c=n,l=t;if(t=Oc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,h=c,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ma(a);if(null!==p){p.flags&=-257,_a(p,a,c,0,t),1&p.mode&&ga(o,u,t),l=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(0===(1&t)){ga(o,u,t),gl();break e}l=Error(s(426))}else if(is&&1&c.mode){var _=ma(a);if(null!==_){0===(65536&_.flags)&&(_.flags|=256),_a(_,a,c,0,t),ps(la(l,c));break e}}o=l=la(l,c),4!==Nc&&(Nc=2),null===jc?jc=[o]:jc.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,qs(o,fa(0,l,t));break e;case 1:c=l;var v=o.type,y=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Hc||!Hc.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t,qs(o,pa(o,c,t));break e}}o=o.return}while(null!==o)}wl(n)}catch(w){t=w,Ac===n&&null!==n&&(Ac=n=n.return);continue}break}}function pl(){var e=Cc.current;return Cc.current=Xo,null===e?Xo:e}function gl(){0!==Nc&&3!==Nc&&2!==Nc||(Nc=4),null===Pc||0===(268435455&Lc)&&0===(268435455&Fc)||al(Pc,Oc)}function ml(e,t){var n=xc;xc|=2;var r=pl();for(Pc===e&&Oc===t||(Kc=null,dl(e,t));;)try{_l();break}catch(i){fl(e,i)}if(Ss(),xc=n,Cc.current=r,null!==Ac)throw Error(s(261));return Pc=null,Oc=0,Nc}function _l(){for(;null!==Ac;)yl(Ac)}function vl(){for(;null!==Ac&&!Ye();)yl(Ac)}function yl(e){var t=Ic(e.alternate,e,Dc);e.memoizedProps=e.pendingProps,null===t?wl(e):Ac=t,Sc.current=null}function wl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ga(n,t,Dc)))return void(Ac=n)}else{if(null!==(n=Qa(n,t)))return n.flags&=32767,void(Ac=n);if(null===e)return Nc=6,void(Ac=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ac=t);Ac=t=e}while(null!==t);0===Nc&&(Nc=5)}function bl(e,t,n){var r=yt,i=kc.transition;try{kc.transition=null,yt=1,function(e,t,n,r){do{El()}while(null!==Qc);if(0!==(6&xc))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Pc&&(Ac=Pc=null,Oc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gc||(Gc=!0,Pl(tt,(function(){return El(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=kc.transition,kc.transition=null;var a=yt;yt=1;var c=xc;xc|=4,Sc.current=null,function(e,t){if(ei=zt,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(b){n=null;break e}var a=0,c=-1,l=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(c=a+i),d!==o||0!==r&&3!==d.nodeType||(l=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(c=a),f===o&&++h===r&&(l=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},zt=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,_=g.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:na(t.type,m),_);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(b){Tl(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}g=tc,tc=!1}(e,n),mc(n,e),pr(ti),zt=!!ei,ti=ei=null,e.current=n,vc(n,e,i),$e(),xc=c,yt=a,kc.transition=o}else e.current=n;if(Gc&&(Gc=!1,Qc=e,Yc=i),o=e.pendingLanes,0===o&&(Hc=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rl(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(zc)throw zc=!1,e=Wc,Wc=null,e;0!==(1&Yc)&&0!==e.tag&&El(),o=e.pendingLanes,0!==(1&o)?e===Jc?$c++:($c=0,Jc=e):$c=0,Vi()}(e,t,n,r)}finally{kc.transition=i,yt=r}return null}function El(){if(null!==Qc){var e=wt(Yc),t=kc.transition,n=yt;try{if(kc.transition=null,yt=16>e?16:e,null===Qc)var r=!1;else{if(e=Qc,Qc=null,Yc=0,0!==(6&xc))throw Error(s(331));var i=xc;for(xc|=4,Xa=e.current;null!==Xa;){var o=Xa,a=o.child;if(0!==(16&Xa.flags)){var c=o.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Xa=u;null!==Xa;){var h=Xa;switch(h.tag){case 0:case 11:case 15:nc(8,h,o)}var d=h.child;if(null!==d)d.return=h,Xa=d;else for(;null!==Xa;){var f=(h=Xa).sibling,p=h.return;if(sc(h),h===u){Xa=null;break}if(null!==f){f.return=p,Xa=f;break}Xa=p}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(null!==m)}}Xa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(o=Xa).flags))switch(o.tag){case 0:case 11:case 15:nc(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Xa=v;break e}Xa=o.return}}var y=e.current;for(Xa=y;null!==Xa;){var w=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Xa=w;else e:for(a=y;null!==Xa;){if(0!==(2048&(c=Xa).flags))try{switch(c.tag){case 0:case 11:case 15:rc(9,c)}}catch(E){Tl(c,c.return,E)}if(c===a){Xa=null;break e}var b=c.sibling;if(null!==b){b.return=c.return,Xa=b;break e}Xa=c.return}}if(xc=i,Vi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(E){}r=!0}return r}finally{yt=n,kc.transition=t}}return!1}function Il(e,t,n){e=js(e,t=fa(0,t=la(n,t),1),1),t=el(),null!==e&&(_t(e,1,t),rl(e,t))}function Tl(e,t,n){if(3===e.tag)Il(e,e,n);else for(;null!==t;){if(3===t.tag){Il(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hc||!Hc.has(r))){t=js(t,e=pa(t,e=la(n,e),1),1),e=el(),null!==t&&(_t(t,1,e),rl(t,e));break}}t=t.return}}function Cl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&n,Pc===e&&(Oc&n)===n&&(4===Nc||3===Nc&&(130023424&Oc)===Oc&&500>Je()-qc?dl(e,0):Uc|=n),rl(e,t)}function Sl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=el();null!==(e=Ns(e,t))&&(_t(e,t,n),rl(e,n))}function kl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Sl(e,n)}function xl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Sl(e,n)}function Pl(e,t){return Ge(e,t)}function Al(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ol(e,t,n,r){return new Al(e,t,n,r)}function Dl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rl(e,t){var n=e.alternate;return null===n?((n=Ol(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Nl(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Dl(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case I:return Ml(n.children,i,o,t);case T:a=8,i|=8;break;case C:return(e=Ol(12,n,t,2|i)).elementType=C,e.lanes=o,e;case P:return(e=Ol(13,n,t,i)).elementType=P,e.lanes=o,e;case A:return(e=Ol(19,n,t,i)).elementType=A,e.lanes=o,e;case R:return Ll(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:a=10;break e;case k:a=9;break e;case x:a=11;break e;case O:a=14;break e;case D:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ol(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Ml(e,t,n,r){return(e=Ol(7,e,r,t)).lanes=n,e}function Ll(e,t,n,r){return(e=Ol(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Fl(e,t,n){return(e=Ol(6,e,null,t)).lanes=n,e}function Ul(e,t,n){return(t=Ol(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jl(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bl(e,t,n,r,i,s,o,a,c){return e=new jl(e,t,n,a,c),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ol(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ls(s),e}function ql(e){if(!e)return ki;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Di(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Di(n))return Mi(e,n,t)}return t}function Vl(e,t,n,r,i,s,o,a,c){return(e=Bl(n,r,!0,e,0,s,0,a,c)).context=ql(null),n=e.current,(s=Us(r=el(),i=tl(n))).callback=void 0!==t&&null!==t?t:null,js(n,s,i),e.current.lanes=i,_t(e,i,r),rl(e,r),e}function Kl(e,t,n,r){var i=t.current,s=el(),o=tl(i);return n=ql(n),null===t.context?t.context=n:t.pendingContext=n,(t=Us(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=js(i,t,o))&&(nl(e,i,o,s),Bs(e,i,o)),o}function zl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hl(e,t){Wl(e,t),(e=e.alternate)&&Wl(e,t)}Ic=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pi.current)ya=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ya=!1,function(e,t,n){switch(t.tag){case 3:Pa(t),fs();break;case 5:Js(t);break;case 1:Di(t.type)&&Li(t);break;case 4:Ys(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Si(Es,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Si(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fa(e,t,n):(Si(Zs,1&Zs.current),null!==(e=za(e,t,n))?e.sibling:null);Si(Zs,1&Zs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Va(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Si(Zs,Zs.current),r)break;return null;case 22:case 23:return t.lanes=0,Ta(e,t,n)}return za(e,t,n)}(e,t,n);ya=0!==(131072&e.flags)}else ya=!1,is&&0!==(1048576&t.flags)&&Zi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ka(e,t),e=t.pendingProps;var i=Oi(t,xi.current);Ps(t,n),i=mo(null,t,r,e,i,n);var o=_o();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Di(r)?(o=!0,Li(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ls(t),i.updater=ia,t.stateNode=i,i._reactInternals=t,ca(t,r,e,n),t=xa(null,t,r,!0,o,n)):(t.tag=0,is&&o&&es(t),wa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ka(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Dl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===x)return 11;if(e===O)return 14}return 2}(r),e=na(r,e),i){case 0:t=Sa(null,t,r,e,n);break e;case 1:t=ka(null,t,r,e,n);break e;case 11:t=ba(null,t,r,e,n);break e;case 14:t=Ea(null,t,r,na(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Sa(e,t,r,i=t.elementType===r?i:na(r,i),n);case 1:return r=t.type,i=t.pendingProps,ka(e,t,r,i=t.elementType===r?i:na(r,i),n);case 3:e:{if(Pa(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Fs(e,t),Vs(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Aa(e,t,r,n,i=la(Error(s(423)),t));break e}if(r!==i){t=Aa(e,t,r,n,i=la(Error(s(424)),t));break e}for(rs=li(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=bs(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=za(e,t,n);break e}wa(e,t,r,n)}t=t.child}return t;case 5:return Js(t),null===e&&ls(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==o&&ni(r,o)&&(t.flags|=32),Ca(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&ls(t),null;case 13:return Fa(e,t,n);case 4:return Ys(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ba(e,t,r,i=t.elementType===r?i:na(r,i),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Si(Es,r._currentValue),r._currentValue=a,null!==o)if(ar(o.value,a)){if(o.children===i.children&&!Pi.current){t=za(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var c=o.dependencies;if(null!==c){a=o.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===o.tag){(l=Us(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),xs(o.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),xs(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ps(t,n),r=r(i=As(i)),t.flags|=1,wa(e,t,r,n),t.child;case 14:return i=na(r=t.type,t.pendingProps),Ea(e,t,r,i=na(r.type,i),n);case 15:return Ia(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:na(r,i),Ka(e,t),t.tag=1,Di(r)?(e=!0,Li(t)):e=!1,Ps(t,n),oa(t,r,i),ca(t,r,i,n),xa(null,t,r,!0,e,n);case 19:return Va(e,t,n);case 22:return Ta(e,t,n)}throw Error(s(156,t.tag))};var Gl="function"===typeof reportError?reportError:function(e){console.error(e)};function Ql(e){this._internalRoot=e}function Yl(e){this._internalRoot=e}function $l(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xl(){}function Zl(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=zl(o);a.call(e)}}Kl(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=zl(o);s.call(e)}}var o=Vl(t,r,e,0,null,!1,0,"",Xl);return e._reactRootContainer=o,e[pi]=o.current,Vr(8===e.nodeType?e.parentNode:e),ul(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=zl(c);a.call(e)}}var c=Bl(e,0,!1,null,0,!1,0,"",Xl);return e._reactRootContainer=c,e[pi]=c.current,Vr(8===e.nodeType?e.parentNode:e),ul((function(){Kl(t,c,n,r)})),c}(n,t,e,i,r);return zl(o)}Yl.prototype.render=Ql.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Kl(e,t,null,null)},Yl.prototype.unmount=Ql.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ul((function(){Kl(null,e,null,null)})),t[pi]=null}},Yl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Ft(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(vt(t,1|n),rl(t,Je()),0===(6&xc)&&(Vc=Je()+500,Vi()))}break;case 13:ul((function(){var t=Ns(e,1);if(null!==t){var n=el();nl(t,e,1,n)}})),Hl(e,1)}},Et=function(e){if(13===e.tag){var t=Ns(e,134217728);if(null!==t)nl(t,e,134217728,el());Hl(e,134217728)}},It=function(e){if(13===e.tag){var t=tl(e),n=Ns(e,t);if(null!==n)nl(n,e,t,el());Hl(e,t)}},Tt=function(){return yt},Ct=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},Ee=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=bi(r);if(!i)throw Error(s(90));G(r),X(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},xe=ll,Pe=ul;var eu={usingClientEntryPoint:!1,Events:[yi,wi,bi,Se,ke,ll]},tu={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$l(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$l(e))throw Error(s(299));var n=!1,r="",i=Gl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Bl(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Ql(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return ul(e)},t.hydrate=function(e,t,n){if(!Jl(t))throw Error(s(200));return Zl(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$l(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Gl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Vl(t,null,e,1,null!=n?n:null,i,0,o,a),e[pi]=t.current,Vr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yl(t)},t.render=function(e,t,n){if(!Jl(t))throw Error(s(200));return Zl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jl(e))throw Error(s(40));return!!e._reactRootContainer&&(ul((function(){Zl(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jl(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zl(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},746:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(995).A)("Send",[["line",{x1:"22",x2:"11",y1:"2",y2:"13",key:"2qtwb"}],["polygon",{points:"22 2 15 22 11 13 2 9 22 2",key:"12uapv"}]])},765:(e,t,n)=>{n.d(t,{db:()=>Ha,BV:()=>Qa,$2:()=>Ga,BW:()=>$a,IG:()=>Ya});var r=n(529),i=n(812),s=n(52),o=n(443);class a{constructor(e,t){this._delegate=e,this.firebase=t,(0,s._addComponent)(e,new i.uA("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),(0,s.deleteApp)(this._delegate))))}_getService(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s._DEFAULT_ENTRY_NAME;var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s._DEFAULT_ENTRY_NAME;this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){(0,s._addComponent)(this._delegate,e)}_addOrOverwriteComponent(e){(0,s._addOrOverwriteComponent)(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const c={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},l=new r.FA("app-compat","Firebase",c);const u=function e(){const t=function(e){const t={},n={__esModule:!0,initializeApp:function(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=s.initializeApp(i,o);if((0,r.gR)(t,a.name))return t[a.name];const c=new e(a,n);return t[a.name]=c,c},app:i,registerVersion:s.registerVersion,setLogLevel:s.setLogLevel,onLog:s.onLog,apps:null,SDK_VERSION:s.SDK_VERSION,INTERNAL:{registerComponent:function(t){const o=t.name,a=o.replace("-compat","");if(s._registerComponent(t)&&"PUBLIC"===t.type){const s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i();if("function"!==typeof e[a])throw l.create("invalid-app-argument",{appName:o});return e[a]()};void 0!==t.serviceProps&&(0,r.zw)(s,t.serviceProps),n[a]=s,e.prototype[a]=function(){const e=this._getService.bind(this,o);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.apply(this,t.multipleInstances?r:[])}}return"PUBLIC"===t.type?n[a]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:s}};function i(e){if(e=e||s._DEFAULT_ENTRY_NAME,!(0,r.gR)(t,e))throw l.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((e=>t[e]))}}),i.App=e,n}(a);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){(0,r.zw)(t,e)},createSubscribe:r.tD,ErrorFactory:r.FA,deepExtend:r.zw}),t}(),h=new o.Vy("@firebase/app-compat");try{const e=(0,r.mS)();if(void 0!==e.firebase){h.warn("\n      Warning: Firebase is already defined in the global scope. Please make sure\n      Firebase library is only loaded once.\n    ");const t=e.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&h.warn("\n        Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n        ")}}catch(Ja){}const d=u;var f;(0,s.registerVersion)("@firebase/app-compat","0.4.1",f);d.registerVersion("firebase","11.9.1","app-compat");function p(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;const g="facebook.com",m="github.com",_="google.com",v="password",y="twitter.com",w="EMAIL_SIGNIN",b="PASSWORD_RESET",E="RECOVER_EMAIL",I="REVERT_SECOND_FACTOR_ADDITION",T="VERIFY_AND_CHANGE_EMAIL",C="VERIFY_EMAIL";function S(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const k=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}},x=S,P=new r.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),A=new o.Vy("@firebase/auth");function O(e){if(A.logLevel<=o.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];A.error("Auth (".concat(s.SDK_VERSION,"): ").concat(e),...n)}}function D(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw F(e,...n)}function R(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return F(e,...n)}function N(e,t,n){const i=Object.assign(Object.assign({},x()),{[t]:n});return new r.FA("auth","Firebase",i).create(t,{appName:e.name})}function M(e){return N(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function L(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&D(e,"argument-error"),N(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function F(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return P.create(e,...n)}function U(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw F(t,...r)}}function j(e){const t="INTERNAL ASSERTION FAILED: "+e;throw O(t),new Error(t)}function B(e,t){e||j(t)}function q(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function V(){return"http:"===K()||"https:"===K()}function K(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class z{constructor(e,t){this.shortDelay=e,this.longDelay=t,B(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,r.jZ)()||(0,r.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(V()||(0,r.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function W(e,t){B(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class H{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void j("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void j("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void j("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const G={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Q=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Y=new z(3e4,6e4);function $(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function J(e,t,n,i){return X(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let s={},o={};i&&("GET"===t?o=i:s={body:JSON.stringify(i)});const a=(0,r.Am)(Object.assign({key:e.config.apiKey},o)).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:c},s);return(0,r.c1)()||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,r.zJ)(e.emulatorConfig.host)&&(l.credentials="include"),H.fetch()(await ee(e,e.config.apiHost,n,a),l)}))}async function X(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},G),t);try{const t=new ne(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw re(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw re(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw re(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw re(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw N(e,a,o);D(e,a)}}catch(s){if(s instanceof r.g)throw s;D(e,"network-request-failed",{message:String(s)})}}async function Z(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await J(e,t,n,r,i);return"mfaPendingCredential"in s&&D(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function ee(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r),s=e,o=s.config.emulator?W(e.config,i):"".concat(e.config.apiScheme,"://").concat(i);if(Q.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(o).toString()}return o}function te(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ne{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(R(this.auth,"network-request-failed"))),Y.get())}))}}function re(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=R(e,t,r);return i.customData._tokenResponse=n,i}function ie(e){return void 0!==e&&void 0!==e.getResponse}function se(e){return void 0!==e&&void 0!==e.enterprise}class oe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return te(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function ae(e,t){return J(e,"GET","/v2/recaptchaConfig",$(e,t))}async function ce(e,t){return J(e,"POST","/v1/accounts:lookup",t)}function le(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function ue(e){return 1e3*Number(e)}function he(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return O("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,r.u)(n);return e?JSON.parse(e):(O("Failed to decode base64 JWT payload"),null)}catch(s){return O("Caught error parsing JWT payload as JSON",null===s||void 0===s?void 0:s.toString()),null}}function de(e){const t=he(e);return U(t,"internal-error"),U("undefined"!==typeof t.exp,"internal-error"),U("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function fe(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof r.g&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class pe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class ge{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=le(this.lastLoginAt),this.creationTime=le(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function me(e){var t;const n=e.auth,r=await e.getIdToken(),i=await fe(e,ce(n,{idToken:r}));U(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?_e(s.providerUserInfo):[],a=(c=e.providerData,l=o,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,h=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ge(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function _e(e){return e.map((e=>{var{providerId:t}=e,n=p(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class ve{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U("undefined"!==typeof e.idToken,"internal-error"),U("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):de(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(0!==e.length,"internal-error");const t=de(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(e,t){const n=await X(e,{},(async()=>{const n=(0,r.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,o=await ee(e,i,"/v1/token","key=".concat(s)),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:n};return e.emulatorConfig&&(0,r.zJ)(e.emulatorConfig.host)&&(c.credentials="include"),H.fetch()(o,c)}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new ve;return n&&(U("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(U("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(U("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ve,this.toJSON())}_performRefresh(){return j("not implemented")}}function ye(e,t){U("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class we{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=p(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new pe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ge(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await fe(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,r.Ku)(e),i=await n.getIdToken(t),s=he(i);U(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o="object"===typeof s.firebase?s.firebase:void 0,a=null===o||void 0===o?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:le(ue(s.auth_time)),issuedAtTime:le(ue(s.iat)),expirationTime:le(ue(s.exp)),signInProvider:a||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,r.Ku)(e);await me(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new we(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await me(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,s._isFirebaseServerApp)(this.auth.app))return Promise.reject(M(this.auth));const e=await this.getIdToken();return await fe(this,async function(e,t){return J(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,_=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:v,emailVerified:y,isAnonymous:w,providerData:b,stsTokenManager:E}=t;U(v&&E,e,"internal-error");const I=ve.fromJSON(this.name,E);U("string"===typeof v,e,"internal-error"),ye(u,e.name),ye(h,e.name),U("boolean"===typeof y,e,"internal-error"),U("boolean"===typeof w,e,"internal-error"),ye(d,e.name),ye(f,e.name),ye(p,e.name),ye(g,e.name),ye(m,e.name),ye(_,e.name);const T=new we({uid:v,auth:e,email:h,emailVerified:y,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:m,lastLoginAt:_});return b&&Array.isArray(b)&&(T.providerData=b.map((e=>Object.assign({},e)))),g&&(T._redirectEventId=g),T}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new ve;r.updateFromServerResponse(t);const i=new we({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await me(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];U(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?_e(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),o=new ve;o.updateFromIdToken(n);const a=new we({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new ge(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,c),a}}const be=new Map;function Ee(e){B(e instanceof Function,"Expected a class definition");let t=be.get(e);return t?(B(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,be.set(e,t),t)}class Ie{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ie.type="NONE";const Te=Ie;function Ce(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class Se{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Ce(this.userKey,r.apiKey,i),this.fullPersistenceKey=Ce("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await ce(this.auth,{idToken:e}).catch((()=>{}));return t?we._fromGetAccountInfoResponse(this.auth,t,e):null}return we._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Se(Ee(Te),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||Ee(Te);const s=Ce(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){let n;if("string"===typeof t){const r=await ce(e,{idToken:t}).catch((()=>{}));if(!r)break;n=await we._fromGetAccountInfoResponse(e,r,t)}else n=we._fromJSON(e,t);c!==i&&(o=n),i=c;break}}catch(Ja){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(Ja){}}))),new Se(i,e,n)):new Se(i,e,n)}}function ke(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Oe(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(xe(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Re(t))return"Blackberry";if(Ne(t))return"Webos";if(Pe(t))return"Safari";if((t.includes("chrome/")||Ae(t))&&!t.includes("edge/"))return"Chrome";if(De(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function xe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/firefox\//i.test(e)}function Pe(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ae(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/crios\//i.test(e)}function Oe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/iemobile/i.test(e)}function De(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/android/i.test(e)}function Re(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/blackberry/i.test(e)}function Ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/webos/i.test(e)}function Me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Le(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return Me(e)||De(e)||Ne(e)||Re(e)||/windows phone/i.test(e)||Oe(e)}function Fe(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ke((0,r.ZQ)());break;case"Worker":t="".concat(ke((0,r.ZQ)()),"-").concat(e);break;default:t=e}const i=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(s.SDK_VERSION,"/").concat(i)}class Ue{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(i){r(i)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class je{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Be{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ve(this),this.idTokenSubscription=new Ve(this),this.beforeStateQueue=new Ue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=P,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise((e=>this._resolvePersistenceManagerAvailable=e))}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ee(t)),this._initializationPromise=this.queue((async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await Se.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await ce(this,{idToken:e}),n=await we._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if((0,s._isFirebaseServerApp)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(o)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await me(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,s._isFirebaseServerApp)(this.app))return Promise.reject(M(this));const t=e?(0,r.Ku)(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(0,s._isFirebaseServerApp)(this.app)?Promise.reject(M(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,s._isFirebaseServerApp)(this.app)?Promise.reject(M(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Ee(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return J(e,"GET","/v2/passwordPolicy",$(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new je(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new r.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return J(e,"POST","/v2/accounts:revokeToken",$(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ee(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=await Se.create(this,[Ee(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Fe(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if((0,s._isFirebaseServerApp)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(A.logLevel<=o.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];A.warn("Auth (".concat(s.SDK_VERSION,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function qe(e){return(0,r.Ku)(e)}class Ve{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,r.tD)((e=>this.observer=e))}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ke={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ze(e){return Ke.loadJS(e)}function We(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}const He=1e12;class Ge{constructor(e){this.auth=e,this.counter=He,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new $e(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||He;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||He;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||He;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Qe{constructor(){this.enterprise=new Ye}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Ye{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class $e{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"===typeof e?document.getElementById(e):e;U(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Je="NO_RECAPTCHA";class Xe{constructor(e){this.type="recaptcha-enterprise",this.auth=qe(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;se(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n(Je)}))})):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Qe).execute("siteKey",{action:"verify"})}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{ae(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new oe(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&se(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Ke.recaptchaEnterpriseScript;0!==t.length&&(t+=i),ze(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Ze(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=new Xe(e);let o;if(i)o=Je;else try{o=await s.verify(n)}catch(c){o=await s.verify(n,!0)}const a=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function et(e,t,n,r,i){var s,o;if("EMAIL_PASSWORD_PROVIDER"===i){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ze(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await Ze(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}if("PHONE_PROVIDER"===i){if(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("PHONE_PROVIDER")){const i=await Ze(e,t,n);return r(e,i).catch((async i=>{var s;if("AUDIT"===(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))&&(i.code==="auth/".concat("missing-recaptcha-token")||i.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const i=await Ze(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)}))}{const i=await Ze(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function tt(e){const t=qe(e),n=await ae(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new oe(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Xe(t).verify()}}function nt(e,t,n){const i=qe(e);U(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const s=!!(null===n||void 0===n?void 0:n.disableWarnings),o=rt(t),{host:a,port:c}=function(e){const t=rt(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:it(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:it(t)}}}(t),l=null===c?"":":".concat(c),u={url:"".concat(o,"//").concat(a).concat(l,"/")},h=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator)return U(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),void U((0,r.bD)(u,i.config.emulator)&&(0,r.bD)(h,i.emulatorConfig),i,"emulator-config-failed");i.config.emulator=u,i.emulatorConfig=h,i.settings.appVerificationDisabledForTesting=!0,(0,r.zJ)(a)?((0,r.gE)("".concat(o,"//").concat(a).concat(l)),(0,r.P1)("Auth",!0)):s||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function rt(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function it(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class st{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return j("not implemented")}_getIdTokenResponse(e){return j("not implemented")}_linkToIdToken(e,t){return j("not implemented")}_getReauthenticationResolver(e){return j("not implemented")}}async function ot(e,t){return J(e,"POST","/v1/accounts:resetPassword",$(e,t))}async function at(e,t){return J(e,"POST","/v1/accounts:signUp",t)}async function ct(e,t){return Z(e,"POST","/v1/accounts:signInWithPassword",$(e,t))}async function lt(e,t){return J(e,"POST","/v1/accounts:sendOobCode",$(e,t))}async function ut(e,t){return lt(e,t)}async function ht(e,t){return lt(e,t)}class dt extends st{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new dt(e,t,"password")}static _fromEmailAndCode(e,t){return new dt(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return et(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ct,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Z(e,"POST","/v1/accounts:signInWithEmailLink",$(e,t))}(e,{email:this._email,oobCode:this._password});default:D(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return et(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",at,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Z(e,"POST","/v1/accounts:signInWithEmailLink",$(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:D(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ft(e,t){return Z(e,"POST","/v1/accounts:signInWithIdp",$(e,t))}class pt extends st{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):D("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=p(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new pt(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return ft(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ft(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ft(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,r.Am)(t)}return e}}async function gt(e,t){return J(e,"POST","/v1/accounts:sendVerificationCode",$(e,t))}const mt={USER_NOT_FOUND:"user-not-found"};class _t extends st{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new _t({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new _t({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Z(e,"POST","/v1/accounts:signInWithPhoneNumber",$(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Z(e,"POST","/v1/accounts:signInWithPhoneNumber",$(e,t));if(n.temporaryProof)throw re(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Z(e,"POST","/v1/accounts:signInWithPhoneNumber",$(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),mt)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new _t({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class vt{constructor(e){var t,n,i,s,o,a;const c=(0,r.I9)((0,r.hp)(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,u=null!==(n=c.oobCode)&&void 0!==n?n:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);U(l&&u&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=u,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.lang)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=(0,r.I9)((0,r.hp)(e)).link,n=t?(0,r.I9)((0,r.hp)(t)).deep_link_id:null,i=(0,r.I9)((0,r.hp)(e)).deep_link_id;return(i?(0,r.I9)((0,r.hp)(i)).link:null)||i||n||t||e}(e);try{return new vt(t)}catch(Ja){return null}}}class yt{constructor(){this.providerId=yt.PROVIDER_ID}static credential(e,t){return dt._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=vt.parseLink(t);return U(n,"argument-error"),dt._fromEmailAndCode(e,n.code,n.tenantId)}}yt.PROVIDER_ID="password",yt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",yt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class wt{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class bt extends wt{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Et extends bt{static credentialFromJSON(e){const t="string"===typeof e?JSON.parse(e):e;return U("providerId"in t&&"signInMethod"in t,"argument-error"),pt._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return U(e.idToken||e.accessToken,"argument-error"),pt._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Et.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Et.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=t;if(!r&&!i&&!n&&!s)return null;if(!a)return null;try{return new Et(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch(c){return null}}}class It extends bt{constructor(){super("facebook.com")}static credential(e){return pt._fromParams({providerId:It.PROVIDER_ID,signInMethod:It.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return It.credentialFromTaggedObject(e)}static credentialFromError(e){return It.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return It.credential(t.oauthAccessToken)}catch(Ja){return null}}}It.FACEBOOK_SIGN_IN_METHOD="facebook.com",It.PROVIDER_ID="facebook.com";class Tt extends bt{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pt._fromParams({providerId:Tt.PROVIDER_ID,signInMethod:Tt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Tt.credentialFromTaggedObject(e)}static credentialFromError(e){return Tt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Tt.credential(n,r)}catch(Ja){return null}}}Tt.GOOGLE_SIGN_IN_METHOD="google.com",Tt.PROVIDER_ID="google.com";class Ct extends bt{constructor(){super("github.com")}static credential(e){return pt._fromParams({providerId:Ct.PROVIDER_ID,signInMethod:Ct.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ct.credentialFromTaggedObject(e)}static credentialFromError(e){return Ct.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ct.credential(t.oauthAccessToken)}catch(Ja){return null}}}Ct.GITHUB_SIGN_IN_METHOD="github.com",Ct.PROVIDER_ID="github.com";class St extends st{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return ft(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ft(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ft(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new St(n,i):null}static _create(e,t){return new St(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class kt extends wt{constructor(e){U(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return kt.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return kt.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=St.fromJSON(e);return U(t,"argument-error"),t}static samlCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{pendingToken:n,providerId:r}=t;if(!n||!r)return null;try{return St._create(r,n)}catch(i){return null}}}class xt extends bt{constructor(){super("twitter.com")}static credential(e,t){return pt._fromParams({providerId:xt.PROVIDER_ID,signInMethod:xt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xt.credentialFromTaggedObject(e)}static credentialFromError(e){return xt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return xt.credential(n,r)}catch(Ja){return null}}}async function Pt(e,t){return Z(e,"POST","/v1/accounts:signUp",$(e,t))}xt.TWITTER_SIGN_IN_METHOD="twitter.com",xt.PROVIDER_ID="twitter.com";class At{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await we._fromIdTokenResponse(e,n,r),s=Ot(n);return new At({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Ot(n);return new At({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Ot(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Dt extends r.g{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Dt.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Dt(e,t,n,r)}}function Rt(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw Dt._fromErrorAndOperation(e,n,t,r);throw n}))}function Nt(e){return new Set(e.map((e=>{let{providerId:t}=e;return t})).filter((e=>!!e)))}async function Mt(e,t){const n=(0,r.Ku)(e);await Ft(!0,n,t);const{providerUserInfo:i}=await async function(e,t){return J(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),s=Nt(i||[]);return n.providerData=n.providerData.filter((e=>s.has(e.providerId))),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Lt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await fe(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return At._forOperation(e,"link",r)}async function Ft(e,t,n){await me(t);const r=!1===e?"provider-already-linked":"no-such-provider";U(Nt(t.providerData).has(n)===e,t.auth,r)}async function Ut(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if((0,s._isFirebaseServerApp)(r.app))return Promise.reject(M(r));const i="reauthenticate";try{const s=await fe(e,Rt(r,i,t,e),n);U(s.idToken,r,"internal-error");const o=he(s.idToken);U(o,r,"internal-error");const{sub:a}=o;return U(e.uid===a,r,"user-mismatch"),At._forOperation(e,i,s)}catch(o){throw(null===o||void 0===o?void 0:o.code)==="auth/".concat("user-not-found")&&D(r,"user-mismatch"),o}}async function jt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,s._isFirebaseServerApp)(e.app))return Promise.reject(M(e));const r="signIn",i=await Rt(e,r,t),o=await At._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(o.user),o}async function Bt(e,t){return jt(qe(e),t)}async function qt(e,t){const n=(0,r.Ku)(e);return await Ft(!1,n,t.providerId),Lt(n,t)}async function Vt(e,t){return Ut((0,r.Ku)(e),t)}async function Kt(e,t){if((0,s._isFirebaseServerApp)(e.app))return Promise.reject(M(e));const n=qe(e),r=await async function(e,t){return Z(e,"POST","/v1/accounts:signInWithCustomToken",$(e,t))}(n,{token:t,returnSecureToken:!0}),i=await At._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}class zt{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Wt._fromServerResponse(e,t):"totpInfo"in t?Ht._fromServerResponse(e,t):D(e,"internal-error")}}class Wt extends zt{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Wt(t)}}class Ht extends zt{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Ht(t)}}function Gt(e,t,n){var r;U((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),U("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),U("undefined"===typeof n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(U(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(U(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Qt(e){const t=qe(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function Yt(e,t){await async function(e,t){return J(e,"POST","/v1/accounts:update",$(e,t))}((0,r.Ku)(e),{oobCode:t})}async function $t(e,t){const n=(0,r.Ku)(e),i=await ot(n,{oobCode:t}),s=i.requestType;switch(U(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":U(i.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":U(i.mfaInfo,n,"internal-error");default:U(i.email,n,"internal-error")}let o=null;return i.mfaInfo&&(o=zt._fromServerResponse(qe(n),i.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:o},operation:s}}async function Jt(e,t){const n={identifier:t,continueUri:V()?q():"http://localhost"},{signinMethods:i}=await async function(e,t){return J(e,"POST","/v1/accounts:createAuthUri",$(e,t))}((0,r.Ku)(e),n);return i||[]}async function Xt(e,t){const n=(0,r.Ku)(e),i={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&Gt(n.auth,i,t);const{email:s}=await async function(e,t){return lt(e,t)}(n.auth,i);s!==e.email&&await e.reload()}async function Zt(e,t,n){const i=(0,r.Ku)(e),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Gt(i.auth,s,n);const{email:o}=await async function(e,t){return lt(e,t)}(i.auth,s);o!==e.email&&await e.reload()}async function en(e,t){let{displayName:n,photoURL:i}=t;if(void 0===n&&void 0===i)return;const s=(0,r.Ku)(e),o={idToken:await s.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},a=await fe(s,async function(e,t){return J(e,"POST","/v1/accounts:update",t)}(s.auth,o));s.displayName=a.displayName||null,s.photoURL=a.photoUrl||null;const c=s.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));c&&(c.displayName=s.displayName,c.photoURL=s.photoURL),await s._updateTokensIfNecessary(a)}async function tn(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await fe(e,async function(e,t){return J(e,"POST","/v1/accounts:update",t)}(r,i));await e._updateTokensIfNecessary(s,!0)}class nn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.isNewUser=e,this.providerId=t,this.profile=n}}class rn extends nn{constructor(e,t,n,r){super(e,t,n),this.username=r}}class sn extends nn{constructor(e,t){super(e,"facebook.com",t)}}class on extends rn{constructor(e,t){super(e,"github.com",t,"string"===typeof(null===t||void 0===t?void 0:t.login)?null===t||void 0===t?void 0:t.login:null)}}class an extends nn{constructor(e,t){super(e,"google.com",t)}}class cn extends rn{constructor(e,t,n){super(e,"twitter.com",t,n)}}function ln(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){const r=null===(n=null===(t=he(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new nn(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new sn(s,i);case"github.com":return new on(s,i);case"google.com":return new an(s,i);case"twitter.com":return new cn(s,i,e.screenName||null);case"custom":case"anonymous":return new nn(s,null);default:return new nn(s,r,i)}}(n)}class un{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new un("enroll",e,t)}static _fromMfaPendingCredential(e){return new un("signin",e)}toJSON(){const e="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[e]:this.credential}}}static fromJSON(e){var t,n;if(null===e||void 0===e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return un._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return un._fromIdtoken(e.multiFactorSession.idToken)}return null}}class hn{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=qe(e),r=t.customData._serverResponse,i=(r.mfaInfo||[]).map((e=>zt._fromServerResponse(n,e)));U(r.mfaPendingCredential,n,"internal-error");const s=un._fromMfaPendingCredential(r.mfaPendingCredential);return new hn(s,i,(async e=>{const i=await e._process(n,s);delete r.mfaInfo,delete r.mfaPendingCredential;const o=Object.assign(Object.assign({},r),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":const e=await At._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return U(t.user,n,"internal-error"),At._forOperation(t.user,t.operationType,o);default:D(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function dn(e,t){return J(e,"POST","/v2/accounts/mfaEnrollment:start",$(e,t))}class fn{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>zt._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new fn(e)}async getSession(){return un._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,r=await this.getSession(),i=await fe(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"===typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await fe(this.user,function(e,t){return J(e,"POST","/v2/accounts/mfaEnrollment:withdraw",$(e,t))}(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter((e=>{let{uid:n}=e;return n!==t})),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(r){throw r}}}const pn=new WeakMap;const gn="__sak";class mn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(gn,"1"),this.storage.removeItem(gn),Promise.resolve(!0)):Promise.resolve(!1)}catch(Ja){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class _n extends mn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Le(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);(0,r.lT)()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}_n.type="LOCAL";const vn=_n;function yn(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp("".concat(r,"=([^;]+)"));return null!==(n=null===(t=document.cookie.match(i))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function wn(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class bn{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=wn(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return yn(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=wn(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch((()=>{}))}_addListener(e,t){if(!this._isAvailable())return;const n=wn(e);if(window.cookieStore){const e=e=>{const r=e.changed.find((e=>e.name===n));r&&t(r.value);e.deleted.find((e=>e.name===n))&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=yn(n);const i=setInterval((()=>{const e=yn(n);e!==r&&(t(e),r=e)}),1e3);this.listenerUnsubscribes.set(t,(()=>clearInterval(i)))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}bn.type="COOKIE";class En extends mn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}En.type="SESSION";const In=En;class Tn{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Tn(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Cn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Tn.receivers=[];class Sn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=Cn("",20);r.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(l),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function kn(){return window}function xn(){return"undefined"!==typeof kn().WorkerGlobalScope&&"function"===typeof kn().importScripts}const Pn="firebaseLocalStorageDb",An="firebaseLocalStorage",On="fbase_key";class Dn{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Rn(e,t){return e.transaction([An],t?"readwrite":"readonly").objectStore(An)}function Nn(){const e=indexedDB.open(Pn,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(An,{keyPath:On})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(An)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Pn);return new Dn(e).toPromise()}(),t(await Nn()))}))}))}async function Mn(e,t,n){const r=Rn(e,!0).put({[On]:t,value:n});return new Dn(r).toPromise()}function Ln(e,t){const n=Rn(e,!0).delete(t);return new Dn(n).toPromise()}class Fn{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Nn()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xn()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tn._getInstance(xn()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Sn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(Ja){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Nn();return await Mn(e,gn,"1"),await Ln(e,gn),!0}catch(Ja){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Mn(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Rn(e,!1).get(t),r=await new Dn(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Ln(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Rn(e,!1).getAll();return new Dn(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Fn.type="LOCAL";const Un=Fn;function jn(e,t){return J(e,"POST","/v2/accounts/mfaSignIn:start",$(e,t))}const Bn=We("rcb"),qn=new z(3e4,6e4);class Vn{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=kn().grecaptcha)||void 0===e?void 0:e.render)}load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return U(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&ie(kn().grecaptcha)?Promise.resolve(kn().grecaptcha):new Promise(((n,i)=>{const s=kn().setTimeout((()=>{i(R(e,"network-request-failed"))}),qn.get());kn()[Bn]=()=>{kn().clearTimeout(s),delete kn()[Bn];const r=kn().grecaptcha;if(!r||!ie(r))return void i(R(e,"internal-error"));const o=r.render;r.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(r)};ze("".concat(Ke.recaptchaV2Script,"?").concat((0,r.Am)({onload:Bn,render:"explicit",hl:t}))).catch((()=>{clearTimeout(s),i(R(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=kn().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Kn{async load(e){return new Ge(e)}clearedOneInstance(){}}const zn="recaptcha",Wn={theme:"light",type:"image"};class Hn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.assign({},Wn);this.parameters=n,this.type=zn,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=qe(e),this.isInvisible="invisible"===this.parameters.size,U("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"===typeof t?document.getElementById(t):t;U(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Kn:new Vn,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){U(!this.parameters.sitekey,this.auth,"argument-error"),U(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),U("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"===typeof e)e(t);else if("string"===typeof e){const n=kn()[e];"function"===typeof n&&n(t)}}}assertNotDestroyed(){U(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){U(V()&&!xn(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await J(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);U(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return U(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Gn{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=_t._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Qn(e,t,n){var r;if(!e._getRecaptchaConfig())try{await tt(e)}catch(i){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"===typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){U("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=et(e,r,"mfaSmsEnrollment",(async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Je){U((null===n||void 0===n?void 0:n.type)===zn,e,"argument-error");return dn(e,await Yn(e,t,n))}return dn(e,t)}),"PHONE_PROVIDER");return(await s.catch((e=>Promise.reject(e)))).phoneSessionInfo.sessionInfo}{U("signin"===t.type,e,"internal-error");const s=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;U(s,e,"missing-multi-factor-info");const o={mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=et(e,o,"mfaSmsSignIn",(async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Je){U((null===n||void 0===n?void 0:n.type)===zn,e,"argument-error");return jn(e,await Yn(e,t,n))}return jn(e,t)}),"PHONE_PROVIDER");return(await a.catch((e=>Promise.reject(e)))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=et(e,t,"sendVerificationCode",(async(e,t)=>{if(t.captchaResponse===Je){U((null===n||void 0===n?void 0:n.type)===zn,e,"argument-error");return gt(e,await Yn(e,t,n))}return gt(e,t)}),"PHONE_PROVIDER");return(await r.catch((e=>Promise.reject(e)))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Yn(e,t,n){U(n.type===zn,e,"argument-error");const r=await n.verify();U("string"===typeof r,e,"argument-error");const i=Object.assign({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class $n{constructor(e){this.providerId=$n.PROVIDER_ID,this.auth=qe(e)}verifyPhoneNumber(e,t){return Qn(this.auth,e,(0,r.Ku)(t))}static credential(e,t){return _t._fromVerification(e,t)}static credentialFromResult(e){const t=e;return $n.credentialFromTaggedObject(t)}static credentialFromError(e){return $n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?_t._fromTokenResponse(n,r):null}}function Jn(e,t){return t?Ee(t):(U(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}$n.PROVIDER_ID="phone",$n.PHONE_SIGN_IN_METHOD="phone";class Xn extends st{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ft(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ft(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ft(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Zn(e){return jt(e.auth,new Xn(e),e.bypassAuthState)}function er(e){const{auth:t,user:n}=e;return U(n,t,"internal-error"),Ut(n,new Xn(e),e.bypassAuthState)}async function tr(e){const{auth:t,user:n}=e;return U(n,t,"internal-error"),Lt(n,new Xn(e),e.bypassAuthState)}class nr{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Zn;case"linkViaPopup":case"linkViaRedirect":return tr;case"reauthViaPopup":case"reauthViaRedirect":return er;default:D(this.auth,"internal-error")}}resolve(e){B(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){B(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const rr=new z(2e3,1e4);class ir extends nr{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,ir.currentPopupAction&&ir.currentPopupAction.cancel(),ir.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return U(e,this.auth,"internal-error"),e}async onExecution(){B(1===this.filter.length,"Popup operations only handle one event");const e=Cn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(R(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(R(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ir.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(R(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,rr.get())};e()}}ir.currentPopupAction=null;const sr=new Map;class or extends nr{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=sr.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=ur(t),r=lr(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}sr.set(this.auth._key(),e)}return this.bypassAuthState||sr.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function ar(e,t){return lr(e)._set(ur(t),"true")}function cr(e,t){sr.set(e._key(),t)}function lr(e){return Ee(e._redirectPersistence)}function ur(e){return Ce("pendingRedirect",e.config.apiKey,e.name)}function hr(e,t,n){return async function(e,t,n){if((0,s._isFirebaseServerApp)(e.app))return Promise.reject(M(e));const r=qe(e);L(e,t,wt),await r._initializationPromise;const i=Jn(r,n);return await ar(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function dr(e,t,n){return async function(e,t,n){const i=(0,r.Ku)(e);if(L(i.auth,t,wt),(0,s._isFirebaseServerApp)(i.auth.app))return Promise.reject(M(i.auth));await i.auth._initializationPromise;const o=Jn(i.auth,n);await ar(o,i.auth);const a=await gr(i);return o._openRedirect(i.auth,t,"reauthViaRedirect",a)}(e,t,n)}function fr(e,t,n){return async function(e,t,n){const i=(0,r.Ku)(e);L(i.auth,t,wt),await i.auth._initializationPromise;const s=Jn(i.auth,n);await Ft(!1,i,t.providerId),await ar(s,i.auth);const o=await gr(i);return s._openRedirect(i.auth,t,"linkViaRedirect",o)}(e,t,n)}async function pr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,s._isFirebaseServerApp)(e.app))return Promise.reject(M(e));const r=qe(e),i=Jn(r,t),o=new or(r,i,n),a=await o.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}async function gr(e){const t=Cn("".concat(e.uid,":::"));return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class mr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!vr(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(R(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(_r(e))}saveEventToCache(e){this.cachedEventUids.add(_r(e)),this.lastProcessedEventTime=Date.now()}}function _r(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function vr(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}async function yr(e){return J(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}const wr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,br=/^https?/;function Er(e){const t=q(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!br.test(n))return!1;if(wr.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Ir=new z(3e4,6e4);function Tr(){const e=kn().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Cr(e){return new Promise(((t,n)=>{var r,i,s;function o(){Tr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Tr(),n(R(e,"network-request-failed"))},timeout:Ir.get()})}if(null===(i=null===(r=kn().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=kn().gapi)||void 0===s?void 0:s.load)){const t=We("iframefcb");return kn()[t]=()=>{gapi.load?o():n(R(e,"network-request-failed"))},ze("".concat(Ke.gapiScript,"?onload=").concat(t)).catch((e=>n(e)))}o()}})).catch((e=>{throw Sr=null,e}))}let Sr=null;const kr=new z(5e3,15e3),xr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Pr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ar(e){const t=e.config;U(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?W(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),i={apiKey:t.apiKey,appName:e.name,v:s.SDK_VERSION},o=Pr.get(e.config.apiHost);o&&(i.eid=o);const a=e._getFrameworks();return a.length&&(i.fw=a.join(",")),"".concat(n,"?").concat((0,r.Am)(i).slice(1))}async function Or(e){const t=await function(e){return Sr=Sr||Cr(e),Sr}(e),n=kn().gapi;return U(n,e,"internal-error"),t.open({where:document.body,url:Ar(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xr,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=R(e,"network-request-failed"),s=kn().setTimeout((()=>{r(i)}),kr.get());function o(){kn().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}const Dr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Rr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Nr(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const l=Object.assign(Object.assign({},Dr),{width:i.toString(),height:s.toString(),top:o,left:a}),u=(0,r.ZQ)().toLowerCase();n&&(c=Ae(u)?"_blank":n),xe(u)&&(t=t||"http://localhost",l.scrollbars="yes");const h=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")}),"");if(function(){var e;return Me(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Rr(null);const d=window.open(t||"",c,h);U(d,e,"popup-blocked");try{d.focus()}catch(f){}return new Rr(d)}const Mr="__/auth/handler",Lr="emulator/auth/handler",Fr=encodeURIComponent("fac");async function Ur(e,t,n,i,o,a){U(e.config.authDomain,e,"auth-domain-config-required"),U(e.config.apiKey,e,"invalid-api-key");const c={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:s.SDK_VERSION,eventId:o};if(t instanceof wt){t.setDefaultLanguage(e.languageCode),c.providerId=t.providerId||"",(0,r.Im)(t.getCustomParameters())||(c.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(t instanceof bt){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(c.scopes=e.join(","))}e.tenantId&&(c.tid=e.tenantId);const l=c;for(const r of Object.keys(l))void 0===l[r]&&delete l[r];const u=await e._getAppCheckToken(),h=u?"#".concat(Fr,"=").concat(encodeURIComponent(u)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Mr);return W(t,Lr)}(e),"?").concat((0,r.Am)(l).slice(1)).concat(h)}const jr="webStorageSupport";const Br=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=In,this._completeRedirectFn=pr,this._overrideRedirectResult=cr}async _openPopup(e,t,n,r){var i;B(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Nr(e,await Ur(e,t,n,q(),r),Cn())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){kn().location.href=e}(await Ur(e,t,n,q(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(B(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Or(e),n=new mr(e);return t.register("authEvent",(t=>{U(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(jr,{type:jr},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[jr];void 0!==i&&t(!!i),D(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await yr(e);for(const n of t)try{if(Er(n))return}catch(Ja){}D(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Le()||Pe()||Me()}};class qr{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return j("unexpected MultiFactorSessionType")}}}class Vr extends qr{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Vr(e)}_finalizeEnroll(e,t,n){return function(e,t){return J(e,"POST","/v2/accounts/mfaEnrollment:finalize",$(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return J(e,"POST","/v2/accounts/mfaSignIn:finalize",$(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Kr{constructor(){}static assertion(e){return Vr._fromCredential(e)}}Kr.FACTOR_ID="phone";var zr="@firebase/auth",Wr="1.10.7";class Hr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,r.XA)("authIdTokenMaxAge");var Gr;function Qr(){return window}Ke={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=R("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Gr="Browser",(0,s._registerComponent)(new i.uA("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;U(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:Gr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Fe(Gr)},l=new Be(r,i,s,c);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ee);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(l,n),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),(0,s._registerComponent)(new i.uA("auth-internal",(e=>(e=>new Hr(e))(qe(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,s.registerVersion)(zr,Wr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Gr)),(0,s.registerVersion)(zr,Wr,"esm2017");async function Yr(e,t,n){var r;const{BuildInfo:i}=Qr();B(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(B(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),o={};return Me()?o.ibi=i.packageName:De()?o.apn=i.packageName:D(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Ur(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}function $r(e){const{cordova:t}=Qr();return new Promise((n=>{t.plugins.browsertab.isAvailable((i=>{let s=null;i?t.plugins.browsertab.openUrl(e):s=t.InAppBrowser.open(e,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(s)}))}))}class Jr extends mr{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInitialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function Xr(e){const t=await ti()._get(ni(e));return t&&await ti()._remove(ni(e)),t}function Zr(e,t){var n,r;const i=function(e){const t=ri(e),n=t.link?decodeURIComponent(t.link):void 0,r=ri(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return ri(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=ri(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null===s||void 0===s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?R(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function ei(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(62*Math.random());e.push(t.charAt(n))}return e.join("")}function ti(){return Ee(vn)}function ni(e){return Ce("authEvent",e.config.apiKey,e.name)}function ri(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return(0,r.I9)(n.join("?"))}const ii=class{constructor(){this._redirectPersistence=In,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=pr,this._overrideRedirectResult=cr}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new Jr(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){D(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,c,l,u;const h=Qr();U("function"===typeof(null===(t=null===h||void 0===h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),U("undefined"!==typeof(null===(n=null===h||void 0===h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),U("function"===typeof(null===(s=null===(i=null===(r=null===h||void 0===h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U("function"===typeof(null===(c=null===(a=null===(o=null===h||void 0===h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===c?void 0:c.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U("function"===typeof(null===(u=null===(l=null===h||void 0===h?void 0:h.cordova)||void 0===l?void 0:l.InAppBrowser)||void 0===u?void 0:u.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),sr.clear(),await this._originValidation(e);const s=function(e,t){return{type:t,eventId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,urlResponse:null,sessionId:ei(),postBody:null,tenantId:e.tenantId,error:R(e,"no-auth-event")}}(e,n,r);await function(e,t){return ti()._set(ni(e),t)}(e,s);const o=await Yr(e,s,t);return async function(e,t,n){const{cordova:r}=Qr();let i=()=>{};try{await new Promise(((s,o)=>{let a=null;function c(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"===typeof t&&t(),"function"===typeof(null===n||void 0===n?void 0:n.close)&&n.close()}function l(){a||(a=window.setTimeout((()=>{o(R(e,"redirect-cancelled-by-user"))}),2e3))}function u(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&l()}t.addPassiveListener(c),document.addEventListener("resume",l,!1),De()&&document.addEventListener("visibilitychange",u,!1),i=()=>{t.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}}))}finally{i()}}(e,i,await $r(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=Qr(),n={};Me()?n.iosBundleId=t.packageName:De()?n.androidPackageName=t.packageName:D(e,"operation-not-supported-in-this-environment"),await yr(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=Qr(),s=setTimeout((async()=>{await Xr(e),t.onEvent(si())}),500),o=async n=>{clearTimeout(s);const r=await Xr(e);let i=null;r&&(null===n||void 0===n?void 0:n.url)&&(i=Zr(r,n.url)),t.onEvent(i||si())};"undefined"!==typeof n&&"function"===typeof n.subscribe&&n.subscribe(null,o);const a=r,c="".concat(i.packageName.toLowerCase(),"://");Qr().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(c)&&o({url:e}),"function"===typeof a)try{a(e)}catch(t){console.error(t)}}}};function si(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:R("no-auth-event")}}function oi(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function ai(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return!("file:"!==oi()&&"ionic:"!==oi()&&"capacitor:"!==oi()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function ci(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return(0,r.lT)()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/Edge\/\d+/.test(e)}(e)}function li(){try{const e=self.localStorage,t=Cn();if(e)return e.setItem(t,"1"),e.removeItem(t),!ci()||(0,r.zW)()}catch(e){return ui()&&(0,r.zW)()}return!1}function ui(){return"undefined"!==typeof n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function hi(){return("http:"===oi()||"https:"===oi()||(0,r.sr)()||ai())&&!((0,r.lV)()||(0,r.Ll)())&&li()&&!ui()}function di(){return ai()&&"undefined"!==typeof document}const fi={LOCAL:"local",NONE:"none",SESSION:"session"},pi=U,gi="persistence";async function mi(e){await e._initializationPromise;const t=_i(),n=Ce(gi,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistenceType())}function _i(){var e;try{return(null===(e="undefined"!==typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(t){return null}}const vi=U;class yi{constructor(){this.browserResolver=Ee(Br),this.cordovaResolver=Ee(ii),this.underlyingResolver=null,this._redirectPersistence=In,this._completeRedirectFn=pr,this._overrideRedirectResult=cr}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return di()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return vi(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!di()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function wi(e){return e.unwrap()}function bi(e,t){var n;const i=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===t||void 0===t?void 0:t.code)){t.resolver=new Ci(e,function(e,t){var n;const i=(0,r.Ku)(e),s=t;return U(t.customData.operationType,i,"argument-error"),U(null===(n=s.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,i,"argument-error"),hn._fromError(i,s)}(e,t))}else if(i){const e=Ei(t),n=t;e&&(n.credential=e,n.tenantId=i.tenantId||void 0,n.email=i.email||void 0,n.phoneNumber=i.phoneNumber||void 0)}}function Ei(e){const{_tokenResponse:t}=e instanceof r.g?e.customData:e;if(!t)return null;if(!(e instanceof r.g)&&"temporaryProof"in t&&"phoneNumber"in t)return $n.credentialFromResult(e);const n=t.providerId;if(!n||n===v)return null;let i;switch(n){case _:i=Tt;break;case g:i=It;break;case m:i=Ct;break;case y:i=xt;break;default:const{oauthIdToken:e,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:o,nonce:a}=t;return r||s||e||o?o?n.startsWith("saml.")?St._create(n,o):pt._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:e,accessToken:r}):new Et(n).credential({idToken:e,accessToken:r,rawNonce:a}):null}return e instanceof r.g?i.credentialFromError(e):i.credentialFromResult(e)}function Ii(e,t){return t.catch((t=>{throw t instanceof r.g&&bi(e,t),t})).then((e=>{const t=e.operationType,n=e.user;return{operationType:t,credential:(r=e,Ei(r)),additionalUserInfo:ln(e),user:Si.getOrCreate(n)};var r}))}async function Ti(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>Ii(e,n.confirm(t))}}class Ci{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Ii(wi(this.auth),this.resolver.resolveSignIn(e))}}class Si{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=(0,r.Ku)(e);return pn.has(t)||pn.set(t,fn._fromUser(t)),pn.get(t)}(e)}static getOrCreate(e){return Si.USER_MAP.has(e)||Si.USER_MAP.set(e,new Si(e)),Si.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Ii(this.auth,qt(this._delegate,e))}async linkWithPhoneNumber(e,t){return Ti(this.auth,async function(e,t,n){const i=(0,r.Ku)(e);await Ft(!1,i,"phone");const s=await Qn(i.auth,t,(0,r.Ku)(n));return new Gn(s,(e=>qt(i,e)))}(this._delegate,e,t))}async linkWithPopup(e){return Ii(this.auth,async function(e,t,n){const i=(0,r.Ku)(e);L(i.auth,t,wt);const s=Jn(i.auth,n);return new ir(i.auth,"linkViaPopup",t,s,i).executeNotNull()}(this._delegate,e,yi))}async linkWithRedirect(e){return await mi(qe(this.auth)),fr(this._delegate,e,yi)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Ii(this.auth,Vt(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Ti(this.auth,async function(e,t,n){const i=(0,r.Ku)(e);if((0,s._isFirebaseServerApp)(i.auth.app))return Promise.reject(M(i.auth));const o=await Qn(i.auth,t,(0,r.Ku)(n));return new Gn(o,(e=>Vt(i,e)))}(this._delegate,e,t))}reauthenticateWithPopup(e){return Ii(this.auth,async function(e,t,n){const i=(0,r.Ku)(e);if((0,s._isFirebaseServerApp)(i.auth.app))return Promise.reject(R(i.auth,"operation-not-supported-in-this-environment"));L(i.auth,t,wt);const o=Jn(i.auth,n);return new ir(i.auth,"reauthViaPopup",t,o,i).executeNotNull()}(this._delegate,e,yi))}async reauthenticateWithRedirect(e){return await mi(qe(this.auth)),dr(this._delegate,e,yi)}sendEmailVerification(e){return Xt(this._delegate,e)}async unlink(e){return await Mt(this._delegate,e),this}updateEmail(e){return function(e,t){const n=(0,r.Ku)(e);return(0,s._isFirebaseServerApp)(n.auth.app)?Promise.reject(M(n.auth)):tn(n,t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return tn((0,r.Ku)(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){const n=(0,r.Ku)(e);if((0,s._isFirebaseServerApp)(n.auth.app))return Promise.reject(M(n.auth));await Lt(n,t)}(this._delegate,e)}updateProfile(e){return en(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Zt(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Si.USER_MAP=new WeakMap;const ki=U;class xi{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;ki(n,"invalid-api-key",{appName:e.name}),ki(n,"invalid-api-key",{appName:e.name});const r="undefined"!==typeof window?yi:void 0;this._delegate=t.initialize({options:{persistence:Ai(n,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(k),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Si.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){nt(this._delegate,e,t)}applyActionCode(e){return Yt(this._delegate,e)}checkActionCode(e){return $t(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await ot((0,r.Ku)(e),{oobCode:t,newPassword:n}).catch((async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Qt(e),t}))}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Ii(this._delegate,async function(e,t,n){if((0,s._isFirebaseServerApp)(e.app))return Promise.reject(M(e));const r=qe(e),i=et(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Pt,"EMAIL_PASSWORD_PROVIDER"),o=await i.catch((t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Qt(e),t})),a=await At._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Jt(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=vt.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){ki(hi(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await qe(e)._initializationPromise,pr(e,t,!1)}(this._delegate,yi);return e?Ii(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){qe(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=Pi(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=Pi(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return async function(e,t,n){const r=qe(e),i={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};!function(e,t){U(t.handleCodeInApp,r,"argument-error"),t&&Gt(r,e,t)}(i,n),await et(r,i,"getOobCode",ht,"EMAIL_PASSWORD_PROVIDER")}(this._delegate,e,t)}sendPasswordResetEmail(e,t){return async function(e,t,n){const r=qe(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&Gt(r,i,n),await et(r,i,"getOobCode",ut,"EMAIL_PASSWORD_PROVIDER")}(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){pi(Object.values(fi).includes(t),e,"invalid-persistence-type"),(0,r.lV)()?pi(t!==fi.SESSION,e,"unsupported-persistence-type"):(0,r.Ll)()?pi(t===fi.NONE,e,"unsupported-persistence-type"):ui()?pi(t===fi.NONE||t===fi.LOCAL&&(0,r.zW)(),e,"unsupported-persistence-type"):pi(t===fi.NONE||li(),e,"unsupported-persistence-type")}(this._delegate,e),e){case fi.SESSION:t=In;break;case fi.LOCAL:t=await Ee(Un)._isAvailable()?Un:vn;break;case fi.NONE:t=Te;break;default:return D("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Ii(this._delegate,async function(e){var t;if((0,s._isFirebaseServerApp)(e.app))return Promise.reject(M(e));const n=qe(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new At({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Pt(n,{returnSecureToken:!0}),i=await At._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(this._delegate))}signInWithCredential(e){return Ii(this._delegate,Bt(this._delegate,e))}signInWithCustomToken(e){return Ii(this._delegate,Kt(this._delegate,e))}signInWithEmailAndPassword(e,t){return Ii(this._delegate,function(e,t,n){return(0,s._isFirebaseServerApp)(e.app)?Promise.reject(M(e)):Bt((0,r.Ku)(e),yt.credential(t,n)).catch((async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Qt(e),t}))}(this._delegate,e,t))}signInWithEmailLink(e,t){return Ii(this._delegate,async function(e,t,n){if((0,s._isFirebaseServerApp)(e.app))return Promise.reject(M(e));const i=(0,r.Ku)(e),o=yt.credentialWithLink(t,n||q());return U(o._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),Bt(i,o)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Ti(this._delegate,async function(e,t,n){if((0,s._isFirebaseServerApp)(e.app))return Promise.reject(M(e));const i=qe(e),o=await Qn(i,t,(0,r.Ku)(n));return new Gn(o,(e=>Bt(i,e)))}(this._delegate,e,t))}async signInWithPopup(e){return ki(hi(),this._delegate,"operation-not-supported-in-this-environment"),Ii(this._delegate,async function(e,t,n){if((0,s._isFirebaseServerApp)(e.app))return Promise.reject(R(e,"operation-not-supported-in-this-environment"));const r=qe(e);L(e,t,wt);const i=Jn(r,n);return new ir(r,"signInViaPopup",t,i).executeNotNull()}(this._delegate,e,yi))}async signInWithRedirect(e){return ki(hi(),this._delegate,"operation-not-supported-in-this-environment"),await mi(this._delegate),hr(this._delegate,e,yi)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await $t((0,r.Ku)(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function Pi(e,t,n){let r=e;"function"!==typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&Si.getOrCreate(e)),error:t,complete:n}}function Ai(e,t){const n=function(e,t){const n=_i();if(!n)return[];const r=Ce(gi,e,t);switch(n.getItem(r)){case fi.NONE:return[Te];case fi.LOCAL:return[Un,In];case fi.SESSION:return[In];default:return[]}}(e,t);if("undefined"===typeof self||n.includes(Un)||n.push(Un),"undefined"!==typeof window)for(const r of[vn,In])n.includes(r)||n.push(r);return n.includes(Te)||n.push(Te),n}xi.Persistence=fi;class Oi{static credential(e,t){return $n.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new $n(wi(d.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Oi.PHONE_SIGN_IN_METHOD=$n.PHONE_SIGN_IN_METHOD,Oi.PROVIDER_ID=$n.PROVIDER_ID;const Di=U;class Ri{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.app();var r;Di(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new Hn(n.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}var Ni;(Ni=d).INTERNAL.registerComponent(new i.uA("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new xi(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:w,PASSWORD_RESET:b,RECOVER_EMAIL:E,REVERT_SECOND_FACTOR_ADDITION:I,VERIFY_AND_CHANGE_EMAIL:T,VERIFY_EMAIL:C}},EmailAuthProvider:yt,FacebookAuthProvider:It,GithubAuthProvider:Ct,GoogleAuthProvider:Tt,OAuthProvider:Et,SAMLAuthProvider:kt,PhoneAuthProvider:Oi,PhoneMultiFactorGenerator:Kr,RecaptchaVerifier:Ri,TwitterAuthProvider:xt,Auth:xi,AuthCredential:st,Error:r.g}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Ni.registerVersion("@firebase/auth-compat","0.5.27");var Mi=n(814);function Li(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Mi.W6("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}function Fi(){if("undefined"===typeof Uint8Array)throw new Mi.W6("unimplemented","Uint8Arrays are not available in this environment.")}function Ui(){if(!(0,Mi.qG)())throw new Mi.W6("unimplemented","Blobs are unavailable in Firestore in this environment.")}class ji{constructor(e){this._delegate=e}static fromBase64String(e){return Ui(),new ji(Mi.Ix.fromBase64String(e))}static fromUint8Array(e){return Fi(),new ji(Mi.Ix.fromUint8Array(e))}toBase64(){return Ui(),this._delegate.toBase64()}toUint8Array(){return Fi(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Bi(e){return function(e,t){if("object"!==typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"===typeof n[r])return!0;return!1}(e,["next","error","complete"])}class qi{enableIndexedDbPersistence(e,t){return(0,Mi.ol)(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return(0,Mi.Q5)(e._delegate)}clearIndexedDbPersistence(e){return(0,Mi.me)(e._delegate)}}class Vi{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof Mi.cm||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||(0,Mi.qi)("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,Mi.vN)(this._delegate,e,t,n)}enableNetwork(){return(0,Mi.Os)(this._delegate)}disableNetwork(){return(0,Mi.LA)(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,(0,Mi.c8)("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return(0,Mi.iB)(this._delegate)}onSnapshotsInSync(e){return(0,Mi.FC)(this._delegate,e)}get app(){if(!this._appCompat)throw new Mi.W6("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ns(this,(0,Mi.rJ)(this._delegate,e))}catch(t){throw Qi(t,"collection()","Firestore.collection()")}}doc(e){try{return new Gi(this,(0,Mi.H9)(this._delegate,e))}catch(t){throw Qi(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Zi(this,(0,Mi.Cs)(this._delegate,e))}catch(t){throw Qi(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return(0,Mi.c4)(this._delegate,(t=>e(new zi(this,t))))}batch(){return(0,Mi.Ws)(this._delegate),new Wi(new Mi.GA(this._delegate,(e=>(0,Mi.z6)(this._delegate,e))))}loadBundle(e){return(0,Mi.po)(this._delegate,e)}namedQuery(e){return(0,Mi.St)(this._delegate,e).then((e=>e?new Zi(this,e):null))}}class Ki extends Mi.fS{constructor(e){super(),this.firestore=e}convertBytes(e){return new ji(new Mi.Ix(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Gi.forKey(t,this.firestore,null)}}class zi{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ki(e)}get(e){const t=rs(e);return this._delegate.get(t).then((e=>new Ji(this._firestore,new Mi.Wq(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=rs(e);return n?(Li("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),s=3;s<r;s++)i[s-3]=arguments[s];const o=rs(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){const t=rs(e);return this._delegate.delete(t),this}}class Wi{constructor(e){this._delegate=e}set(e,t,n){const r=rs(e);return n?(Li("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),s=3;s<r;s++)i[s-3]=arguments[s];const o=rs(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){const t=rs(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Hi{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new Mi.YQ(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Xi(this._firestore,n),null!==t&&void 0!==t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=Hi.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new Hi(e,new Ki(e),t),r.set(t,i)),i}}Hi.INSTANCES=new WeakMap;class Gi{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ki(e)}static forPath(e,t,n){if(e.length%2!==0)throw new Mi.W6("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(e.canonicalString()," has ").concat(e.length));return new Gi(t,new Mi.T1(t._delegate,n,new Mi.K$(e)))}static forKey(e,t,n){return new Gi(t,new Mi.T1(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new ns(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ns(this.firestore,(0,Mi.rJ)(this._delegate,e))}catch(t){throw Qi(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,r.Ku)(e))instanceof Mi.T1&&(0,Mi.yx)(this._delegate,e)}set(e,t){t=Li("DocumentReference.set",t);try{return t?(0,Mi.BN)(this._delegate,e,t):(0,Mi.BN)(this._delegate,e)}catch(n){throw Qi(n,"setDoc()","DocumentReference.set()")}}update(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?(0,Mi.mZ)(this._delegate,e):(0,Mi.mZ)(this._delegate,e,t,...r)}catch(s){throw Qi(s,"updateDoc()","DocumentReference.update()")}}delete(){return(0,Mi.kd)(this._delegate)}onSnapshot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Yi(t),i=$i(t,(e=>new Ji(this.firestore,new Mi.Wq(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return(0,Mi.aQ)(this._delegate,r,i)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?(0,Mi.nY)(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?(0,Mi._e)(this._delegate):(0,Mi.x7)(this._delegate),t.then((e=>new Ji(this.firestore,new Mi.Wq(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new Gi(this.firestore,e?this._delegate.withConverter(Hi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Qi(e,t,n){return e.message=e.message.replace(t,n),e}function Yi(e){for(const t of e)if("object"===typeof t&&!Bi(t))return t;return{}}function $i(e,t){var n,r;let i;return i=Bi(e[0])?e[0]:Bi(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Ji{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Gi(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return(0,Mi.lN)(this._delegate,e._delegate)}}class Xi extends Ji{data(e){const t=this._delegate.data(e);return this._delegate._converter||(0,Mi.bI)(void 0!==t,"Document in a QueryDocumentSnapshot should exist"),t}}class Zi{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ki(e)}where(e,t,n){try{return new Zi(this.firestore,(0,Mi.P)(this._delegate,(0,Mi._M)(e,t,n)))}catch(r){throw Qi(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Zi(this.firestore,(0,Mi.P)(this._delegate,(0,Mi.My)(e,t)))}catch(n){throw Qi(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Zi(this.firestore,(0,Mi.P)(this._delegate,(0,Mi.AB)(e)))}catch(t){throw Qi(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Zi(this.firestore,(0,Mi.P)(this._delegate,(0,Mi.$1)(e)))}catch(t){throw Qi(t,"limitToLast()","Query.limitToLast()")}}startAt(){try{return new Zi(this.firestore,(0,Mi.P)(this._delegate,(0,Mi.EO)(...arguments)))}catch(e){throw Qi(e,"startAt()","Query.startAt()")}}startAfter(){try{return new Zi(this.firestore,(0,Mi.P)(this._delegate,(0,Mi.HM)(...arguments)))}catch(e){throw Qi(e,"startAfter()","Query.startAfter()")}}endBefore(){try{return new Zi(this.firestore,(0,Mi.P)(this._delegate,(0,Mi.rf)(...arguments)))}catch(e){throw Qi(e,"endBefore()","Query.endBefore()")}}endAt(){try{return new Zi(this.firestore,(0,Mi.P)(this._delegate,(0,Mi.FD)(...arguments)))}catch(e){throw Qi(e,"endAt()","Query.endAt()")}}isEqual(e){return(0,Mi.B)(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?(0,Mi.kU)(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?(0,Mi.Rr)(this._delegate):(0,Mi.GG)(this._delegate),t.then((e=>new ts(this.firestore,new Mi.NJ(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Yi(t),i=$i(t,(e=>new ts(this.firestore,new Mi.NJ(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return(0,Mi.aQ)(this._delegate,r,i)}withConverter(e){return new Zi(this.firestore,e?this._delegate.withConverter(Hi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class es{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Xi(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class ts{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Zi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new Xi(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new es(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new Xi(this._firestore,n))}))}isEqual(e){return(0,Mi.lN)(this._delegate,e._delegate)}}class ns extends Zi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Gi(this.firestore,e):null}doc(e){try{return new Gi(this.firestore,void 0===e?(0,Mi.H9)(this._delegate):(0,Mi.H9)(this._delegate,e))}catch(t){throw Qi(t,"doc()","CollectionReference.doc()")}}add(e){return(0,Mi.gS)(this._delegate,e).then((e=>new Gi(this.firestore,e)))}isEqual(e){return(0,Mi.yx)(this._delegate,e._delegate)}withConverter(e){return new ns(this.firestore,e?this._delegate.withConverter(Hi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function rs(e){return(0,Mi.lo)(e,Mi.T1)}class is{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._delegate=new Mi.uY(...t)}static documentId(){return new is(Mi.FA.keyField().canonicalString())}isEqual(e){return(e=(0,r.Ku)(e))instanceof Mi.uY&&this._delegate._internalPath.isEqual(e._internalPath)}}class ss{static serverTimestamp(){const e=(0,Mi.O5)();return e._methodName="FieldValue.serverTimestamp",new ss(e)}static delete(){const e=(0,Mi.CL)();return e._methodName="FieldValue.delete",new ss(e)}static arrayUnion(){const e=(0,Mi.hq)(...arguments);return e._methodName="FieldValue.arrayUnion",new ss(e)}static arrayRemove(){const e=(0,Mi.C3)(...arguments);return e._methodName="FieldValue.arrayRemove",new ss(e)}static increment(e){const t=(0,Mi.GV)(e);return t._methodName="FieldValue.increment",new ss(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}const os={Firestore:Vi,GeoPoint:Mi.Ci,Timestamp:Mi.Dc,Blob:ji,Transaction:zi,WriteBatch:Wi,DocumentReference:Gi,DocumentSnapshot:Ji,Query:Zi,QueryDocumentSnapshot:Xi,QuerySnapshot:ts,CollectionReference:ns,FieldPath:is,FieldValue:ss,setLogLevel:function(e){(0,Mi.He)(e)},CACHE_SIZE_UNLIMITED:Mi.H6};!function(e){!function(e,t){e.INTERNAL.registerComponent(new i.uA("firestore-compat",(e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},os)))}(e,((e,t)=>new Vi(e,t,new qi))),e.registerVersion("@firebase/firestore-compat","0.3.52")}(d);var as=n(255);const cs=new o.Vy("@firebase/database-compat"),ls=function(e){const t="FIREBASE WARNING: "+e;cs.warn(t)};class us{constructor(e){this._delegate=e}cancel(e){(0,r.od)("OnDisconnect.cancel",0,1,arguments.length),(0,r.oD)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then((()=>e(null)),(t=>e(t))),t}remove(e){(0,r.od)("OnDisconnect.remove",0,1,arguments.length),(0,r.oD)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then((()=>e(null)),(t=>e(t))),t}set(e,t){(0,r.od)("OnDisconnect.set",1,2,arguments.length),(0,r.oD)("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){(0,r.od)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,r.oD)("OnDisconnect.setWithPriority","onComplete",n,!0);const i=this._delegate.setWithPriority(e,t);return n&&i.then((()=>n(null)),(e=>n(e))),i}update(e,t){if((0,r.od)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,ls("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,r.oD)("OnDisconnect.update","onComplete",t,!0);const n=this._delegate.update(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}}class hs{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,r.od)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class ds{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,r.od)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,r.od)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,r.od)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,r.od)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,r.od)("DataSnapshot.child",0,1,arguments.length),e=String(e),(0,as.Kd)("DataSnapshot.child","path",e,!1),new ds(this._database,this._delegate.child(e))}hasChild(e){return(0,r.od)("DataSnapshot.hasChild",1,1,arguments.length),(0,as.Kd)("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,r.od)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,r.od)("DataSnapshot.forEach",1,1,arguments.length),(0,r.oD)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((t=>e(new ds(this._database,t))))}hasChildren(){return(0,r.od)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,r.od)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,r.od)("DataSnapshot.ref",0,0,arguments.length),new ps(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class fs{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,i){var s;(0,r.od)("Query.on",2,4,arguments.length),(0,r.oD)("Query.on","callback",t,!1);const o=fs.getCancelAndContextArgs_("Query.on",n,i),a=(e,n)=>{t.call(o.context,new ds(this.database,e),n)};a.userCallback=t,a.context=o.context;const c=null===(s=o.cancel)||void 0===s?void 0:s.bind(o.context);switch(e){case"value":return(0,as.Zy)(this._delegate,a,c),t;case"child_added":return(0,as._O)(this._delegate,a,c),t;case"child_removed":return(0,as.U0)(this._delegate,a,c),t;case"child_changed":return(0,as.M4)(this._delegate,a,c),t;case"child_moved":return(0,as.X1)(this._delegate,a,c),t;default:throw new Error((0,r.dI)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if((0,r.od)("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,r.dI)(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),(0,r.oD)("Query.off","callback",t,!0),(0,r.HN)("Query.off","context",n,!0),t){const r=()=>{};r.userCallback=t,r.context=n,(0,as.AU)(this._delegate,e,r)}else(0,as.AU)(this._delegate,e)}get(){return(0,as.Jt)(this._delegate).then((e=>new ds(this.database,e)))}once(e,t,n,i){(0,r.od)("Query.once",1,4,arguments.length),(0,r.oD)("Query.once","callback",t,!0);const s=fs.getCancelAndContextArgs_("Query.once",n,i),o=new r.cY,a=(e,n)=>{const r=new ds(this.database,e);t&&t.call(s.context,r,n),o.resolve(r)};a.userCallback=t,a.context=s.context;const c=e=>{s.cancel&&s.cancel.call(s.context,e),o.reject(e)};switch(e){case"value":(0,as.Zy)(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":(0,as._O)(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":(0,as.U0)(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":(0,as.M4)(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":(0,as.X1)(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error((0,r.dI)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return(0,r.od)("Query.limitToFirst",1,1,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.pk)(e)))}limitToLast(e){return(0,r.od)("Query.limitToLast",1,1,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.$1)(e)))}orderByChild(e){return(0,r.od)("Query.orderByChild",1,1,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.kT)(e)))}orderByKey(){return(0,r.od)("Query.orderByKey",0,0,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.JK)()))}orderByPriority(){return(0,r.od)("Query.orderByPriority",0,0,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.og)()))}orderByValue(){return(0,r.od)("Query.orderByValue",0,0,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.VR)()))}startAt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return(0,r.od)("Query.startAt",0,2,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.EO)(e,t)))}startAfter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return(0,r.od)("Query.startAfter",0,2,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.HM)(e,t)))}endAt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return(0,r.od)("Query.endAt",0,2,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.FD)(e,t)))}endBefore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return(0,r.od)("Query.endBefore",0,2,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.rf)(e,t)))}equalTo(e,t){return(0,r.od)("Query.equalTo",1,2,arguments.length),new fs(this.database,(0,as.P)(this._delegate,(0,as.iz)(e,t)))}toString(){return(0,r.od)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,r.od)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,r.od)("Query.isEqual",1,1,arguments.length),!(e instanceof fs)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){const i={cancel:void 0,context:void 0};if(t&&n)i.cancel=t,(0,r.oD)(e,"cancel",i.cancel,!0),i.context=n,(0,r.HN)(e,"context",i.context,!0);else if(t)if("object"===typeof t&&null!==t)i.context=t;else{if("function"!==typeof t)throw new Error((0,r.dI)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new ps(this.database,new as.t2(this._delegate._repo,this._delegate._path))}}class ps extends fs{constructor(e,t){super(e,new as.YL(t._repo,t._path,new as.EZ,!1)),this.database=e,this._delegate=t}getKey(){return(0,r.od)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,r.od)("Reference.child",1,1,arguments.length),"number"===typeof e&&(e=String(e)),new ps(this.database,(0,as.jf)(this._delegate,e))}getParent(){(0,r.od)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new ps(this.database,e):null}getRoot(){return(0,r.od)("Reference.root",0,0,arguments.length),new ps(this.database,this._delegate.root)}set(e,t){(0,r.od)("Reference.set",1,2,arguments.length),(0,r.oD)("Reference.set","onComplete",t,!0);const n=(0,as.hZ)(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}update(e,t){if((0,r.od)("Reference.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,ls("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,as.j2)("Reference.update",this._delegate._path),(0,r.oD)("Reference.update","onComplete",t,!0);const n=(0,as.yo)(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){(0,r.od)("Reference.setWithPriority",2,3,arguments.length),(0,r.oD)("Reference.setWithPriority","onComplete",n,!0);const i=(0,as.$w)(this._delegate,e,t);return n&&i.then((()=>n(null)),(e=>n(e))),i}remove(e){(0,r.od)("Reference.remove",0,1,arguments.length),(0,r.oD)("Reference.remove","onComplete",e,!0);const t=(0,as.TF)(this._delegate);return e&&t.then((()=>e(null)),(t=>e(t))),t}transaction(e,t,n){(0,r.od)("Reference.transaction",1,3,arguments.length),(0,r.oD)("Reference.transaction","transactionUpdate",e,!1),(0,r.oD)("Reference.transaction","onComplete",t,!0),function(e,t,n,i){if((!i||void 0!==n)&&"boolean"!==typeof n)throw new Error((0,r.dI)(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);const i=(0,as.c4)(this._delegate,e,{applyLocally:n}).then((e=>new hs(e.committed,new ds(this.database,e.snapshot))));return t&&i.then((e=>t(null,e.committed,e.snapshot)),(e=>t(e,!1,null))),i}setPriority(e,t){(0,r.od)("Reference.setPriority",1,2,arguments.length),(0,r.oD)("Reference.setPriority","onComplete",t,!0);const n=(0,as.zm)(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}push(e,t){(0,r.od)("Reference.push",0,2,arguments.length),(0,r.oD)("Reference.push","onComplete",t,!0);const n=(0,as.VC)(this._delegate,e),i=n.then((e=>new ps(this.database,e)));t&&i.then((()=>t(null)),(e=>t(e)));const s=new ps(this.database,n);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return(0,as.j2)("Reference.onDisconnect",this._delegate._path),new us(new as.wu(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class gs{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:as.CA,forceLongPolling:as.V0}}useEmulator(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,as.VJ)(this._delegate,e,t,n)}ref(e){if((0,r.od)("database.ref",0,1,arguments.length),e instanceof ps){const t=(0,as.D8)(this._delegate,e.toString());return new ps(this,t)}{const t=(0,as.KR)(this._delegate,e);return new ps(this,t)}}refFromURL(e){(0,r.od)("database.refFromURL",1,1,arguments.length);const t=(0,as.D8)(this._delegate,e);return new ps(this,t)}goOffline(){return(0,r.od)("database.goOffline",0,0,arguments.length),(0,as.Mq)(this._delegate)}goOnline(){return(0,r.od)("database.goOnline",0,0,arguments.length),(0,as.eO)(this._delegate)}}gs.ServerValue={TIMESTAMP:(0,as.O5)(),increment:e=>(0,as.GV)(e)};var ms=Object.freeze({__proto__:null,initStandalone:function(e){let{app:t,url:n,version:r,customAuthImpl:s,customAppCheckImpl:o,namespace:a,nodeAdmin:c=!1}=e;(0,as.SF)(r);const l=new i.h1("database-standalone"),u=new i.Kq("auth-internal",l);let h;return u.setComponent(new i.uA("auth-internal",(()=>s),"PRIVATE")),o&&(h=new i.Kq("app-check-internal",l),h.setComponent(new i.uA("app-check-internal",(()=>o),"PRIVATE"))),{instance:new gs((0,as.Di)(t,u,h,n,c),t),namespace:a}}});const _s=gs.ServerValue;!function(e){e.INTERNAL.registerComponent(new i.uA("database-compat",((e,t)=>{let{instanceIdentifier:n}=t;const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new gs(i,r)}),"PUBLIC").setServiceProps({Reference:ps,Query:fs,Database:gs,DataSnapshot:ds,enableLogging:as.TS,INTERNAL:ms,ServerValue:_s}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","2.0.10")}(d);var vs=n(554),ys=(n(942),n(799));const ws="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",bs="FCM_MSG";var Es,Is;function Ts(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Cs(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(Es||(Es={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(Is||(Is={}));const Ss="fcm_token_details_db",ks="fcm_token_object_Store";const xs="firebase-messaging-store";let Ps=null;function As(){return Ps||(Ps=(0,ys.P2)("firebase-messaging-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(xs)}})),Ps}async function Os(e){const t=Rs(e),n=await As(),r=await n.transaction(xs).objectStore(xs).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map((e=>e.name));if(!e.includes(Ss))return null}let t=null;return(await(0,ys.P2)(Ss,5,{upgrade:async(n,r,i,s)=>{var o;if(r<2)return;if(!n.objectStoreNames.contains(ks))return;const a=s.objectStore(ks),c=await a.index("fcmSenderId").get(e);if(await a.clear(),c)if(2===r){const e=c;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(o=e.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"===typeof e.vapidKey?e.vapidKey:Ts(e.vapidKey)}}}else if(3===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:Ts(e.auth),p256dh:Ts(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:Ts(e.vapidKey)}}}else if(4===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:Ts(e.auth),p256dh:Ts(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:Ts(e.vapidKey)}}}}})).close(),await(0,ys.MR)(Ss),await(0,ys.MR)("fcm_vapid_details_db"),await(0,ys.MR)("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"===typeof e.createTime&&e.createTime>0&&"string"===typeof e.token&&e.token.length>0&&"string"===typeof t.auth&&t.auth.length>0&&"string"===typeof t.p256dh&&t.p256dh.length>0&&"string"===typeof t.endpoint&&t.endpoint.length>0&&"string"===typeof t.swScope&&t.swScope.length>0&&"string"===typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await Ds(e,t),t}}async function Ds(e,t){const n=Rs(e),r=(await As()).transaction(xs,"readwrite");return await r.objectStore(xs).put(t,n),await r.done,t}function Rs(e){let{appConfig:t}=e;return t.appId}const Ns={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Ms=new r.FA("messaging","Messaging",Ns);async function Ls(e,t){const n={method:"DELETE",headers:await Us(e)};try{const r=await fetch("".concat(Fs(e.appConfig),"/").concat(t),n),i=await r.json();if(i.error){const e=i.error.message;throw Ms.create("token-unsubscribe-failed",{errorInfo:e})}}catch(r){throw Ms.create("token-unsubscribe-failed",{errorInfo:null===r||void 0===r?void 0:r.toString()})}}function Fs(e){let{projectId:t}=e;return"".concat("https://fcmregistrations.googleapis.com/v1","/projects/").concat(t,"/registrations")}async function Us(e){let{appConfig:t,installations:n}=e;const r=await n.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(r)})}function js(e){let{p256dh:t,auth:n,endpoint:r,vapidKey:i}=e;const s={web:{endpoint:r,auth:n,p256dh:t}};return i!==ws&&(s.web.applicationPubKey=i),s}async function Bs(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Cs(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:Ts(t.getKey("auth")),p256dh:Ts(t.getKey("p256dh"))},r=await Os(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await Us(e),r=js(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch("".concat(Fs(e.appConfig),"/").concat(t.token),i);s=await n.json()}catch(o){throw Ms.create("token-update-failed",{errorInfo:null===o||void 0===o?void 0:o.toString()})}if(s.error){const e=s.error.message;throw Ms.create("token-update-failed",{errorInfo:e})}if(!s.token)throw Ms.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await Ds(e.firebaseDependencies,r),n}catch(n){throw n}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Ls(e.firebaseDependencies,r.token)}catch(i){console.warn(i)}return Vs(e.firebaseDependencies,n)}return Vs(e.firebaseDependencies,n)}async function qs(e){const t=await Os(e.firebaseDependencies);t&&(await Ls(e.firebaseDependencies,t.token),await async function(e){const t=Rs(e),n=(await As()).transaction(xs,"readwrite");await n.objectStore(xs).delete(t),await n.done}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function Vs(e,t){const n=await async function(e,t){const n=await Us(e),r=js(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(Fs(e.appConfig),i);s=await t.json()}catch(o){throw Ms.create("token-subscribe-failed",{errorInfo:null===o||void 0===o?void 0:o.toString()})}if(s.error){const e=s.error.message;throw Ms.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw Ms.create("token-subscribe-no-token");return s.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await Ds(e,r),r.token}async function Ks(e,t){const n=function(e,t){var n,r;const i={};e.from&&(i.project_number=e.from);e.fcmMessageId&&(i.message_id=e.fcmMessageId);i.instance_id=t,e.notification?i.message_type=Es.DISPLAY_NOTIFICATION.toString():i.message_type=Es.DATA_MESSAGE.toString();i.sdk_platform=3..toString(),i.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),!e.collapse_key||(i.collapse_key=e.collapse_key);i.event=1..toString(),!(null===(n=e.fcmOptions)||void 0===n?void 0:n.analytics_label)||(i.analytics_label=null===(r=e.fcmOptions)||void 0===r?void 0:r.analytics_label);return i}(t,await e.firebaseDependencies.installations.getId());!function(e,t,n){const r={};r.event_time_ms=Math.floor(Date.now()).toString(),r.source_extension_json_proto3=JSON.stringify({messaging_client_event:t}),!n||(r.compliance_data=function(e){const t={privacy_context:{prequest:{origin_associated_product_id:e}}};return t}(n));e.logEvents.push(r)}(e,n,t.productId)}async function zs(e,t){const n=function(e){let{data:t}=e;if(!t)return null;try{return t.json()}catch(n){return null}}(e);if(!n)return;t.deliveryMetricsExportedToBigQueryEnabled&&await Ks(t,n);const r=await Hs();if(function(e){return e.some((e=>"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")))}(r))return function(e,t){t.isFirebaseMessaging=!0,t.messageType=Is.PUSH_RECEIVED;for(const n of e)n.postMessage(t)}(r,n);if(n.notification&&await function(e){var t;const{actions:n}=e,{maxActions:r}=Notification;n&&r&&n.length>r&&console.warn("This browser only supports ".concat(r," actions. The remaining actions will not be displayed."));return self.registration.showNotification(null!==(t=e.title)&&void 0!==t?t:"",e)}(function(e){const t=Object.assign({},e.notification);return t.data={[bs]:e},t}(n)),t&&t.onBackgroundMessageHandler){const e=function(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i);const s=t.notification.icon;s&&(e.notification.icon=s)}(t,e),function(e,t){t.data&&(e.data=t.data)}(t,e),function(e,t){var n,r,i,s,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const a=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(s=t.notification)||void 0===s?void 0:s.click_action;a&&(e.fcmOptions.link=a);const c=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;c&&(e.fcmOptions.analyticsLabel=c)}(t,e),t}(n);"function"===typeof t.onBackgroundMessageHandler?await t.onBackgroundMessageHandler(e):t.onBackgroundMessageHandler.next(e)}}async function Ws(e){var t,n;const r=null===(n=null===(t=e.notification)||void 0===t?void 0:t.data)||void 0===n?void 0:n[bs];if(!r)return;if(e.action)return;e.stopImmediatePropagation(),e.notification.close();const i=function(e){var t,n,r;const i=null!==(n=null===(t=e.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==n?n:null===(r=e.notification)||void 0===r?void 0:r.click_action;if(i)return i;return s=e.data,"object"===typeof s&&s&&"google.c.a.c_id"in s?self.location.origin:null;var s}(r);if(!i)return;const s=new URL(i,self.location.href),o=new URL(self.location.origin);if(s.host!==o.host)return;let a=await async function(e){const t=await Hs();for(const n of t){const t=new URL(n.url,self.location.href);if(e.host===t.host)return n}return null}(s);var c;return a?a=await a.focus():(a=await self.clients.openWindow(i),await(c=3e3,new Promise((e=>{setTimeout(e,c)})))),a?(r.messageType=Is.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,a.postMessage(r)):void 0}function Hs(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Gs(e){return Ms.create("missing-app-config-values",{valueName:e})}!function(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));n.join("")}("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Qs{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw Gs("App Configuration Object");if(!e.name)throw Gs("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const r of t)if(!n[r])throw Gs(r);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}const Ys=e=>{const t=new Qs(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return self.addEventListener("push",(e=>{e.waitUntil(zs(e,t))})),self.addEventListener("pushsubscriptionchange",(e=>{e.waitUntil(async function(e,t){var n,r;const{newSubscription:i}=e;if(!i)return void await qs(t);const s=await Os(t.firebaseDependencies);await qs(t),t.vapidKey=null!==(r=null===(n=null===s||void 0===s?void 0:s.subscriptionOptions)||void 0===n?void 0:n.vapidKey)&&void 0!==r?r:ws,await Bs(t)}(e,t))})),self.addEventListener("notificationclick",(e=>{e.waitUntil(Ws(e))})),t};function $s(e,t){return function(e,t){if(void 0!==self.document)throw Ms.create("only-available-in-sw");return e.onBackgroundMessageHandler=t,()=>{e.onBackgroundMessageHandler=null}}(e=(0,r.Ku)(e),t)}(0,s._registerComponent)(new i.uA("messaging-sw",Ys,"PUBLIC"));class Js{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return(0,vs.gf)(this._delegate,e)}async deleteToken(){return(0,vs.ni)(this._delegate)}onMessage(e){return(0,vs.xD)(this._delegate,e)}onBackgroundMessage(e){return $s(this._delegate,e)}}const Xs=e=>self&&"ServiceWorkerGlobalScope"in self?new Js(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging-sw").getImmediate()):new Js(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging").getImmediate()),Zs={isSupported:function(){return self&&"ServiceWorkerGlobalScope"in self?(0,r.zW)()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"undefined"!==typeof window&&(0,r.zW)()&&(0,r.dM)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}};d.INTERNAL.registerComponent(new i.uA("messaging-compat",Xs,"PUBLIC").setServiceProps(Zs)),d.registerVersion("@firebase/messaging-compat","0.2.21");const eo="firebasestorage.googleapis.com",to="storageBucket";class no extends r.g{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(so(e),"Firebase Storage: ".concat(t," (").concat(so(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,no.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return so(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var ro,io;function so(e){return"storage/"+e}function oo(){return new no(ro.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function ao(){return new no(ro.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function co(){return new no(ro.CANCELED,"User canceled the upload/download.")}function lo(){return new no(ro.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function uo(e){return new no(ro.INVALID_ARGUMENT,e)}function ho(){return new no(ro.APP_DELETED,"The Firebase app was deleted.")}function fo(e){return new no(ro.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function po(e,t){return new no(ro.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function go(e){throw new no(ro.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(ro||(ro={}));class mo{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=mo.makeFromUrl(e,t)}catch(i){return new mo(e,"")}if(""===n.path)return n;throw r=e,new no(ro.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(o,"/").concat("v[A-Za-z0-9_]+","/b/").concat(r,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://".concat(t===eo?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(r,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:s}];for(let c=0;c<a.length;c++){const t=a[c],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new mo(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new no(ro.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class _o{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function vo(e){return"string"===typeof e||e instanceof String}function yo(e){return wo()&&e instanceof Blob}function wo(){return"undefined"!==typeof Blob}function bo(e,t,n,r){if(r<t)throw uo("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw uo("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function Eo(e,t,n){let r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function Io(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function To(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(io||(io={}));class Co{constructor(e,t,n,r,i,s,o,a,c,l,u){let h=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],d=arguments.length>12&&void 0!==arguments[12]&&arguments[12];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=u,this.retry=h,this.isUsingEmulator=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new So(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===io.NO_ERROR,i=n.getStatus();if(!t||To(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===io.ABORT;return void e(!1,new So(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new So(s,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(s){r(s)}else if(null!==i){const e=oo();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?ho():co())}else{r(ao())}};this.canceled_?t(0,new So(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return 2===a}let l=!1;function u(){if(!l){l=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function h(t){i=setTimeout((()=>{i=null,e(f,c())}),t)}function d(){s&&clearTimeout(s)}function f(e){if(l)return void d();for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return d(),void u.call(null,e,...n);if(c()||o)return d(),void u.call(null,e,...n);let s;r<64&&(r*=2),1===a?(a=2,s=0):s=1e3*(r+Math.random()),h(s)}let p=!1;function g(e){p||(p=!0,d(),l||(null!==i?(e||(a=2),clearTimeout(i),h(0)):e||(a=1)))}return h(0),s=setTimeout((()=>{o=!0,g(!0)}),n),g}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class So{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function ko(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function xo(){const e=ko();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(wo())return new Blob(n);throw new no(ro.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function Po(e){if("undefined"===typeof atob)throw t="base-64",new no(ro.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}const Ao={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Oo{constructor(e,t){this.data=e,this.contentType=t||null}}function Do(e,t){switch(e){case Ao.RAW:return new Oo(Ro(t));case Ao.BASE64:case Ao.BASE64URL:return new Oo(No(e,t));case Ao.DATA_URL:return new Oo(function(e){const t=new Mo(e);return t.base64?No(Ao.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(n){throw po(Ao.DATA_URL,"Malformed data URL.")}return Ro(t)}(t.rest)}(t),new Mo(t).contentType)}throw oo()}function Ro(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function No(e,t){switch(e){case Ao.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw po(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case Ao.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw po(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Po(t)}catch(i){if(i.message.includes("polyfill"))throw i;throw po(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class Mo{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw po(Ao.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class Lo{constructor(e,t){let n=0,r="";yo(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(yo(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new Lo(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Lo(n,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(wo()){const e=t.map((e=>e instanceof Lo?e.data_:e));return new Lo(xo.apply(null,e))}{const e=t.map((e=>vo(e)?Do(Ao.RAW,e).data:e.data_));let n=0;e.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let i=0;return e.forEach((e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]})),new Lo(r,!0)}}uploadData(){return this.data_}}function Fo(e){let t;try{t=JSON.parse(e)}catch(n){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function Uo(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function jo(e,t){return t}class Bo{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||jo}}let qo=null;function Vo(){if(qo)return qo;const e=[];e.push(new Bo("bucket")),e.push(new Bo("generation")),e.push(new Bo("metageneration")),e.push(new Bo("name","fullPath",!0));const t=new Bo("name");t.xform=function(e,t){return function(e){return!vo(e)||e.length<2?e:Uo(e)}(t)},e.push(t);const n=new Bo("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Bo("timeCreated")),e.push(new Bo("updated")),e.push(new Bo("md5Hash",null,!0)),e.push(new Bo("cacheControl",null,!0)),e.push(new Bo("contentDisposition",null,!0)),e.push(new Bo("contentEncoding",null,!0)),e.push(new Bo("contentLanguage",null,!0)),e.push(new Bo("contentType",null,!0)),e.push(new Bo("metadata","customMetadata",!0)),qo=e,qo}function Ko(e,t,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const e=n[s];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new mo(n,r);return t._makeStorageReference(i)}})}(r,e),r}function zo(e,t,n){const r=Fo(t);if(null===r)return null;return Ko(e,r,n)}function Wo(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}const Ho="prefixes",Go="items";function Qo(e,t,n){const r=Fo(n);if(null===r)return null;return function(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[Ho])for(const i of n[Ho]){const n=i.replace(/\/$/,""),s=e._makeStorageReference(new mo(t,n));r.prefixes.push(s)}if(n[Go])for(const i of n[Go]){const n=e._makeStorageReference(new mo(t,i.name));r.items.push(n)}return r}(e,t,r)}class Yo{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function $o(e){if(!e)throw oo()}function Jo(e,t){return function(n,r){const i=zo(e,r,t);return $o(null!==i),i}}function Xo(e,t){return function(n,r){const i=zo(e,r,t);return $o(null!==i),function(e,t,n,r){const i=Fo(t);if(null===i)return null;if(!vo(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map((t=>{const i=e.bucket,s=e.fullPath;return Eo("/b/"+o(i)+"/o/"+o(s),n,r)+Io({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function Zo(e){return function(t,n){let r;var i,s;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new no(ro.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new no(ro.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,r=new no(ro.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new no(ro.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function ea(e){const t=Zo(e);return function(n,r){let i=t(n,r);var s;return 404===n.getStatus()&&(s=e.path,i=new no(ro.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function ta(e,t,n){const r=Eo(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new Yo(r,"GET",Jo(e,n),i);return s.errorHandler=ea(t),s}function na(e,t,n,r,i){const s={};t.isRoot?s.prefix="":s.prefix=t.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=Eo(t.bucketOnlyServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,c=new Yo(o,"GET",function(e,t){return function(n,r){const i=Qo(e,t,r);return $o(null!==i),i}}(e,t.bucket),a);return c.urlParams=s,c.errorHandler=Zo(t),c}function ra(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function ia(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=ra(t,r,i),l="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Wo(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",u="\r\n--"+a+"--",h=Lo.getBlob(l,r,u);if(null===h)throw lo();const d={name:c.fullPath},f=Eo(s,e.host,e._protocol),p=e.maxUploadRetryTime,g=new Yo(f,"POST",Jo(e,n),p);return g.urlParams=d,g.headers=o,g.body=h.uploadData(),g.errorHandler=Zo(t),g}class sa{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function oa(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(r){$o(!1)}return $o(!!n&&-1!==(t||["active"]).indexOf(n)),n}const aa=262144;function ca(e,t,n,r,i,s,o,a){const c=new sa(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw new no(ro.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");const l=c.total-c.current;let u=l;i>0&&(u=Math.min(u,i));const h=c.current,d=h+u;let f="";f=0===u?"finalize":l===u?"upload, finalize":"upload";const p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":"".concat(c.current)},g=r.slice(h,d);if(null===g)throw lo();const m=t.maxUploadRetryTime,_=new Yo(n,"POST",(function(e,n){const i=oa(e,["active","final"]),o=c.current+u,a=r.size();let l;return l="final"===i?Jo(t,s)(e,n):null,new sa(o,a,"final"===i,l)}),m);return _.headers=p,_.body=g.uploadData(),_.progressCallback=a||null,_.errorHandler=Zo(e),_}const la={STATE_CHANGED:"state_changed"},ua={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function ha(e){switch(e){case"running":case"pausing":case"canceling":return ua.RUNNING;case"paused":return ua.PAUSED;case"success":return ua.SUCCESS;case"canceled":return ua.CANCELED;default:return ua.ERROR}}class da{constructor(e,t,n){const r=function(e){return"function"===typeof e}(e)||null!=t||null!=n;if(r)this.next=e,this.error=null!==t&&void 0!==t?t:void 0,this.complete=null!==n&&void 0!==n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}function fa(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Promise.resolve().then((()=>e(...n)))}}class pa{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=io.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=io.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=io.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,i,s){if(this.sent_)throw go("cannot .send() more than once");if((0,r.zJ)(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==s)for(const r in s)s.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,s[r].toString());return void 0!==i?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw go("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw go("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw go("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw go("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class ga extends pa{initXhr(){this.xhr_.responseType="text"}}function ma(){return new ga}class _a{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=Vo(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(ro.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const t=this.isExponentialBackoffExpired();if(To(e.status,[])){if(!t)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();e=ao()}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(ro.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((()=>{this.pendingTimeout=void 0,this._continueUpload()}),this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((t=>{let[n,r]=t;switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o=ra(t,r,i),a={name:o.fullPath},c=Eo(s,e.host,e._protocol),l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(r.size()),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},u=Wo(o,n),h=e.maxUploadRetryTime,d=new Yo(c,"POST",(function(e){let t;oa(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(n){$o(!1)}return $o(vo(t)),t}),h);return d.urlParams=a,d.headers=l,d.body=u,d.errorHandler=Zo(t),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,ma,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const r=function(e,t,n,r){const i=e.maxUploadRetryTime,s=new Yo(n,"POST",(function(e){const t=oa(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(s){$o(!1)}n||$o(!1);const i=Number(n);return $o(!isNaN(i)),new sa(i,r.size(),"final"===t)}),i);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=Zo(t),s}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,ma,t,n);this._request=i,i.getPromise().then((e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=aa*this._chunkMultiplier,t=new sa(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((r,i)=>{let s;try{s=ca(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(a){return this._error=a,void this._transition("error")}const o=this._ref.storage._makeRequest(s,ma,r,i,!1);this._request=o,o.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){2*(aa*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=ta(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,ma,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=ia(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,ma,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=co(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=ha(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const i=new da(t||void 0,n||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(ha(this._state)){case ua.SUCCESS:fa(this._resolve.bind(null,this.snapshot))();break;case ua.CANCELED:case ua.ERROR:fa(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(ha(this._state)){case ua.RUNNING:case ua.PAUSED:e.next&&fa(e.next.bind(e,this.snapshot))();break;case ua.SUCCESS:e.complete&&fa(e.complete.bind(e))();break;default:e.error&&fa(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class va{constructor(e,t){this._service=e,this._location=t instanceof mo?t:mo.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new va(e,t)}get root(){const e=new mo(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Uo(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new mo(this._location.bucket,e);return new va(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw fo(e)}}function ya(e){const t={prefixes:[],items:[]};return wa(e,t).then((()=>t))}async function wa(e,t,n){const r={pageToken:n},i=await ba(e,r);t.prefixes.push(...i.prefixes),t.items.push(...i.items),null!=i.nextPageToken&&await wa(e,t,i.nextPageToken)}function ba(e,t){null!=t&&"number"===typeof t.maxResults&&bo("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=na(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,ma)}function Ea(e,t){e._throwIfRoot("updateMetadata");const n=function(e,t,n,r){const i=Eo(t.fullServerUrl(),e.host,e._protocol),s=Wo(n,r),o=e.maxOperationRetryTime,a=new Yo(i,"PATCH",Jo(e,r),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=ea(t),a}(e.storage,e._location,t,Vo());return e.storage.makeRequestWithTokens(n,ma)}function Ia(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=Eo(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new Yo(r,"GET",Xo(e,n),i);return s.errorHandler=ea(t),s}(e.storage,e._location,Vo());return e.storage.makeRequestWithTokens(t,ma).then((e=>{if(null===e)throw new no(ro.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function Ta(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=Eo(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,i=new Yo(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=ea(t),i}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,ma)}function Ca(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new mo(e._location.bucket,n);return new va(e.storage,r)}function Sa(e,t){if(e instanceof Pa){const n=e;if(null==n._bucket)throw new no(ro.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+to+"' property when initializing the app?");const r=new va(n,n._bucket);return null!=t?Sa(r,t):r}return void 0!==t?Ca(e,t):e}function ka(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Pa)return new va(e,t);throw uo("To use ref(service, url), the first argument must be a Storage instance.")}return Sa(e,t)}function xa(e,t){const n=null===t||void 0===t?void 0:t[to];return null==n?null:mo.makeFromBucketSpec(n,e)}class Pa{constructor(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=s,this._bucket=null,this._host=eo,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?mo.makeFromBucketSpec(r,this._host):xa(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=mo.makeFromBucketSpec(this._url,e):this._bucket=xa(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){bo("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){bo("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if((0,s._isFirebaseServerApp)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new va(this,e)}_makeRequest(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new _o(ho());{const s=function(e,t,n,r,i,s){let o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const c=Io(e.urlParams),l=e.url+c,u=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(u,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,r),new Co(l,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o,a)}(e,this._appId,n,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then((()=>this._requests.delete(s)),(()=>this._requests.delete(s))),s}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Aa="@firebase/storage",Oa="0.13.13",Da="storage";function Ra(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new _a(e,new Lo(t),n)}(e=(0,r.Ku)(e),t,n)}function Na(e){return function(e){e._throwIfRoot("getMetadata");const t=ta(e.storage,e._location,Vo());return e.storage.makeRequestWithTokens(t,ma)}(e=(0,r.Ku)(e))}function Ma(e,t){return ka(e=(0,r.Ku)(e),t)}function La(e,t,n){!function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n);const s=(0,r.zJ)(t);s&&((0,r.gE)("https://".concat(e.host,"/b")),(0,r.P1)("Storage",!0)),e._isUsingEmulator=!0,e._protocol=s?"https":"http";const{mockUserToken:o}=i;o&&(e._overrideAuthToken="string"===typeof o?o:(0,r.Fy)(o,e.app.options.projectId))}(e,t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{})}function Fa(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return new Pa(r,i,o,n,s.SDK_VERSION)}(0,s._registerComponent)(new i.uA(Da,Fa,"PUBLIC").setMultipleInstances(!0)),(0,s.registerVersion)(Aa,Oa,""),(0,s.registerVersion)(Aa,Oa,"esm2017");class Ua{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class ja{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Ua(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then((t=>{if(e)return e(new Ua(t,this,this._ref))}),t)}on(e,t,n,r){let i;return t&&(i="function"===typeof t?e=>t(new Ua(e,this,this._ref)):{next:t.next?e=>t.next(new Ua(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}class Ba{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map((e=>new qa(e,this._service)))}get items(){return this._delegate.items.map((e=>new qa(e,this._service)))}get nextPageToken(){return this._delegate.nextPageToken||null}}class qa{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function(e,t){return Ca(e,t)}(this._delegate,e);return new qa(t,this.storage)}get root(){return new qa(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new qa(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new ja(Ra(this._delegate,e,t),this)}putString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ao.RAW,n=arguments.length>2?arguments[2]:void 0;this._throwIfRoot("putString");const r=Do(t,e),i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new ja(new _a(this._delegate,new Lo(r.data,!0),i),this)}listAll(){return function(e){return ya(e=(0,r.Ku)(e))}(this._delegate).then((e=>new Ba(e,this.storage)))}list(e){return function(e,t){return ba(e=(0,r.Ku)(e),t)}(this._delegate,e||void 0).then((e=>new Ba(e,this.storage)))}getMetadata(){return Na(this._delegate)}updateMetadata(e){return function(e,t){return Ea(e=(0,r.Ku)(e),t)}(this._delegate,e)}getDownloadURL(){return function(e){return Ia(e=(0,r.Ku)(e))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function(e){return Ta(e=(0,r.Ku)(e))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw fo(e)}}class Va{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(Ka(e))throw uo("ref() expected a child path but got a URL, use refFromURL instead.");return new qa(Ma(this._delegate,e),this)}refFromURL(e){if(!Ka(e))throw uo("refFromURL() expected a full URL but got a child path, use ref() instead.");try{mo.makeFromUrl(e,this._delegate.host)}catch(t){throw uo("refFromUrl() expected a valid full URL but got an invalid one.")}return new qa(Ma(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};La(this._delegate,e,t,n)}}function Ka(e){return/^[A-Za-z]+:\/\//.test(e)}function za(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("storage").getImmediate({identifier:n});return new Va(r,i)}!function(e){const t={TaskState:ua,TaskEvent:la,StringFormat:Ao,Storage:Va,Reference:qa};e.INTERNAL.registerComponent(new i.uA("storage-compat",za,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.3.23")}(d);d.initializeApp({apiKey:"AIzaSyAFbnl9zGGU8n3_t899of2imSpohCLrX9o",authDomain:"sri-rudra-chat.firebaseapp.com",databaseURL:"https://sri-rudra-chat-default-rtdb.firebaseio.com",projectId:"sri-rudra-chat",storageBucket:"sri-rudra-chat.appspot.com",messagingSenderId:"188670520129",appId:"1:188670520129:web:43b5d91158ae5cb379cfca0"});const Wa=d.auth(),Ha=d.firestore(),Ga=d.database(),Qa=d.messaging(),Ya=d.storage();Qa.onMessage((e=>{const{title:t,body:n}=e.notification||{};t&&new Notification(t,{body:n})}));const $a=()=>Wa.signInAnonymously()},796:(e,t,n)=>{n.d(t,{KR:()=>r.KR,TF:()=>r.TF,Zy:()=>r.Zy,hZ:()=>r.hZ,yX:()=>r.yX});var r=n(255)},799:(e,t,n)=>{n.d(t,{MR:()=>v,P2:()=>_});var r=n(379);const i=(e,t)=>t.some((t=>e instanceof t));let s,o;const a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,h=new WeakMap;let d={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return c.get(e);if("objectStoreNames"===t)return e.objectStoreNames||l.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return g(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(m(this),n),g(a.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return g(e.apply(m(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(m(this),t,...r);return l.set(s,t.sort?t.sort():[t]),g(s)}}function p(e){return"function"===typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(c.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));c.set(e,t)}(e),i(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,d):e)}function g(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(g(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&a.set(t,e)})).catch((()=>{})),h.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=p(e);return t!==e&&(u.set(e,t),h.set(t,e)),t}const m=e=>h.get(e);function _(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=g(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(g(o.result),e.oldVersion,e.newVersion,g(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function v(e){let{blocked:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),g(n).then((()=>{}))}const y=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],b=new Map;function E(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(b.get(t))return b.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=w.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!y.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return b.set(t,s),s}d=(e=>(0,r.A)((0,r.A)({},e),{},{get:(t,n,r)=>E(t,n)||e.get(t,n,r),has:(t,n)=>!!E(t,n)||e.has(t,n)}))(d)},812:(e,t,n)=>{n.d(t,{Kq:()=>o,h1:()=>a,uA:()=>i});var r=n(529);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const s="[DEFAULT]";class o{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===s?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(o){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},814:(e,t,n)=>{n.d(t,{fS:()=>Xd,Ix:()=>$h,H6:()=>Fh,T1:()=>Ch,Wq:()=>nf,uY:()=>Jh,W6:()=>U,Ci:()=>Zh,YQ:()=>rf,NJ:()=>sf,Dc:()=>se,GA:()=>Tf,cm:()=>On,K$:()=>de,FA:()=>he,lo:()=>_h,bI:()=>M,qG:()=>mn,qi:()=>A,c8:()=>fh,gS:()=>vf,C3:()=>Df,hq:()=>Of,me:()=>zh,rJ:()=>kh,Cs:()=>xh,vN:()=>Ih,kd:()=>_f,CL:()=>Pf,LA:()=>Gh,H9:()=>Ph,ol:()=>qh,Q5:()=>Vh,Os:()=>Hh,FD:()=>Gd,rf:()=>Hd,Ws:()=>jh,z6:()=>bf,x7:()=>cf,nY:()=>uf,_e:()=>hf,GG:()=>df,kU:()=>ff,Rr:()=>pf,GV:()=>Rf,AB:()=>Bd,$1:()=>qd,po:()=>Qh,St:()=>Yh,aQ:()=>yf,FC:()=>wf,My:()=>Ud,P:()=>Rd,B:()=>Oh,yx:()=>Ah,c4:()=>xf,O5:()=>Af,BN:()=>gf,He:()=>k,lN:()=>af,HM:()=>zd,EO:()=>Kd,mZ:()=>mf,iB:()=>Wh,_M:()=>Md});var r,i,s=n(52),o=n(812),a=n(443),c=n(529),l="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},u={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function s(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var o={};function a(e){return-128<=e&&128>e?function(e,t){var n=o;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new s([0|e],0>e?-1:0)})):new s([0|e],0>e?-1:0)}function c(e){if(isNaN(e)||!isFinite(e))return l;if(0>e)return g(c(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new s(t,0)}var l=a(0),h=a(1),d=a(16777216);function f(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return-1==e.h}function g(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new s(n,~e.h).add(h)}function m(e,t){return e.add(g(t))}function _(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function v(e,t){this.g=e,this.h=t}function y(e,t){if(f(t))throw Error("division by zero");if(f(e))return new v(l,l);if(p(e))return t=y(g(e),t),new v(g(t.g),g(t.h));if(p(t))return t=y(e,g(t)),new v(g(t.g),t.h);if(30<e.g.length){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var n=h,r=t;0>=r.l(e);)n=w(n),r=w(r);var i=b(n,1),s=b(r,1);for(r=b(r,2),n=b(n,2);!f(r);){var o=s.add(r);0>=o.l(e)&&(i=i.add(n),s=o),r=b(r,1),n=b(n,1)}return t=m(e,i.j(t)),new v(i,t)}for(i=l;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=c(n)).j(t);p(o)||0<o.l(e);)o=(s=c(n-=r)).j(t);f(s)&&(s=h),i=i.add(s),e=m(e,o)}return new v(i,e)}function w(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new s(n,e.h)}function b(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],o=0;o<r;o++)i[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new s(i,e.h)}(e=s.prototype).m=function(){if(p(this))return-g(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(p(this))return"-"+g(this).toString(e);for(var t=c(Math.pow(e,6)),n=this,r="";;){var i=y(n,t).g,s=((0<(n=m(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(f(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return p(e=m(this,e))?-1:f(e)?0:1},e.abs=function(){return p(this)?g(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var o=r+(65535&this.i(i))+(65535&e.i(i)),a=(o>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=a>>>16,o&=65535,a&=65535,n[i]=a<<16|o}return new s(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(f(this)||f(e))return l;if(p(this))return p(e)?g(this).j(g(e)):g(g(this).j(e));if(p(e))return g(this.j(g(e)));if(0>this.l(d)&&0>e.l(d))return c(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var o=this.i(r)>>>16,a=65535&this.i(r),u=e.i(i)>>>16,h=65535&e.i(i);n[2*r+2*i]+=a*h,_(n,2*r+2*i),n[2*r+2*i+1]+=o*h,_(n,2*r+2*i+1),n[2*r+2*i+1]+=a*u,_(n,2*r+2*i+1),n[2*r+2*i+2]+=o*u,_(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new s(n,0)},e.A=function(e){return y(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new s(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new s(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new s(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,i=u.Md5=t,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return g(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=c(Math.pow(n,8)),i=l,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=c(Math.pow(n,o)),i=i.j(o).add(c(a))):i=(i=i.j(r)).add(c(a))}return i},r=u.Integer=s}).apply("undefined"!==typeof l?l:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var h,d,f,p,g,m,_,v,y="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},w={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof y&&y];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function c(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function l(e,t,n){return(l=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:c).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function b(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function E(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function I(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function T(e){return/^[\s\xa0]*$/.test(e)}function C(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function S(e){return S[" "](e),e}S[" "]=function(){};var k=-1!=C().indexOf("Gecko")&&!(-1!=C().toLowerCase().indexOf("webkit")&&-1==C().indexOf("Edge"))&&!(-1!=C().indexOf("Trident")||-1!=C().indexOf("MSIE"))&&-1==C().indexOf("Edge");function x(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function P(e){const t={};for(const n in e)t[n]=e[n];return t}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<A.length;t++)n=A[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function D(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function R(e){i.setTimeout((()=>{throw e}),0)}function N(){var e=j;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var M=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new L),(e=>e.reset()));class L{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let F,U=!1,j=new class{constructor(){this.h=this.g=null}add(e,t){const n=M.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},B=()=>{const e=i.Promise.resolve(void 0);F=()=>{e.then(q)}};var q=()=>{for(var e;e=N();){try{e.h.call(e.g)}catch(n){R(n)}var t=M;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}U=!1};function V(){this.s=this.s,this.C=this.C}function K(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},K.prototype.h=function(){this.defaultPrevented=!0};var z=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function W(e,t){if(K.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(k){e:{try{S(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:H[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&W.aa.h.call(this)}}b(W,K);var H={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var G="closure_listenable_"+(1e6*Math.random()|0),Q=0;function Y(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++Q,this.da=this.fa=!1}function $(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function J(e){this.src=e,this.g={},this.h=0}function X(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&($(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Z(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}J.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Z(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new Y(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var ee="closure_lm_"+(1e6*Math.random()|0),te={};function ne(e,t,n,r,i){if(r&&r.once)return ie(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)ne(e,t[s],n,r,i);return null}return n=he(n),e&&e[G]?e.K(t,n,o(r)?!!r.capture:!!r,i):re(e,t,n,!1,r,i)}function re(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,c=le(e);if(c||(e[ee]=c=new J(e)),(n=c.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=ce;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)z||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(ae(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ie(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ie(e,t[s],n,r,i);return null}return n=he(n),e&&e[G]?e.L(t,n,o(r)?!!r.capture:!!r,i):re(e,t,n,!0,r,i)}function se(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)se(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=he(n),e&&e[G]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Z(s=e.g[t],n,r,i))&&($(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=le(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Z(t,n,r,i)),(n=-1<e?t[e]:null)&&oe(n))}function oe(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[G])X(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ae(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=le(t))?(X(n,e),0==n.h&&(n.src=null,t[ee]=null)):$(e)}}}function ae(e){return e in te?te[e]:te[e]="on"+e}function ce(e,t){if(e.da)e=!0;else{t=new W(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&oe(e),e=n.call(r,t)}return e}function le(e){return(e=e[ee])instanceof J?e:null}var ue="__closure_events_fn_"+(1e9*Math.random()>>>0);function he(e){return"function"===typeof e?e:(e[ue]||(e[ue]=function(t){return e.handleEvent(t)}),e[ue])}function de(){V.call(this),this.i=new J(this),this.M=this,this.F=null}function fe(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new K(t,e);else if(t instanceof K)t.target=t.target||e;else{var i=t;O(t=new K(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=pe(o,r,!0,t)&&i}if(i=pe(o=t.g=e,r,!0,t)&&i,i=pe(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=pe(o=t.g=n[s],r,!1,t)&&i}function pe(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.fa&&X(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}function ge(e,t,n){if("function"===typeof e)n&&(e=l(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function me(e){e.g=ge((()=>{e.g=null,e.i&&(e.i=!1,me(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}b(de,V),de.prototype[G]=!0,de.prototype.removeEventListener=function(e,t,n,r){se(this,e,t,n,r)},de.prototype.N=function(){if(de.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)$(n[r]);delete t.g[e],t.h--}}this.F=null},de.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},de.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class _e extends V{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:me(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ve(e){V.call(this),this.h=e,this.g={}}b(ve,V);var ye=[];function we(e){x(e.g,(function(e,t){this.g.hasOwnProperty(t)&&oe(e)}),e),e.g={}}ve.prototype.N=function(){ve.aa.N.call(this),we(this)},ve.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var be=i.JSON.stringify,Ee=i.JSON.parse,Ie=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function Te(){}function Ce(e){return e.h||(e.h=e.i())}function Se(){}Te.prototype.h=null;var ke={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xe(){K.call(this,"d")}function Pe(){K.call(this,"c")}b(xe,K),b(Pe,K);var Ae={},Oe=null;function De(){return Oe=Oe||new de}function Re(e){K.call(this,Ae.La,e)}function Ne(e){const t=De();fe(t,new Re(t))}function Me(e,t){K.call(this,Ae.STAT_EVENT,e),this.stat=t}function Le(e){const t=De();fe(t,new Me(t,e))}function Fe(e,t){K.call(this,Ae.Ma,e),this.size=t}function Ue(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function je(){this.g=!0}function Be(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return be(n)}catch(a){return t}}(e,n)+(r?" "+r:"")}))}Ae.La="serverreachability",b(Re,K),Ae.STAT_EVENT="statevent",b(Me,K),Ae.Ma="timingevent",b(Fe,K),je.prototype.xa=function(){this.g=!1},je.prototype.info=function(){};var qe,Ve={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ke={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function ze(){}function We(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new ve(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new He}function He(){this.i=null,this.g="",this.h=!1}b(ze,Te),ze.prototype.g=function(){return new XMLHttpRequest},ze.prototype.i=function(){return{}},qe=new ze;var Ge={},Qe={};function Ye(e,t,n){e.L=1,e.v=bt(mt(t)),e.m=n,e.P=!0,$e(e,null)}function $e(e,t){e.F=Date.now(),Ze(e),e.A=mt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Mt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new He,e.g=In(e.j,n?t:null,!e.m),0<e.O&&(e.M=new _e(l(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ye[0]=i.toString()),i=ye);for(var s=0;s<i.length;s++){var o=ne(n,i[s],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?P(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ne(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Je(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Xe(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Qe:(n=Number(t.substring(n,r)),isNaN(n)?Ge:(r+=1)+n>t.length?Qe:(t=t.slice(r,r+n),e.C=r+n,t))}function Ze(e){e.S=Date.now()+e.I,et(e,e.I)}function et(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ue(l(e.ba,e),t)}function tt(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function nt(e){0==e.j.G||e.J||vn(e.j,e)}function rt(e){tt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,we(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function it(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||lt(n.h,e)))if(!e.K&&lt(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;_n(n),an(n)}pn(n),Le(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ue(l(n.Za,n),6e3));if(1>=ct(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else wn(n,11)}else if((e.K||n.g==e)&&_n(n),!T(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let l=i[t];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.K=l[1],n.ia=l[2];const t=l[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=l[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=l[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ut(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,wt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((r=n).qa=En(r,r.J?r.ia:null,r.W),o.K){ht(r.h,o);var a=o,c=r.L;c&&(a.I=c),a.B&&(tt(a),Ze(a)),r.g=o}else fn(r);0<n.i.length&&ln(n)}else"stop"!=l[0]&&"close"!=l[0]||wn(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?wn(n,7):on(n):"noop"!=l[0]&&n.l&&n.l.ta(l),n.v=0)}Ne()}catch(u){}}We.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==tn(e)?t.j():this.Y(e)},We.prototype.Y=function(e){try{if(e==this.g)e:{const d=tn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||nn(this.g)))){this.J||4!=d||7==t||Ne(),tt(this);var n=this.g.Z();this.X=n;t:if(Je(this)){var r=nn(this.g);e="";var s=r.length,o=4==tn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){rt(this),nt(this);var a="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(c)){var u=c;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Le(12),rt(this),nt(this);break e}Be(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,it(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=Xe(this,a),e==Qe){4==d&&(this.s=4,Le(14),n=!1),Be(this.i,this.l,null,"[Incomplete Response]");break}if(e==Ge){this.s=4,Le(15),Be(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Be(this.i,this.l,e,null),it(this,e)}if(Je(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,Le(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),gn(h),h.M=!0,Le(11))}}else Be(this.i,this.l,a,"[Invalid Chunked Response]"),rt(this),nt(this)}else Be(this.i,this.l,a,null),it(this,a);4==d&&rt(this),this.o&&!this.J&&(4==d?vn(this.j,this):(this.o=!1,Ze(this)))}else(function(e){const t={};e=(e.g&&2<=tn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(T(e[r]))continue;var n=D(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Le(12)):(this.s=0,Le(13)),rt(this),nt(this)}}}catch(d){}},We.prototype.cancel=function(){this.J=!0,rt(this)},We.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Ne(),Le(17)),rt(this),this.s=2,nt(this)):et(this,this.S-e)};var st=class{constructor(e,t){this.g=e,this.map=t}};function ot(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function at(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ct(e){return e.h?1:e.g?e.g.size:0}function lt(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ut(e,t){e.g?e.g.add(t):e.h=t}function ht(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function dt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return E(e.i)}function ft(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}ot.prototype.cancel=function(){if(this.i=dt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var pt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof gt){this.h=e.h,_t(this,e.j),this.o=e.o,this.g=e.g,vt(this,e.s),this.l=e.l;var t=e.i,n=new Ot;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),yt(this,n),this.m=e.m}else e&&(t=String(e).match(pt))?(this.h=!1,_t(this,t[1]||"",!0),this.o=Et(t[2]||""),this.g=Et(t[3]||"",!0),vt(this,t[4]),this.l=Et(t[5]||"",!0),yt(this,t[6]||"",!0),this.m=Et(t[7]||"")):(this.h=!1,this.i=new Ot(null,this.h))}function mt(e){return new gt(e)}function _t(e,t,n){e.j=n?Et(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function vt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function yt(e,t,n){t instanceof Ot?(e.i=t,function(e,t){t&&!e.j&&(Dt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Rt(this,t),Mt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=It(t,Pt)),e.i=new Ot(t,e.h))}function wt(e,t,n){e.i.set(t,n)}function bt(e){return wt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Et(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function It(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Tt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Tt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}gt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(It(t,St,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(It(t,St,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(It(n,"/"==n.charAt(0)?xt:kt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",It(n,At)),e.join("")};var Ct,St=/[#\/\?@]/g,kt=/[#\?:]/g,xt=/[#\?]/g,Pt=/[#\?@]/g,At=/#/g;function Ot(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Dt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Rt(e,t){Dt(e),t=Lt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Nt(e,t){return Dt(e),t=Lt(e,t),e.g.has(t)}function Mt(e,t,n){Rt(e,t),0<n.length&&(e.i=null,e.g.set(Lt(e,t),E(n)),e.h+=n.length)}function Lt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ft(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function Ut(){this.g=new Ie}function jt(e,t,n){const r=n||"";try{ft(e,(function(e,n){let i=e;o(e)&&(i=be(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Bt(e){this.l=e.Ub||null,this.j=e.eb||!1}function qt(e,t){de.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Vt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Kt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,zt(e)}function zt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Wt(e){let t="";return x(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Ht(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Wt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):wt(e,t,n))}function Gt(e){de.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Ot.prototype).add=function(e,t){Dt(this),this.i=null,e=Lt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Dt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Dt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Dt(this);let t=[];if("string"===typeof e)Nt(this,e)&&(t=t.concat(this.g.get(Lt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Dt(this),this.i=null,Nt(this,e=Lt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")},b(Bt,Te),Bt.prototype.g=function(){return new qt(this.l,this.j)},Bt.prototype.i=(Ct={},function(){return Ct}),b(qt,de),(e=qt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,zt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Kt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,zt(this)),this.g&&(this.readyState=3,zt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Kt(this):zt(this),3==this.readyState&&Vt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Kt(this))},e.Qa=function(e){this.g&&(this.response=e,Kt(this))},e.ga=function(){this.g&&Kt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(qt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),b(Gt,de);var Qt=/^https?$/i,Yt=["POST","PUT"];function $t(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Jt(e),Zt(e)}function Jt(e){e.A||(e.A=!0,fe(e,"complete"),fe(e,"error"))}function Xt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=tn(e)||2!=e.Z()))if(e.u&&4==tn(e))ge(e.Ea,0,e);else if(fe(e,"readystatechange"),4==tn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var o=String(e.D).match(pt)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!Qt.test(o?o.toLowerCase():"")}n=s}if(n)fe(e,"complete"),fe(e,"success");else{e.m=6;try{var a=2<tn(e)?e.g.statusText:""}catch(c){a=""}e.l=a+" ["+e.Z()+"]",Jt(e)}}finally{Zt(e)}}}function Zt(e,t){if(e.g){en(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||fe(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function en(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function tn(e){return e.g?e.g.readyState:0}function nn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function rn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function sn(e){this.Aa=0,this.i=[],this.j=new je,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rn("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rn("baseRetryDelayMs",5e3,e),this.cb=rn("retryDelaySeedMs",1e4,e),this.Wa=rn("forwardChannelMaxRetries",2,e),this.wa=rn("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new ot(e&&e.concurrentRequestLimit),this.Da=new Ut,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function on(e){if(cn(e),3==e.G){var t=e.U++,n=mt(e.I);if(wt(n,"SID",e.K),wt(n,"RID",t),wt(n,"TYPE","terminate"),hn(e,n),(t=new We(e,e.j,t)).L=2,t.v=bt(mt(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=In(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Ze(t)}bn(e)}function an(e){e.g&&(gn(e),e.g.cancel(),e.g=null)}function cn(e){an(e),e.u&&(i.clearTimeout(e.u),e.u=null),_n(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function ln(e){if(!at(e.h)&&!e.s){e.s=!0;var t=e.Ga;F||B(),U||(F(),U=!0),j.add(t,e),e.B=0}}function un(e,t){var n;n=t?t.l:e.U++;const r=mt(e.I);wt(r,"SID",e.K),wt(r,"RID",n),wt(r,"AID",e.T),hn(e,r),e.m&&e.o&&Ht(r,e.m,e.o),n=new We(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=dn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),ut(e.h,n),Ye(n,r,t)}function hn(e,t){e.H&&x(e.H,(function(e,n){wt(t,n,e)})),e.l&&ft({},(function(e,n){wt(t,n,e)}))}function dn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?l(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let a=0;a<n;a++){let n=i[a].g;const c=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),o=!1;else try{jt(c,e,"req"+n+"_")}catch(s){r&&r(c)}}if(o){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function fn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;F||B(),U||(F(),U=!0),j.add(t,e),e.v=0}}function pn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ue(l(e.Fa,e),yn(e,e.v)),e.v++,!0)}function gn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function mn(e){e.g=new We(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=mt(e.qa);wt(t,"RID","rpc"),wt(t,"SID",e.K),wt(t,"AID",e.T),wt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&wt(t,"TO",e.ja),wt(t,"TYPE","xmlhttp"),hn(e,t),e.m&&e.o&&Ht(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=bt(mt(t)),n.m=null,n.P=!0,$e(n,e)}function _n(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function vn(e,t){var n=null;if(e.g==t){_n(e),gn(e),e.g=null;var r=2}else{if(!lt(e.h,t))return;n=t.D,ht(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;fe(r=De(),new Fe(r,n)),ln(e)}else fn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(ct(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ue(l(e.Ga,e,t),yn(e,e.B)),e.B++,!0))}(e,t)||2==r&&pn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:wn(e,5);break;case 4:wn(e,10);break;case 3:wn(e,6);break;default:wn(e,2)}}function yn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function wn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.fb,e),r=e.Xa;const t=!r;r=new gt(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||_t(r,"https"),bt(r),t?function(e,t){const n=new je;if(i.Image){const r=new Image;r.onload=u(Ft,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Ft,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Ft,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Ft,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new je;const n=new AbortController,r=setTimeout((()=>{n.abort(),Ft(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Ft(0,0,!0,t):Ft(0,0,!1,t)})).catch((()=>{clearTimeout(r),Ft(0,0,!1,t)}))}(r.toString(),n)}else Le(2);e.G=0,e.l&&e.l.sa(t),bn(e),cn(e)}function bn(e){if(e.G=0,e.ka=[],e.l){const t=dt(e.h);0==t.length&&0==e.i.length||(I(e.ka,t),I(e.ka,e.i),e.h.i.length=0,E(e.i),e.i.length=0),e.l.ra()}}function En(e,t,n){var r=n instanceof gt?mt(n):new gt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),vt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new gt(null);r&&_t(o,r),t&&(o.g=t),s&&vt(o,s),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&wt(r,n,t),wt(r,"VER",e.la),hn(e,r),r}function In(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Gt(new Bt({eb:n})):new Gt(e.pa)).Ha(e.J),t}function Tn(){}function Cn(){}function Sn(e,t){de.call(this),this.g=new sn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!T(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!T(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Pn(this)}function kn(e){xe.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function xn(){Pe.call(this),this.status=1}function Pn(e){this.g=e}(e=Gt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():qe.g(),this.v=this.o?Ce(this.o):Ce(qe),this.g.onreadystatechange=l(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void $t(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Yt,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{en(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){$t(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,fe(this,"complete"),fe(this,"abort"),Zt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zt(this,!0)),Gt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Xt(this):this.bb())},e.bb=function(){Xt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<tn(this)?this.g.status:-1}catch(Ct){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(Ct){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ee(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=sn.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Le(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=En(this,null,this.W),ln(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new We(this,this.j,e);let s=this.o;if(this.S&&(s?(s=P(s),O(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=dn(this,i,t),wt(n=mt(this.I),"RID",e),wt(n,"CVER",22),this.D&&wt(n,"X-HTTP-Session-Id",this.D),hn(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Wt(s)))+"&"+t:this.m&&Ht(n,this.m,s)),ut(this.h,i),this.Ua&&wt(n,"TYPE","init"),this.P?(wt(n,"$req",t),wt(n,"SID","null"),i.T=!0,Ye(i,n,null)):Ye(i,n,t),this.G=2}}else 3==this.G&&(e?un(this,e):0==this.i.length||at(this.h)||un(this))},e.Fa=function(){if(this.u=null,mn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ue(l(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Le(10),an(this),mn(this))},e.Za=function(){null!=this.C&&(this.C=null,an(this),pn(this),Le(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Le(2)):(this.j.info("Failed to ping google.com"),Le(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=Tn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Cn.prototype.g=function(e,t){return new Sn(e,t)},b(Sn,de),Sn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Sn.prototype.close=function(){on(this.g)},Sn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=be(e),e=n);t.i.push(new st(t.Ya++,e)),3==t.G&&ln(t)},Sn.prototype.N=function(){this.g.l=null,delete this.j,on(this.g),delete this.g,Sn.aa.N.call(this)},b(kn,xe),b(xn,Pe),b(Pn,Tn),Pn.prototype.ua=function(){fe(this.g,"a")},Pn.prototype.ta=function(e){fe(this.g,new kn(e))},Pn.prototype.sa=function(e){fe(this.g,new xn)},Pn.prototype.ra=function(){fe(this.g,"b")},Cn.prototype.createWebChannel=Cn.prototype.g,Sn.prototype.send=Sn.prototype.o,Sn.prototype.open=Sn.prototype.m,Sn.prototype.close=Sn.prototype.close,v=w.createWebChannelTransport=function(){return new Cn},_=w.getStatEventTarget=function(){return De()},m=w.Event=Ae,g=w.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ve.NO_ERROR=0,Ve.TIMEOUT=8,Ve.HTTP_ERROR=6,p=w.ErrorCode=Ve,Ke.COMPLETE="complete",f=w.EventType=Ke,Se.EventType=ke,ke.OPEN="a",ke.CLOSE="b",ke.ERROR="c",ke.MESSAGE="d",de.prototype.listen=de.prototype.K,d=w.WebChannel=Se,w.FetchXmlHttpFactory=Bt,Gt.prototype.listenOnce=Gt.prototype.L,Gt.prototype.getLastError=Gt.prototype.Ka,Gt.prototype.getLastErrorCode=Gt.prototype.Ba,Gt.prototype.getStatus=Gt.prototype.Z,Gt.prototype.getResponseJson=Gt.prototype.Oa,Gt.prototype.getResponseText=Gt.prototype.oa,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Ha,h=w.XhrIo=Gt}).apply("undefined"!==typeof y?y:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const b="@firebase/firestore",E="4.7.17";class I{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}I.UNAUTHENTICATED=new I(null),I.GOOGLE_CREDENTIALS=new I("google-credentials-uid"),I.FIRST_PARTY=new I("first-party-uid"),I.MOCK_USER=new I("mock-user");let T="11.9.0";const C=new a.Vy("@firebase/firestore");function S(){return C.logLevel}function k(e){C.setLogLevel(e)}function x(e){if(C.logLevel<=a.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(O);C.debug("Firestore (".concat(T,"): ").concat(e),...i)}}function P(e){if(C.logLevel<=a.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(O);C.error("Firestore (".concat(T,"): ").concat(e),...i)}}function A(e){if(C.logLevel<=a.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(O);C.warn("Firestore (".concat(T,"): ").concat(e),...i)}}function O(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function D(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,R(e,r,n)}function R(e,t,n){let r="FIRESTORE (".concat(T,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw P(r),new Error(r)}function N(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||R(t,i,r)}function M(e,t){e||D(57014,t)}function L(e,t){return e}const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends c.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class j{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class B{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class q{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(I.UNAUTHENTICATED)))}shutdown(){}}class V{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class K{constructor(e){this.t=e,this.currentUser=I.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){N(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new j;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new j,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new j)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(N("string"==typeof t.accessToken,31837,{l:t}),new B(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return N(null===e||"string"==typeof e,2055,{h:e}),new I(e)}}class z{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=I.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class W{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new z(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(I.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class H{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,s._isFirebaseServerApp)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){N(void 0===this.o,3512);const n=e=>{null!=e.error&&x("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,x("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new H(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(N("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new H(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Q(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function Y(){return new TextEncoder}class ${static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Q(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function J(e,t){return e<t?-1:e>t?1:0}function X(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return J(r,i);{const s=Y(),o=ee(s.encode(Z(e,n)),s.encode(Z(t,n)));return 0!==o?o:J(r,i)}}n+=r>65535?2:1}return J(e.length,t.length)}function Z(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function ee(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return J(e[n],t[n]);return J(e.length,t.length)}function te(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function ne(e){return e+"\0"}const re=-62135596800,ie=1e6;class se{static now(){return se.fromMillis(Date.now())}static fromDate(e){return se.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*ie);return new se(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new U(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new U(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<re)throw new U(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ie}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-re;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class oe{static fromTimestamp(e){return new oe(e)}static min(){return new oe(new se(0,0))}static max(){return new oe(new se(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ae="__name__";class ce{constructor(e,t,n){void 0===t?t=0:t>e.length&&D(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&D(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ce.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ce?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=ce.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return J(e.length,t.length)}static compareSegments(e,t){const n=ce.isNumericId(e),r=ce.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?ce.extractNumericId(e).compare(ce.extractNumericId(t)):X(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return r.fromString(e.substring(4,e.length-2))}}class le extends ce{construct(e,t,n){return new le(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new U(F.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter((e=>e.length>0)))}return new le(e)}static emptyPath(){return new le([])}}const ue=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class he extends ce{construct(e,t,n){return new he(e,t,n)}static isValidIdentifier(e){return ue.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),he.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===ae}static keyField(){return new he([ae])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new U(F.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new U(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new U(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new U(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new he(t)}static emptyPath(){return new he([])}}class de{constructor(e){this.path=e}static fromPath(e){return new de(le.fromString(e))}static fromName(e){return new de(le.fromString(e).popFirst(5))}static empty(){return new de(le.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===le.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return le.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new de(new le(e.slice()))}}const fe=-1;class pe{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function ge(e){return e.fields.find((e=>2===e.kind))}function me(e){return e.fields.filter((e=>2!==e.kind))}pe.UNKNOWN_ID=-1;class _e{constructor(e,t){this.fieldPath=e,this.kind=t}}class ve{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ve(0,be.min())}}function ye(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=oe.fromTimestamp(1e9===r?new se(n+1,0):new se(n,r));return new be(i,de.empty(),t)}function we(e){return new be(e.readTime,e.key,fe)}class be{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new be(oe.min(),de.empty(),fe)}static max(){return new be(oe.max(),de.empty(),fe)}}function Ee(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=de.comparator(e.documentKey,t.documentKey),0!==n?n:J(e.largestBatchId,t.largestBatchId))}const Ie="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Te{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ce(e){if(e.code!==F.FAILED_PRECONDITION||e.message!==Ie)throw e;x("LocalStore","Unexpectedly lost primary lease")}class Se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&D(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Se(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Se?t:Se.resolve(t)}catch(e){return Se.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Se.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Se.reject(t)}static resolve(e){return new Se(((t,n)=>{t(e)}))}static reject(e){return new Se(((t,n)=>{n(e)}))}static waitFor(e){return new Se(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=Se.resolve(!1);for(const n of e)t=t.next((e=>e?Se.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new Se(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new Se(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}const ke="SimpleDb";class xe{static open(e,t,n,r){try{return new xe(t,e.transaction(r,n))}catch(e){throw new De(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new j,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new De(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{const n=Fe(t.target.error);this.S.reject(new De(e,n))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(x(ke,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Ne(t)}}class Pe{static delete(e){return x(ke,"Removing database:",e),Me((0,c.mS)().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,c.zW)())return!1;if(Pe.F())return!0;const e=(0,c.ZQ)(),t=Pe.M(e),n=0<t&&t<10,r=Ae(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static F(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.O)}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.B=n,this.L=null,12.2===Pe.M((0,c.ZQ)())&&P("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(x(ke,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new De(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new U(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new U(F.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new De(e,r))},r.onupgradeneeded=e=>{x(ke,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;if(null!==this.L&&this.L!==e.oldVersion)throw new Error('refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion='.concat(this.L,", event.oldVersion=").concat(e.oldVersion,", event.newVersion=").concat(e.newVersion,", db.version=").concat(t.version));this.B.q(t,r.transaction,e.oldVersion,this.version).next((()=>{x(ke,"Database upgrade to version "+this.version+" complete")}))}})),this.db.addEventListener("close",(e=>{const t=e.target;this.L=t.version}),{passive:!0})),this.$&&(this.db.onversionchange=e=>this.$(e)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.k(e);const t=xe.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.v(),e))).catch((e=>(t.abort(e),Se.reject(e)))).toPromise();return s.catch((()=>{})),await t.D,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(x(ke,"Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Ae(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Oe{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return Me(this.K.delete())}}class De extends U{constructor(e,t){super(F.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(t)),this.name="IndexedDbTransactionError"}}function Re(e){return"IndexedDbTransactionError"===e.name}class Ne{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(x(ke,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(x(ke,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Me(n)}add(e){return x(ke,"ADD",this.store.name,e,e),Me(this.store.add(e))}get(e){return Me(this.store.get(e)).next((t=>(void 0===t&&(t=null),x(ke,"GET",this.store.name,e,t),t)))}delete(e){return x(ke,"DELETE",this.store.name,e),Me(this.store.delete(e))}count(){return x(ke,"COUNT",this.store.name),Me(this.store.count())}J(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new Se(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.Y(e,((e,n)=>{t.push(n)})).next((()=>t))}}Z(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Se(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}X(e,t){x(ke,"DELETE ALL",this.store.name);const n=this.options(e,t);n.ee=!1;const r=this.cursor(n);return this.Y(r,((e,t,n)=>n.delete()))}te(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.Y(r,t)}ne(e){const t=this.cursor({});return new Se(((n,r)=>{t.onerror=e=>{const t=Fe(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}Y(e,t){const n=[];return new Se(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new Oe(i),o=t(i.primaryKey,i.value,s);if(o instanceof Se){const e=o.catch((e=>(s.done(),Se.reject(e))));n.push(e)}s.isDone?r():null===s.j?i.continue():i.continue(s.j)}})).next((()=>Se.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.ee?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Me(e){return new Se(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Fe(e.target.error);n(t)}}))}let Le=!1;function Fe(e){const t=Pe.M((0,c.ZQ)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new U("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(t,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Le||(Le=!0,setTimeout((()=>{throw e}),0)),e}}return e}const Ue="IndexBackfiller";class je{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ie(e){x(Ue,"Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const e=await this.re.se();x(Ue,"Documents written: ".concat(e))}catch(e){Re(e)?x(Ue,"Ignoring IndexedDB error during index backfill: ",e):await Ce(e)}await this.ie(6e4)}))}}class Be{constructor(e,t){this.localStore=e,this.persistence=t}async se(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.oe(t,e)))}oe(e,t){const n=new Set;let r=t,i=!0;return Se.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return x(Ue,"Processing collection: ".concat(t)),this._e(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}_e(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.ae(r,n))).next((n=>(x(Ue,"Updating offset: ".concat(n)),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}ae(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=we(t);Ee(r,n)>0&&(n=r)})),new be(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class qe{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ue(e),this.ce=e=>t.writeSequenceNumber(e))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}qe.le=-1;const Ve=-1;function Ke(e){return null==e}function ze(e){return 0===e&&1/e==-1/0}function We(e){return"number"==typeof e&&Number.isInteger(e)&&!ze(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const He="\x01";function Ge(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ye(t)),t=Qe(e.get(n),t);return Ye(t)}function Qe(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case He:n+="\x01\x11";break;default:n+=t}}return n}function Ye(e){return e+He+"\x01"}function $e(e){const t=e.length;if(N(t>=2,64408,{path:e}),2===t)return N(e.charAt(0)===He&&"\x01"===e.charAt(1),56145,{path:e}),le.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf(He,s);switch((t<0||t>n)&&D(50515,{path:e}),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:D(61167,{path:e})}s=t+2}return new le(r)}const Je="remoteDocuments",Xe="owner",Ze="owner",et="mutationQueues",tt="mutations",nt="batchId",rt="userMutationsIndex",it=["userId","batchId"];function st(e,t){return[e,Ge(t)]}function ot(e,t,n){return[e,Ge(t),n]}const at={},ct="documentMutations",lt="remoteDocumentsV14",ut=["prefixPath","collectionGroup","readTime","documentId"],ht="documentKeyIndex",dt=["prefixPath","collectionGroup","documentId"],ft="collectionGroupIndex",pt=["collectionGroup","readTime","prefixPath","documentId"],gt="remoteDocumentGlobal",mt="remoteDocumentGlobalKey",_t="targets",vt="queryTargetsIndex",yt=["canonicalId","targetId"],wt="targetDocuments",bt=["targetId","path"],Et="documentTargetsIndex",It=["path","targetId"],Tt="targetGlobalKey",Ct="targetGlobal",St="collectionParents",kt=["collectionId","parent"],xt="clientMetadata",Pt="bundles",At="namedQueries",Ot="indexConfiguration",Dt="collectionGroupIndex",Rt="indexState",Nt=["indexId","uid"],Mt="sequenceNumberIndex",Lt=["uid","sequenceNumber"],Ft="indexEntries",Ut=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],jt="documentKeyIndex",Bt=["indexId","uid","orderedDocumentKey"],qt="documentOverlays",Vt=["userId","collectionPath","documentId"],Kt="collectionPathOverlayIndex",zt=["userId","collectionPath","largestBatchId"],Wt="collectionGroupOverlayIndex",Ht=["userId","collectionGroup","largestBatchId"],Gt="globals",Qt=[et,tt,ct,Je,_t,Xe,Ct,wt,xt,gt,St,Pt,At],Yt=[...Qt,qt],$t=[et,tt,ct,lt,_t,Xe,Ct,wt,xt,gt,St,Pt,At,qt],Jt=$t,Xt=[...Jt,Ot,Rt,Ft],Zt=Xt,en=[...Xt,Gt],tn=en;class nn extends Te{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function rn(e,t){const n=L(e);return Pe.N(n.he,t)}function sn(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function on(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function an(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class cn{constructor(e,t){this.comparator=e,this.root=t||un.EMPTY}insert(e,t){return new cn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,un.BLACK,null,null))}remove(e){return new cn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,un.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push("".concat(t,":").concat(n)),!1))),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ln(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ln(this.root,e,this.comparator,!1)}getReverseIterator(){return new ln(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ln(this.root,e,this.comparator,!0)}}class ln{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class un{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:un.RED,this.left=null!=r?r:un.EMPTY,this.right=null!=i?i:un.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new un(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return un.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return un.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,un.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,un.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw D(43730,{key:this.key,value:this.value});if(this.right.isRed())throw D(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw D(27949);return e+(this.isRed()?0:1)}}un.EMPTY=null,un.RED=!0,un.BLACK=!1,un.EMPTY=new class{constructor(){this.size=0}get key(){throw D(57766)}get value(){throw D(16141)}get color(){throw D(16727)}get left(){throw D(29726)}get right(){throw D(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new un(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class hn{constructor(e){this.comparator=e,this.data=new cn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new dn(this.data.getIterator())}getIteratorFrom(e){return new dn(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof hn))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new hn(this.comparator);return t.data=e,t}}class dn{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fn(e){return e.hasNext()?e.getNext():void 0}class pn{constructor(e){this.fields=e,e.sort(he.comparator)}static empty(){return new pn([])}unionWith(e){let t=new hn(he.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new pn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return te(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class gn extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function mn(){return"undefined"!=typeof atob}class _n{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new gn("Invalid base64 string: "+e):e}}(e);return new _n(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new _n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const vn=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yn(e){if(N(!!e,39018),"string"==typeof e){let t=0;const n=vn.exec(e);if(N(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:wn(e.seconds),nanos:wn(e.nanos)}}function wn(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function bn(e){return"string"==typeof e?_n.fromBase64String(e):_n.fromUint8Array(e)}const En="server_timestamp",In="__type__",Tn="__previous_value__",Cn="__local_write_time__";function Sn(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[In])||void 0===n?void 0:n.stringValue)===En}function kn(e){const t=e.mapValue.fields[Tn];return Sn(t)?kn(t):t}function xn(e){const t=yn(e.mapValue.fields[Cn].timestampValue);return new se(t.seconds,t.nanos)}class Pn{constructor(e,t,n,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c,this.isUsingEmulator=l}}const An="(default)";class On{constructor(e,t){this.projectId=e,this.database=t||An}static empty(){return new On("","")}get isDefaultDatabase(){return this.database===An}isEqual(e){return e instanceof On&&e.projectId===this.projectId&&e.database===this.database}}const Dn="__type__",Rn="__max__",Nn={mapValue:{fields:{__type__:{stringValue:Rn}}}},Mn="__vector__",Ln="value",Fn={nullValue:"NULL_VALUE"};function Un(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Sn(e)?4:tr(e)?9007199254740991:Zn(e)?10:11:D(28295,{value:e})}function jn(e,t){if(e===t)return!0;const n=Un(e);if(n!==Un(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return xn(e).isEqual(xn(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=yn(e.timestampValue),r=yn(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return bn(e.bytesValue).isEqual(bn(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return wn(e.geoPointValue.latitude)===wn(t.geoPointValue.latitude)&&wn(e.geoPointValue.longitude)===wn(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return wn(e.integerValue)===wn(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=wn(e.doubleValue),r=wn(t.doubleValue);return n===r?ze(n)===ze(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return te(e.arrayValue.values||[],t.arrayValue.values||[],jn);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(sn(n)!==sn(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!jn(n[i],r[i])))return!1;return!0}(e,t);default:return D(52216,{left:e})}}function Bn(e,t){return void 0!==(e.values||[]).find((e=>jn(e,t)))}function qn(e,t){if(e===t)return 0;const n=Un(e),r=Un(t);if(n!==r)return J(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return J(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=wn(e.integerValue||e.doubleValue),r=wn(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Vn(e.timestampValue,t.timestampValue);case 4:return Vn(xn(e),xn(t));case 5:return X(e.stringValue,t.stringValue);case 6:return function(e,t){const n=bn(e),r=bn(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=J(n[i],r[i]);if(0!==e)return e}return J(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=J(wn(e.latitude),wn(t.latitude));return 0!==n?n:J(wn(e.longitude),wn(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Kn(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},c=null===(n=o[Ln])||void 0===n?void 0:n.arrayValue,l=null===(r=a[Ln])||void 0===r?void 0:r.arrayValue,u=J((null===(i=null==c?void 0:c.values)||void 0===i?void 0:i.length)||0,(null===(s=null==l?void 0:l.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:Kn(c,l)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Nn.mapValue&&t===Nn.mapValue)return 0;if(e===Nn.mapValue)return 1;if(t===Nn.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=X(r[o],s[o]);if(0!==e)return e;const t=qn(n[r[o]],i[s[o]]);if(0!==t)return t}return J(r.length,s.length)}(e.mapValue,t.mapValue);default:throw D(23264,{Pe:n})}}function Vn(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return J(e,t);const n=yn(e),r=yn(t),i=J(n.seconds,r.seconds);return 0!==i?i:J(n.nanos,r.nanos)}function Kn(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=qn(n[i],r[i]);if(e)return e}return J(n.length,r.length)}function zn(e){return Wn(e)}function Wn(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=yn(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return bn(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return de.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Wn(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(Wn(e.fields[i]));return n+"}"}(e.mapValue):D(61005,{value:e})}function Hn(e){switch(Un(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=kn(e);return t?16+Hn(t):16;case 5:return 2*e.stringValue.length;case 6:return bn(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+Hn(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return on(e.fields,((e,n)=>{t+=e.length+Hn(n)})),t}(e.mapValue);default:throw D(13486,{value:e})}}function Gn(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Qn(e){return!!e&&"integerValue"in e}function Yn(e){return!!e&&"arrayValue"in e}function $n(e){return!!e&&"nullValue"in e}function Jn(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Xn(e){return!!e&&"mapValue"in e}function Zn(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Dn])||void 0===n?void 0:n.stringValue)===Mn}function er(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return on(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=er(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=er(e.arrayValue.values[n]);return t}return Object.assign({},e)}function tr(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Rn}const nr={mapValue:{fields:{[Dn]:{stringValue:Mn},[Ln]:{arrayValue:{}}}}};function rr(e){return"nullValue"in e?Fn:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Gn(On.empty(),de.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?Zn(e)?nr:{mapValue:{}}:D(35942,{value:e})}function ir(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Gn(On.empty(),de.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?nr:"mapValue"in e?Zn(e)?{mapValue:{}}:Nn:D(61959,{value:e})}function sr(e,t){const n=qn(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function or(e,t){const n=qn(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class ar{constructor(e){this.value=e}static empty(){return new ar({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Xn(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=er(t)}setAll(e){let t=he.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=er(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Xn(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return jn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Xn(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){on(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new ar(er(this.value))}}function cr(e){const t=[];return on(e.fields,((e,n)=>{const r=new he([e]);if(Xn(n)){const e=cr(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new pn(t)}class lr{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new lr(e,0,oe.min(),oe.min(),oe.min(),ar.empty(),0)}static newFoundDocument(e,t,n,r){return new lr(e,1,t,oe.min(),n,r,0)}static newNoDocument(e,t){return new lr(e,2,t,oe.min(),oe.min(),ar.empty(),0)}static newUnknownDocument(e,t){return new lr(e,3,t,oe.min(),oe.min(),ar.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(oe.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ar.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ar.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof lr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ur{constructor(e,t){this.position=e,this.inclusive=t}}function hr(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?de.comparator(de.fromName(o.referenceValue),n.key):qn(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function dr(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!jn(e.position[n],t.position[n]))return!1;return!0}class fr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function pr(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class gr{}class mr extends gr{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Sr(e,t,n):"array-contains"===t?new Ar(e,n):"in"===t?new Or(e,n):"not-in"===t?new Dr(e,n):"array-contains-any"===t?new Rr(e,n):new mr(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new kr(e,n):new xr(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(qn(t,this.value)):null!==t&&Un(this.value)===Un(t)&&this.matchesComparison(qn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return D(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _r extends gr{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new _r(e,t)}matches(e){return vr(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.Te||(this.Te=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function vr(e){return"and"===e.op}function yr(e){return"or"===e.op}function wr(e){return br(e)&&vr(e)}function br(e){for(const t of e.filters)if(t instanceof _r)return!1;return!0}function Er(e){if(e instanceof mr)return e.field.canonicalString()+e.op.toString()+zn(e.value);if(wr(e))return e.filters.map((e=>Er(e))).join(",");{const t=e.filters.map((e=>Er(e))).join(",");return"".concat(e.op,"(").concat(t,")")}}function Ir(e,t){return e instanceof mr?function(e,t){return t instanceof mr&&e.op===t.op&&e.field.isEqual(t.field)&&jn(e.value,t.value)}(e,t):e instanceof _r?function(e,t){return t instanceof _r&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&Ir(n,t.filters[r])),!0)}(e,t):void D(19439)}function Tr(e,t){const n=e.filters.concat(t);return _r.create(n,e.op)}function Cr(e){return e instanceof mr?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(zn(e.value))}(e):e instanceof _r?function(e){return e.op.toString()+" {"+e.getFilters().map(Cr).join(" ,")+"}"}(e):"Filter"}class Sr extends mr{constructor(e,t,n){super(e,t,n),this.key=de.fromName(n.referenceValue)}matches(e){const t=de.comparator(e.key,this.key);return this.matchesComparison(t)}}class kr extends mr{constructor(e,t){super(e,"in",t),this.keys=Pr("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class xr extends mr{constructor(e,t){super(e,"not-in",t),this.keys=Pr("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Pr(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>de.fromName(e.referenceValue)))}class Ar extends mr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Yn(t)&&Bn(t.arrayValue,this.value)}}class Or extends mr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Bn(this.value.arrayValue,t)}}class Dr extends mr{constructor(e,t){super(e,"not-in",t)}matches(e){if(Bn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Bn(this.value.arrayValue,t)}}class Rr extends mr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Yn(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Bn(this.value.arrayValue,e)))}}class Nr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Ie=null}}function Mr(e){return new Nr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Lr(e){const t=L(e);if(null===t.Ie){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Er(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Ke(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>zn(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>zn(e))).join(",")),t.Ie=e}return t.Ie}function Fr(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!pr(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Ir(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!dr(e.startAt,t.startAt)&&dr(e.endAt,t.endAt)}function Ur(e){return de.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function jr(e,t){return e.filters.filter((e=>e instanceof mr&&e.field.isEqual(t)))}function Br(e,t,n){let r=Fn,i=!0;for(const s of jr(e,t)){let e=Fn,t=!0;switch(s.op){case"<":case"<=":e=rr(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=Fn}sr({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];sr({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function qr(e,t,n){let r=Nn,i=!0;for(const s of jr(e,t)){let e=Nn,t=!0;switch(s.op){case">=":case">":e=ir(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=Nn}or({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];or({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class Vr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Kr(e,t,n,r,i,s,o,a){return new Vr(e,t,n,r,i,s,o,a)}function zr(e){return new Vr(e)}function Wr(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Hr(e){return null!==e.collectionGroup}function Gr(e){const t=L(e);if(null===t.Ee){t.Ee=[];const e=new Set;for(const i of t.explicitOrderBy)t.Ee.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new hn(he.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ee.push(new fr(r,n))})),e.has(he.keyField().canonicalString())||t.Ee.push(new fr(he.keyField(),n))}return t.Ee}function Qr(e){const t=L(e);return t.de||(t.de=Yr(t,Gr(e))),t.de}function Yr(e,t){if("F"===e.limitType)return Mr(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new fr(e.field,t)}));const n=e.endAt?new ur(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ur(e.startAt.position,e.startAt.inclusive):null;return Mr(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function $r(e,t){const n=e.filters.concat([t]);return new Vr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Jr(e,t,n){return new Vr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Xr(e,t){return Fr(Qr(e),Qr(t))&&e.limitType===t.limitType}function Zr(e){return"".concat(Lr(Qr(e)),"|lt:").concat(e.limitType)}function ei(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((e=>Cr(e))).join(", "),"]")),Ke(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e))).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>zn(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>zn(e))).join(",")),"Target(".concat(t,")")}(Qr(e)),"; limitType=").concat(e.limitType,")")}function ti(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):de.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Gr(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=hr(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Gr(e),t))&&!(e.endAt&&!function(e,t,n){const r=hr(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Gr(e),t))}(e,t)}function ni(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ri(e){return(t,n)=>{let r=!1;for(const i of Gr(e)){const e=ii(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function ii(e,t,n){const r=e.field.isKeyField()?de.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?qn(r,i):D(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return D(19790,{direction:e.dir})}}class si{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){on(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return an(this.inner)}size(){return this.innerSize}}const oi=new cn(de.comparator);function ai(){return oi}const ci=new cn(de.comparator);function li(){let e=ci;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function ui(e){let t=ci;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function hi(){return fi()}function di(){return fi()}function fi(){return new si((e=>e.toString()),((e,t)=>e.isEqual(t)))}const pi=new cn(de.comparator),gi=new hn(de.comparator);function mi(){let e=gi;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const _i=new hn(J);function vi(){return _i}function yi(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ze(t)?"-0":t}}function wi(e){return{integerValue:""+e}}function bi(e,t){return We(t)?wi(t):yi(e,t)}class Ei{constructor(){this._=void 0}}function Ii(e,t,n){return e instanceof Si?function(e,t){const n={fields:{[In]:{stringValue:En},[Cn]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Sn(t)&&(t=kn(t)),t&&(n.fields[Tn]=t),{mapValue:n}}(n,t):e instanceof ki?xi(e,t):e instanceof Pi?Ai(e,t):function(e,t){const n=Ci(e,t),r=Di(n)+Di(e.Re);return Qn(n)&&Qn(e.Re)?wi(r):yi(e.serializer,r)}(e,t)}function Ti(e,t,n){return e instanceof ki?xi(e,t):e instanceof Pi?Ai(e,t):n}function Ci(e,t){return e instanceof Oi?function(e){return Qn(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Si extends Ei{}class ki extends Ei{constructor(e){super(),this.elements=e}}function xi(e,t){const n=Ri(t);for(const r of e.elements)n.some((e=>jn(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Pi extends Ei{constructor(e){super(),this.elements=e}}function Ai(e,t){let n=Ri(t);for(const r of e.elements)n=n.filter((e=>!jn(e,r)));return{arrayValue:{values:n}}}class Oi extends Ei{constructor(e,t){super(),this.serializer=e,this.Re=t}}function Di(e){return wn(e.integerValue||e.doubleValue)}function Ri(e){return Yn(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Ni{constructor(e,t){this.field=e,this.transform=t}}class Mi{constructor(e,t){this.version=e,this.transformResults=t}}class Li{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Li}static exists(e){return new Li(void 0,e)}static updateTime(e){return new Li(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Fi(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ui{}function ji(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Yi(e.key,Li.none()):new zi(e.key,e.data,Li.none());{const n=e.data,r=ar.empty();let i=new hn(he.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Wi(e.key,r,new pn(i.toArray()),Li.none())}}function Bi(e,t,n){e instanceof zi?function(e,t,n){const r=e.value.clone(),i=Gi(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Wi?function(e,t,n){if(!Fi(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Gi(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Hi(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function qi(e,t,n,r){return e instanceof zi?function(e,t,n,r){if(!Fi(e.precondition,t))return n;const i=e.value.clone(),s=Qi(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Wi?function(e,t,n,r){if(!Fi(e.precondition,t))return n;const i=Qi(e.fieldTransforms,r,t),s=t.data;return s.setAll(Hi(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Fi(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Vi(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Ci(r.transform,e||null);null!=i&&(null===n&&(n=ar.empty()),n.set(r.field,i))}return n||null}function Ki(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&te(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof ki&&t instanceof ki||e instanceof Pi&&t instanceof Pi?te(e.elements,t.elements,jn):e instanceof Oi&&t instanceof Oi?jn(e.Re,t.Re):e instanceof Si&&t instanceof Si}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class zi extends Ui{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Wi extends Ui{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Hi(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Gi(e,t,n){const r=new Map;N(e.length===n.length,32656,{Ve:n.length,me:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Ti(o,a,n[i]))}return r}function Qi(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Ii(e,s,t))}return r}class Yi extends Ui{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $i extends Ui{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ji{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Bi(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=qi(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=qi(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=di();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=ji(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(oe.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),mi())}isEqual(e){return this.batchId===e.batchId&&te(this.mutations,e.mutations,((e,t)=>Ki(e,t)))&&te(this.baseMutations,e.baseMutations,((e,t)=>Ki(e,t)))}}class Xi{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){N(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let r=pi;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new Xi(e,t,n,r)}}class Zi{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class es{constructor(e,t){this.count=e,this.unchangedNames=t}}var ts,ns;function rs(e){switch(e){case F.OK:return D(64938);case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0;default:return D(15467,{code:e})}}function is(e){if(void 0===e)return P("GRPC error has no .code"),F.UNKNOWN;switch(e){case ts.OK:return F.OK;case ts.CANCELLED:return F.CANCELLED;case ts.UNKNOWN:return F.UNKNOWN;case ts.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case ts.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case ts.INTERNAL:return F.INTERNAL;case ts.UNAVAILABLE:return F.UNAVAILABLE;case ts.UNAUTHENTICATED:return F.UNAUTHENTICATED;case ts.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case ts.NOT_FOUND:return F.NOT_FOUND;case ts.ALREADY_EXISTS:return F.ALREADY_EXISTS;case ts.PERMISSION_DENIED:return F.PERMISSION_DENIED;case ts.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case ts.ABORTED:return F.ABORTED;case ts.OUT_OF_RANGE:return F.OUT_OF_RANGE;case ts.UNIMPLEMENTED:return F.UNIMPLEMENTED;case ts.DATA_LOSS:return F.DATA_LOSS;default:return D(39323,{code:e})}}(ns=ts||(ts={}))[ns.OK=0]="OK",ns[ns.CANCELLED=1]="CANCELLED",ns[ns.UNKNOWN=2]="UNKNOWN",ns[ns.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ns[ns.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ns[ns.NOT_FOUND=5]="NOT_FOUND",ns[ns.ALREADY_EXISTS=6]="ALREADY_EXISTS",ns[ns.PERMISSION_DENIED=7]="PERMISSION_DENIED",ns[ns.UNAUTHENTICATED=16]="UNAUTHENTICATED",ns[ns.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ns[ns.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ns[ns.ABORTED=10]="ABORTED",ns[ns.OUT_OF_RANGE=11]="OUT_OF_RANGE",ns[ns.UNIMPLEMENTED=12]="UNIMPLEMENTED",ns[ns.INTERNAL=13]="INTERNAL",ns[ns.UNAVAILABLE=14]="UNAVAILABLE",ns[ns.DATA_LOSS=15]="DATA_LOSS";let ss=null;const os=new r([4294967295,4294967295],0);function as(e){const t=Y().encode(e),n=new i;return n.update(t),new Uint8Array(n.digest())}function cs(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new r([n,i],0),new r([s,o],0)]}class ls{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new us("Invalid padding: ".concat(t));if(n<0)throw new us("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new us("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new us("Invalid padding when bitmap length is 0: ".concat(t));this.pe=8*e.length-t,this.ye=r.fromNumber(this.pe)}we(e,t,n){let i=e.add(t.multiply(r.fromNumber(n)));return 1===i.compare(os)&&(i=new r([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.pe)return!1;const t=as(e),[n,r]=cs(t);for(let i=0;i<this.hashCount;i++){const e=this.we(n,r,i);if(!this.be(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new ls(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.pe)return;const t=as(e),[n,r]=cs(t);for(let i=0;i<this.hashCount;i++){const e=this.we(n,r,i);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class us extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class hs{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ds.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new hs(oe.min(),r,new cn(J),ai(),mi())}}class ds{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ds(n,t,mi(),mi(),mi())}}class fs{constructor(e,t,n,r){this.De=e,this.removedTargetIds=t,this.key=n,this.ve=r}}class ps{constructor(e,t){this.targetId=e,this.Ce=t}}class gs{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_n.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class ms{constructor(){this.Fe=0,this.Me=ys(),this.xe=_n.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return 0!==this.Fe}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=mi(),t=mi(),n=mi();return this.Me.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:D(38017,{changeType:i})}})),new ds(this.xe,this.Oe,e,t,n)}Qe(){this.Ne=!1,this.Me=ys()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,N(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class _s{constructor(e){this.ze=e,this.je=new Map,this.He=ai(),this.Je=vs(),this.Ye=vs(),this.Ze=new cn(J)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,(t=>{const n=this.rt(t);switch(e.state){case 0:this.it(t)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(t);break;case 3:this.it(t)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),n.ke(e.resumeToken));break;default:D(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach(((e,n)=>{this.it(n)&&t(n)}))}ot(e){const t=e.targetId,n=e.Ce.count,r=this._t(t);if(r){const i=r.target;if(Ur(i))if(0===n){const e=new de(i.path);this.tt(t,e,lr.newNoDocument(e,oe.min()))}else N(1===n,20013,{expectedCount:n});else{const r=this.ut(t);if(r!==n){const n=this.ct(e),i=n?this.lt(n,e,r):1;if(0!==i){this.st(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,e)}null==ss||ss.ht(function(e,t,n,r,i){var s,o,a,c,l,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(c=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==c?c:0,padding:null!==(u=null===(l=null==d?void 0:d.bits)||void 0===l?void 0:l.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.Ce,this.ze.Pt(),n,i))}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=bn(n).toUint8Array()}catch(e){if(e instanceof gn)return A("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new ls(s,r,i)}catch(e){return A(e instanceof us?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.pe?null:o}lt(e,t,n){return t.Ce.count===n-this.Tt(e,t.targetId)?0:2}Tt(e,t){const n=this.ze.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.ze.Pt(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.tt(t,n,null),r++)})),r}It(e){const t=new Map;this.je.forEach(((n,r)=>{const i=this._t(r);if(i){if(n.current&&Ur(i.target)){const t=new de(i.target.path);this.Et(t).has(r)||this.dt(r,t)||this.tt(r,t,lr.newNoDocument(t,e))}n.Le&&(t.set(r,n.qe()),n.Qe())}}));let n=mi();this.Ye.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this._t(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.He.forEach(((t,n)=>n.setReadTime(e)));const r=new hs(e,t,this.Ze,this.He,n);return this.He=ai(),this.Je=vs(),this.Ye=vs(),this.Ze=new cn(J),r}et(e,t){if(!this.it(e))return;const n=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,n),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,n){if(!this.it(e))return;const r=this.rt(e);this.dt(e,t)?r.$e(t,1):r.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),n&&(this.He=this.He.insert(t,n))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new ms,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new hn(J),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new hn(J),this.Je=this.Je.insert(e,t)),t}it(e){const t=null!==this._t(e);return t||x("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new ms),this.ze.getRemoteKeysForTarget(e).forEach((t=>{this.tt(e,t,null)}))}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function vs(){return new cn(de.comparator)}function ys(){return new cn(de.comparator)}const ws={asc:"ASCENDING",desc:"DESCENDING"},bs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Es={and:"AND",or:"OR"};class Is{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ts(e,t){return e.useProto3Json||Ke(t)?t:{value:t}}function Cs(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ss(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function ks(e,t){return Cs(e,t.toTimestamp())}function xs(e){return N(!!e,49232),oe.fromTimestamp(function(e){const t=yn(e);return new se(t.seconds,t.nanos)}(e))}function Ps(e,t){return As(e,t).canonicalString()}function As(e,t){const n=function(e){return new le(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Os(e){const t=le.fromString(e);return N(Zs(t),10190,{key:t.toString()}),t}function Ds(e,t){return Ps(e.databaseId,t.path)}function Rs(e,t){const n=Os(t);if(n.get(1)!==e.databaseId.projectId)throw new U(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new U(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new de(Fs(n))}function Ns(e,t){return Ps(e.databaseId,t)}function Ms(e){const t=Os(e);return 4===t.length?le.emptyPath():Fs(t)}function Ls(e){return new le(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Fs(e){return N(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Us(e,t,n){return{name:Ds(e,t),fields:n.value.mapValue.fields}}function js(e,t,n){const r=Rs(e,t.name),i=xs(t.updateTime),s=t.createTime?xs(t.createTime):oe.min(),o=new ar({mapValue:{fields:t.fields}}),a=lr.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Bs(e,t){let n;if(t instanceof zi)n={update:Us(e,t.key,t.value)};else if(t instanceof Yi)n={delete:Ds(e,t.key)};else if(t instanceof Wi)n={update:Us(e,t.key,t.data),updateMask:Xs(t.fieldMask)};else{if(!(t instanceof $i))return D(16599,{ft:t.type});n={verify:Ds(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Si)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ki)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Pi)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Oi)return{fieldPath:t.field.canonicalString(),increment:n.Re};throw D(20930,{transform:t.transform})}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:ks(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:D(27497)}(e,t.precondition)),n}function qs(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Li.updateTime(xs(e.updateTime)):void 0!==e.exists?Li.exists(e.exists):Li.none()}(t.currentDocument):Li.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)N("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),n=new Si;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new ki(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Pi(e)}else"increment"in t?n=new Oi(e,t.increment):D(16584,{proto:t});const r=he.fromServerFormat(t.fieldPath);return new Ni(r,n)}(e,t))):[];if(t.update){t.update.name;const i=Rs(e,t.update.name),s=new ar({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new pn(t.map((e=>he.fromServerFormat(e))))}(t.updateMask);return new Wi(i,s,e,n,r)}return new zi(i,s,n,r)}if(t.delete){const r=Rs(e,t.delete);return new Yi(r,n)}if(t.verify){const r=Rs(e,t.verify);return new $i(r,n)}return D(1463,{proto:t})}function Vs(e,t){return{documents:[Ns(e,t.path)]}}function Ks(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ns(e,i);const s=function(e){if(0!==e.length)return Js(_r.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ys(e.field),direction:Hs(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Ts(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{gt:n,parent:i}}function zs(e){let t=Ms(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){N(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ws(e);return t instanceof _r&&wr(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new fr($s(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Ke(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new ur(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new ur(n,t)}(n.endAt)),Kr(t,i,o,s,a,"F",c,l)}function Ws(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=$s(e.unaryFilter.field);return mr.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=$s(e.unaryFilter.field);return mr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=$s(e.unaryFilter.field);return mr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=$s(e.unaryFilter.field);return mr.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return D(61313);default:return D(60726)}}(e):void 0!==e.fieldFilter?function(e){return mr.create($s(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return D(58110);default:return D(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return _r.create(e.compositeFilter.filters.map((e=>Ws(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return D(1026)}}(e.compositeFilter.op))}(e):D(30097,{filter:e})}function Hs(e){return ws[e]}function Gs(e){return bs[e]}function Qs(e){return Es[e]}function Ys(e){return{fieldPath:e.canonicalString()}}function $s(e){return he.fromServerFormat(e.fieldPath)}function Js(e){return e instanceof mr?function(e){if("=="===e.op){if(Jn(e.value))return{unaryFilter:{field:Ys(e.field),op:"IS_NAN"}};if($n(e.value))return{unaryFilter:{field:Ys(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Jn(e.value))return{unaryFilter:{field:Ys(e.field),op:"IS_NOT_NAN"}};if($n(e.value))return{unaryFilter:{field:Ys(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ys(e.field),op:Gs(e.op),value:e.value}}}(e):e instanceof _r?function(e){const t=e.getFilters().map((e=>Js(e)));return 1===t.length?t[0]:{compositeFilter:{op:Qs(e.op),filters:t}}}(e):D(54877,{filter:e})}function Xs(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Zs(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class eo{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:oe.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:oe.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:_n.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new eo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new eo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class to{constructor(e){this.wt=e}}function no(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ro(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Ds(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Cs(e,t.version.toTimestamp()),createTime:Cs(e,t.createTime.toTimestamp())}}(e.wt,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:io(t.version)};else{if(!t.isUnknownDocument())return D(57904,{document:t});r.unknownDocument={path:n.path.toArray(),version:io(t.version)}}return r}function ro(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function io(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function so(e){const t=new se(e.seconds,e.nanoseconds);return oe.fromTimestamp(t)}function oo(e,t){const n=(t.baseMutations||[]).map((t=>qs(e.wt,t)));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map((t=>qs(e.wt,t))),i=se.fromMillis(t.localWriteTimeMs);return new Ji(t.batchId,i,n,r)}function ao(e){const t=so(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?so(e.lastLimboFreeSnapshotVersion):oe.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){const t=e.documents.length;return N(1===t,1966,{count:t}),Qr(zr(Ms(e.documents[0])))}(e.query):function(e){return Qr(zs(e))}(e.query),new eo(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,_n.fromBase64String(e.resumeToken))}function co(e,t){const n=io(t.snapshotVersion),r=io(t.lastLimboFreeSnapshotVersion);let i;i=Ur(t.target)?Vs(e.wt,t.target):Ks(e.wt,t.target).gt;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Lr(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function lo(e){const t=zs({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Jr(t,t.limit,"L"):t}function uo(e,t){return new Zi(t.largestBatchId,qs(e.wt,t.overlayMutation))}function ho(e,t){const n=t.path.lastSegment();return[e,Ge(t.path.popLast()),n]}function fo(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:io(r.readTime),documentKey:Ge(r.documentKey.path),largestBatchId:r.largestBatchId}}class po{getBundleMetadata(e,t){return go(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:so(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return go(e).put(function(e){return{bundleId:e.id,createTime:io(xs(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return mo(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:lo(e.bundledQuery),readTime:so(e.readTime)}}(e)}))}saveNamedQuery(e,t){return mo(e).put(function(e){return{name:e.name,readTime:io(xs(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function go(e){return rn(e,Pt)}function mo(e){return rn(e,At)}class _o{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const n=t.uid||"";return new _o(e,n)}getOverlay(e,t){return vo(e).get(ho(this.userId,t)).next((e=>e?uo(this.serializer,e):null))}getOverlays(e,t){const n=hi();return Se.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new Zi(t,i);r.push(this.St(e,s))})),Se.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(Ge(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(vo(e).X(Kt,r))})),Se.waitFor(i)}getOverlaysForCollection(e,t,n){const r=hi(),i=Ge(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return vo(e).J(Kt,s).next((e=>{for(const t of e){const e=uo(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=hi();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return vo(e).te({index:Wt,range:o},((e,t,n)=>{const o=uo(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}St(e,t){return vo(e).put(function(e,t,n){const[r,i,s]=ho(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Bs(e.wt,n.mutation)}}(this.serializer,this.userId,t))}}function vo(e){return rn(e,qt)}class yo{Dt(e){return rn(e,Gt)}getSessionToken(e){return this.Dt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?_n.fromUint8Array(t):_n.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class wo{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(wn(e.integerValue));else if("doubleValue"in e){const n=wn(e.doubleValue);isNaN(n)?this.Mt(t,13):(this.Mt(t,15),ze(n)?t.xt(0):t.xt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Mt(t,20),"string"==typeof n&&(n=yn(n)),t.Ot("".concat(n.seconds||"")),t.xt(n.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(bn(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Mt(t,45),t.xt(n.latitude||0),t.xt(n.longitude||0)}else"mapValue"in e?tr(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):Zn(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):D(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const n=e.fields||{};this.Mt(t,55);for(const r of Object.keys(n))this.Nt(r,t),this.Ct(n[r],t)}qt(e,t){var n,r;const i=e.fields||{};this.Mt(t,53);const s=Ln,o=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.Mt(t,15),t.xt(wn(o)),this.Nt(s,t),this.Ct(i[s],t)}$t(e,t){const n=e.values||[];this.Mt(t,50);for(const r of n)this.Ct(r,t)}kt(e,t){this.Mt(t,37),de.fromName(e).path.forEach((e=>{this.Mt(t,60),this.Kt(e,t)}))}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}wo.Wt=new wo;const bo=255;function Eo(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function Io(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Eo(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}class To{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.zt(n.value),n=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Yt()}Zt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.zt(e);else if(e<2048)this.zt(960|e>>>6),this.zt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.zt(480|e>>>12),this.zt(128|63&e>>>6),this.zt(128|63&e);else{const e=t.codePointAt(0);this.zt(240|e>>>18),this.zt(128|63&e>>>12),this.zt(128|63&e>>>6),this.zt(128|63&e)}}this.jt()}Xt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Jt(e);else if(e<2048)this.Jt(960|e>>>6),this.Jt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Jt(480|e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e);else{const e=t.codePointAt(0);this.Jt(240|e>>>18),this.Jt(128|63&e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e)}}this.Yt()}en(e){const t=this.tn(e),n=Io(t);this.nn(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}rn(e){const t=this.tn(e),n=Io(t);this.nn(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}sn(){this._n(bo),this._n(255)}an(){this.un(bo),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}zt(e){const t=255&e;0===t?(this._n(0),this._n(255)):t===bo?(this._n(bo),this._n(0)):this._n(t)}Jt(e){const t=255&e;0===t?(this.un(0),this.un(255)):t===bo?(this.un(bo),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Co{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class So{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class ko{constructor(){this.ln=new To,this.hn=new Co(this.ln),this.Pn=new So(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return 0===e?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}class xo{constructor(e,t,n,r){this.In=e,this.En=t,this.dn=n,this.An=r}Rn(){const e=this.An.length,t=0===e||255===this.An[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.An,0),t!==e?n.set([0],this.An.length):++n[n.length-1],new xo(this.In,this.En,this.dn,n)}Vn(e,t,n){return{indexId:this.In,uid:e,arrayValue:Oo(this.dn),directionalValue:Oo(this.An),orderedDocumentKey:Oo(t),documentKey:n.path.toArray()}}mn(e,t,n){const r=this.Vn(e,t,n);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Po(e,t){let n=e.In-t.In;return 0!==n?n:(n=Ao(e.dn,t.dn),0!==n?n:(n=Ao(e.An,t.An),0!==n?n:de.comparator(e.En,t.En)))}function Ao(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}function Oo(e){return(0,c.Ov)()?function(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}(e):e}function Do(e){return"string"!=typeof e?e:function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e)}class Ro{constructor(e){this.fn=new hn(((e,t)=>he.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const e=t;e.isInequality()?this.fn=this.fn.add(e):this.pn.push(e)}}get yn(){return this.fn.size>1}wn(e){if(N(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=ge(e);if(void 0!==t&&!this.bn(t))return!1;const n=me(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.bn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.fn.size>0){const e=this.fn.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.Sn(e,t)||!this.Dn(this.gn[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.gn.length||!this.Dn(this.gn[s++],e))return!1}return!0}vn(){if(this.yn)return null;let e=new hn(he.comparator);const t=[];for(const n of this.pn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new _e(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new _e(n.field,0))}for(const n of this.gn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new _e(n.field,"asc"===n.dir?0:1)));return new pe(pe.UNKNOWN_ID,this.collectionId,t,ve.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function No(e){var t,n;if(N(e instanceof mr||e instanceof _r,20012),e instanceof mr){if(e instanceof Or){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>mr.create(e.field,"==",t))))||[];return _r.create(r,"or")}return e}const r=e.filters.map((e=>No(e)));return _r.create(r,e.op)}function Mo(e){if(0===e.getFilters().length)return[];const t=jo(No(e));return N(Uo(t),7391),Lo(t)||Fo(t)?[t]:t.getFilters()}function Lo(e){return e instanceof mr}function Fo(e){return e instanceof _r&&wr(e)}function Uo(e){return Lo(e)||Fo(e)||function(e){if(e instanceof _r&&yr(e)){for(const t of e.getFilters())if(!Lo(t)&&!Fo(t))return!1;return!0}return!1}(e)}function jo(e){if(N(e instanceof mr||e instanceof _r,34018),e instanceof mr)return e;if(1===e.filters.length)return jo(e.filters[0]);const t=e.filters.map((e=>jo(e)));let n=_r.create(t,e.op);return n=Vo(n),Uo(n)?n:(N(n instanceof _r,64498),N(vr(n),40251),N(n.filters.length>1,57927),n.filters.reduce(((e,t)=>Bo(e,t))))}function Bo(e,t){let n;return N(e instanceof mr||e instanceof _r,38388),N(t instanceof mr||t instanceof _r,25473),n=e instanceof mr?t instanceof mr?function(e,t){return _r.create([e,t],"and")}(e,t):qo(e,t):t instanceof mr?qo(t,e):function(e,t){if(N(e.filters.length>0&&t.filters.length>0,48005),vr(e)&&vr(t))return Tr(e,t.getFilters());const n=yr(e)?e:t,r=yr(e)?t:e,i=n.filters.map((e=>Bo(e,r)));return _r.create(i,"or")}(e,t),Vo(n)}function qo(e,t){if(vr(t))return Tr(t,e.getFilters());{const n=t.filters.map((t=>Bo(e,t)));return _r.create(n,"or")}}function Vo(e){if(N(e instanceof mr||e instanceof _r,11850),e instanceof mr)return e;const t=e.getFilters();if(1===t.length)return Vo(t[0]);if(br(e))return e;const n=t.map((e=>Vo(e))),r=[];return n.forEach((t=>{t instanceof mr?r.push(t):t instanceof _r&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:_r.create(r,e.op)}class Ko{constructor(){this.Cn=new zo}addToCollectionParentIndex(e,t){return this.Cn.add(t),Se.resolve()}getCollectionParents(e,t){return Se.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Se.resolve()}deleteFieldIndex(e,t){return Se.resolve()}deleteAllFieldIndexes(e){return Se.resolve()}createTargetIndexes(e,t){return Se.resolve()}getDocumentsMatchingTarget(e,t){return Se.resolve(null)}getIndexType(e,t){return Se.resolve(0)}getFieldIndexes(e,t){return Se.resolve([])}getNextCollectionGroupToUpdate(e){return Se.resolve(null)}getMinOffset(e,t){return Se.resolve(be.min())}getMinOffsetFromCollectionGroup(e,t){return Se.resolve(be.min())}updateCollectionGroup(e,t,n){return Se.resolve()}updateIndexEntries(e,t){return Se.resolve()}}class zo{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new hn(le.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new hn(le.comparator)).toArray()}}const Wo="IndexedDbIndexManager",Ho=new Uint8Array(0);class Go{constructor(e,t){this.databaseId=t,this.Fn=new zo,this.Mn=new si((e=>Lr(e)),((e,t)=>Fr(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.Fn.add(t)}));const i={collectionId:n,parent:Ge(r)};return Qo(e).put(i)}return Se.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[ne(t),""],!1,!0);return Qo(e).J(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push($e(r.parent))}return n}))}addFieldIndex(e,t){const n=$o(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Jo(e);return i.next((e=>{n.put(fo(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=$o(e),r=Jo(e),i=Yo(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=$o(e),n=Yo(e),r=Jo(e);return t.X().next((()=>n.X())).next((()=>r.X()))}createTargetIndexes(e,t){return Se.forEach(this.xn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new Ro(t).vn();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Yo(e);let r=!0;const i=new Map;return Se.forEach(this.xn(t),(t=>this.On(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=mi();const r=[];return Se.forEach(i,((i,s)=>{x(Wo,"Using index ".concat(function(e){return"id=".concat(e.indexId,"|cg=").concat(e.collectionGroup,"|f=").concat(e.fields.map((e=>"".concat(e.fieldPath,":").concat(e.kind))).join(","))}(i)," to execute ").concat(Lr(t)));const o=function(e,t){const n=ge(t);if(void 0===n)return null;for(const r of jr(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of me(t))for(const t of jr(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of me(t)){const t=0===i.kind?Br(e,i.fieldPath,e.startAt):qr(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new ur(n,r)}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of me(t)){const t=0===i.kind?qr(e,i.fieldPath,e.endAt):Br(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new ur(n,r)}(s,i),u=this.Nn(i,s,c),h=this.Nn(i,s,l),d=this.Bn(i,s,a),f=this.Ln(i.indexId,o,u,c.inclusive,h,l.inclusive,d);return Se.forEach(f,(i=>n.Z(i,t.limit).next((t=>{t.forEach((t=>{const n=de.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return Se.resolve(null)}))}xn(e){let t=this.Mn.get(e);return t||(t=0===e.filters.length?[e]:Mo(_r.create(e.filters,"and")).map((t=>Mr(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.Mn.set(e,t),t)}Ln(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),c=a/(null!=t?t.length:1),l=[];for(let u=0;u<a;++u){const a=t?this.kn(t[u/c]):Ho,h=this.qn(e,a,n[u%c],r),d=this.Qn(e,a,i[u%c],s),f=o.map((t=>this.qn(e,a,t,!0)));l.push(...this.createRange(h,d,f))}return l}qn(e,t,n,r){const i=new xo(e,de.empty(),t,n);return r?i:i.Rn()}Qn(e,t,n,r){const i=new xo(e,de.empty(),t,n);return r?i.Rn():i}On(e,t){const n=new Ro(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.wn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.xn(t);return Se.forEach(r,(t=>this.On(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new hn(he.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}$n(e,t){const n=new ko;for(const r of me(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Tn(r.kind);wo.Wt.vt(e,i)}return n.cn()}kn(e){const t=new ko;return wo.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const n=new ko;return wo.Wt.vt(Gn(this.databaseId,t),n.Tn(function(e){const t=me(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.cn()}Bn(e,t,n){if(null===n)return[];let r=[];r.push(new ko);let i=0;for(const s of me(e)){const e=n[i++];for(const n of r)if(this.Kn(t,s.fieldPath)&&Yn(e))r=this.Wn(r,s,e);else{const t=n.Tn(s.kind);wo.Wt.vt(e,t)}}return this.Gn(r)}Nn(e,t,n){return this.Bn(e,t,n.position)}Gn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].cn();return t}Wn(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new ko;n.seed(e.cn()),wo.Wt.vt(s,n.Tn(t.kind)),i.push(n)}return i}Kn(e,t){return!!e.filters.find((e=>e instanceof mr&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=$o(e),r=Jo(e);return(t?n.J(Dt,IDBKeyRange.bound(t,t)):n.J()).next((e=>{const t=[];return Se.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new ve(t.sequenceNumber,new be(so(t.readTime),new de($e(t.documentKey)),t.largestBatchId)):ve.empty(),r=e.fields.map((e=>{let[t,n]=e;return new _e(he.fromServerFormat(t),n)}));return new pe(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:J(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=$o(e),i=Jo(e);return this.zn(e).next((e=>r.J(Dt,IDBKeyRange.bound(t,t)).next((t=>Se.forEach(t,(t=>i.put(fo(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return Se.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?Se.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),Se.forEach(i,(n=>this.jn(e,t,n).next((t=>{const i=this.Hn(r,n);return t.isEqual(i)?Se.resolve():this.Jn(e,r,n,t,i)})))))))}))}Yn(e,t,n,r){return Yo(e).put(r.Vn(this.uid,this.Un(n,t.key),t.key))}Zn(e,t,n,r){return Yo(e).delete(r.mn(this.uid,this.Un(n,t.key),t.key))}jn(e,t,n){const r=Yo(e);let i=new hn(Po);return r.te({index:jt,range:IDBKeyRange.only([n.indexId,this.uid,Oo(this.Un(n,t))])},((e,r)=>{i=i.add(new xo(n.indexId,t,Do(r.arrayValue),Do(r.directionalValue)))})).next((()=>i))}Hn(e,t){let n=new hn(Po);const r=this.$n(t,e);if(null==r)return n;const i=ge(t);if(null!=i){const s=e.data.field(i.fieldPath);if(Yn(s))for(const i of s.arrayValue.values||[])n=n.add(new xo(t.indexId,e.key,this.kn(i),r))}else n=n.add(new xo(t.indexId,e.key,Ho,r));return n}Jn(e,t,n,r,i){x(Wo,"Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=fn(s),c=fn(o);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=fn(o)):t?(i(a),a=fn(s)):(a=fn(s),c=fn(o))}}(r,i,Po,(r=>{s.push(this.Yn(e,t,n,r))}),(r=>{s.push(this.Zn(e,t,n,r))})),Se.waitFor(s)}zn(e){let t=1;return Jo(e).te({index:Mt,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>Po(e,t))).filter(((e,t,n)=>!t||0!==Po(e,n[t-1])));const r=[];r.push(e);for(const s of n){const n=Po(s,e),i=Po(s,t);if(0===n)r[0]=e.Rn();else if(n>0&&i<0)r.push(s),r.push(s.Rn());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.Xn(r[s],r[s+1]))return[];const e=r[s].mn(this.uid,Ho,de.empty()),t=r[s+1].mn(this.uid,Ho,de.empty());i.push(IDBKeyRange.bound(e,t))}return i}Xn(e,t){return Po(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Xo)}getMinOffset(e,t){return Se.mapArray(this.xn(t),(t=>this.On(e,t).next((e=>e||D(44426))))).next(Xo)}}function Qo(e){return rn(e,St)}function Yo(e){return rn(e,Ft)}function $o(e){return rn(e,Ot)}function Jo(e){return rn(e,Rt)}function Xo(e){N(0!==e.length,28825);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;Ee(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new be(t.readTime,t.documentKey,n)}const Zo={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ea=41943040;class ta{static withCacheSize(e){return new ta(e,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function na(e,t,n){const r=e.store(tt),i=e.store(ct),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.te({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{N(1===a,47070,{batchId:n.batchId})})));const l=[];for(const u of n.mutations){const e=ot(t,u.key.path,n.batchId);s.push(i.delete(e)),l.push(u.key)}return Se.waitFor(s).next((()=>l))}function ra(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw D(14731);t=e.noDocument}return JSON.stringify(t).length}ta.DEFAULT_COLLECTION_PERCENTILE=10,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ta.DEFAULT=new ta(ea,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ta.DISABLED=new ta(-1,0,0);class ia{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.er={}}static bt(e,t,n,r){N(""!==e.uid,64387);const i=e.isAuthenticated()?e.uid:"";return new ia(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return oa(e).te({index:rt,range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=aa(e),s=oa(e);return s.add({}).next((o=>{N("number"==typeof o,49019);const a=new Ji(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>Bs(e.wt,t))),i=n.mutations.map((t=>Bs(e.wt,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),l=[];let u=new hn(((e,t)=>J(e.canonicalString(),t.canonicalString())));for(const e of r){const t=ot(this.userId,e.key.path,o);u=u.add(e.key.path.popLast()),l.push(s.put(c)),l.push(i.put(t,at))}return u.forEach((t=>{l.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.er[o]=a.keys()})),Se.waitFor(l).next((()=>a))}))}lookupMutationBatch(e,t){return oa(e).get(t).next((e=>e?(N(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),oo(this.serializer,e)):null))}tr(e,t){return this.er[t]?Se.resolve(this.er[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.er[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return oa(e).te({index:rt,range:r},((e,t,r)=>{t.userId===this.userId&&(N(t.batchId>=n,47524,{nr:n}),i=oo(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Ve;return oa(e).te({index:rt,range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ve],[this.userId,Number.POSITIVE_INFINITY]);return oa(e).J(rt,t).next((e=>e.map((e=>oo(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=st(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return aa(e).te({range:r},((n,r,s)=>{const[o,a,c]=n,l=$e(a);if(o===this.userId&&t.path.isEqual(l))return oa(e).get(c).next((e=>{if(!e)throw D(61480,{rr:n,batchId:c});N(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:c}),i.push(oo(this.serializer,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new hn(J);const r=[];return t.forEach((t=>{const i=st(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=aa(e).te({range:s},((e,r,i)=>{const[s,o,a]=e,c=$e(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),Se.waitFor(r).next((()=>this.ir(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=st(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new hn(J);return aa(e).te({range:s},((e,t,i)=>{const[s,a,c]=e,l=$e(a);s===this.userId&&n.isPrefixOf(l)?l.length===r&&(o=o.add(c)):i.done()})).next((()=>this.ir(e,o)))}ir(e,t){const n=[],r=[];return t.forEach((t=>{r.push(oa(e).get(t).next((e=>{if(null===e)throw D(35274,{batchId:t});N(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),n.push(oo(this.serializer,e))})))})),Se.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return na(e.he,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.sr(t.batchId)})),Se.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Se.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return aa(e).te({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=$e(e[1]);r.push(t)}else n.done()})).next((()=>{N(0===r.length,56720,{_r:r.map((e=>e.canonicalString()))})}))}))}containsKey(e,t){return sa(e,this.userId,t)}ar(e){return ca(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:Ve,lastStreamToken:""}))}}function sa(e,t,n){const r=st(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return aa(e).te({range:s,ee:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function oa(e){return rn(e,tt)}function aa(e){return rn(e,ct)}function ca(e){return rn(e,et)}class la{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new la(0)}static lr(){return new la(-1)}}class ua{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next((t=>{const n=new la(t.highestTargetId);return t.highestTargetId=n.next(),this.Pr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.hr(e).next((e=>oe.fromTimestamp(new se(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.hr(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.hr(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Pr(e,r))))}addTargetData(e,t){return this.Tr(e,t).next((()=>this.hr(e).next((n=>(n.targetCount+=1,this.Ir(t,n),this.Pr(e,n))))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>ha(e).delete(t.targetId))).next((()=>this.hr(e))).next((t=>(N(t.targetCount>0,8065),t.targetCount-=1,this.Pr(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return ha(e).te(((s,o)=>{const a=ao(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>Se.waitFor(i))).next((()=>r))}forEachTarget(e,t){return ha(e).te(((e,n)=>{const r=ao(n);t(r)}))}hr(e){return da(e).get(Tt).next((e=>(N(null!==e,2888),e)))}Pr(e,t){return da(e).put(Tt,t)}Tr(e,t){return ha(e).put(co(this.serializer,t))}Ir(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.hr(e).next((e=>e.targetCount))}getTargetData(e,t){const n=Lr(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return ha(e).te({range:r,index:vt},((e,n,r)=>{const s=ao(n);Fr(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=fa(e);return t.forEach((t=>{const s=Ge(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),Se.waitFor(r)}removeMatchingKeys(e,t,n){const r=fa(e);return Se.forEach(t,(t=>{const i=Ge(t.path);return Se.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=fa(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=fa(e);let i=mi();return r.te({range:n,ee:!0},((e,t,n)=>{const r=$e(e[1]),s=new de(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=Ge(t.path),r=IDBKeyRange.bound([n],[ne(n)],!1,!0);let i=0;return fa(e).te({index:Et,ee:!0,range:r},((e,t,n)=>{let[r,s]=e;0!==r&&(i++,n.done())})).next((()=>i>0))}Rt(e,t){return ha(e).get(t).next((e=>e?ao(e):null))}}function ha(e){return rn(e,_t)}function da(e){return rn(e,Ct)}function fa(e){return rn(e,wt)}const pa="LruGarbageCollector",ga=1048576;function ma(e,t){let[n,r]=e,[i,s]=t;const o=J(n,i);return 0===o?J(r,s):o}class _a{constructor(e){this.Er=e,this.buffer=new hn(ma),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();ma(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class va{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Vr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return null!==this.Vr}mr(e){x(pa,"Garbage collection scheduled in ".concat(e,"ms")),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Re(e)?x(pa,"Ignoring IndexedDB error during garbage collection: ",e):await Ce(e)}await this.mr(3e5)}))}}class ya{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return Se.resolve(qe.le);const n=new _a(t);return this.gr.forEachTarget(e,(e=>n.Rr(e.sequenceNumber))).next((()=>this.gr.yr(e,(e=>n.Rr(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.gr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(x("LruGarbageCollector","Garbage collection skipped; disabled"),Se.resolve(Zo)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(x("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),Zo):this.wr(e,t)))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let n,r,i,s,o,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(x("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),S()<=a.$b.DEBUG&&x("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-u,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-s)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(c-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(l-c)+"ms\n"+"Total Duration: ".concat(l-u,"ms")),Se.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function wa(e,t){return new ya(e,t)}class ba{constructor(e,t){this.db=e,this.garbageCollector=wa(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}br(e){let t=0;return this.yr(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,((e,n)=>t(n)))}addReference(e,t,n){return Ea(e,n)}removeReference(e,t,n){return Ea(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Ea(e,t)}Dr(e,t){return function(e,t){let n=!1;return ca(e).ne((r=>sa(e,r,t).next((e=>(e&&(n=!0),Se.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Sr(e,((s,o)=>{if(o<=t){const t=this.Dr(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,oe.min()),fa(e).delete(function(e){return[0,Ge(e.path)]}(s)))))}));r.push(t)}})).next((()=>Se.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Ea(e,t)}Sr(e,t){const n=fa(e);let r,i=qe.le;return n.te({index:Et},((e,n)=>{let[s,o]=e,{path:a,sequenceNumber:c}=n;0===s?(i!==qe.le&&t(new de($e(r)),i),i=c,r=a):i=qe.le})).next((()=>{i!==qe.le&&t(new de($e(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ea(e,t){return fa(e).put(function(e,t){return{targetId:0,path:Ge(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class Ia{constructor(){this.changes=new si((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,lr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Se.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ta{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return xa(e).put(n)}removeEntry(e,t,n){return xa(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],ro(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.vr(e,n))))}getEntry(e,t){let n=lr.newInvalidDocument(t);return xa(e).te({index:ht,range:IDBKeyRange.only(Pa(t))},((e,r)=>{n=this.Cr(t,r)})).next((()=>n))}Fr(e,t){let n={size:0,document:lr.newInvalidDocument(t)};return xa(e).te({index:ht,range:IDBKeyRange.only(Pa(t))},((e,r)=>{n={document:this.Cr(t,r),size:ra(r)}})).next((()=>n))}getEntries(e,t){let n=ai();return this.Mr(e,t,((e,t)=>{const r=this.Cr(e,t);n=n.insert(e,r)})).next((()=>n))}Or(e,t){let n=ai(),r=new cn(de.comparator);return this.Mr(e,t,((e,t)=>{const i=this.Cr(e,t);n=n.insert(e,i),r=r.insert(e,ra(t))})).next((()=>({documents:n,Nr:r})))}Mr(e,t,n){if(t.isEmpty())return Se.resolve();let r=new hn(Oa);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(Pa(r.first()),Pa(r.last())),s=r.getIterator();let o=s.getNext();return xa(e).te({index:ht,range:i},((e,t,r)=>{const i=de.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&Oa(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.H(Pa(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),ro(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xa(e).J(IDBKeyRange.bound(o,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=ai();for(const i of e){const e=this.Cr(de.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(ti(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=ai();const s=Aa(t,n),o=Aa(t,be.max());return xa(e).te({index:ft,range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.Cr(de.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new Sa(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return ka(e).get(mt).next((e=>(N(!!e,20021),e)))}vr(e,t){return ka(e).put(mt,t)}Cr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=js(e.wt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=de.fromSegments(t.noDocument.path),r=so(t.noDocument.readTime);n=lr.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return D(56709);{const e=de.fromSegments(t.unknownDocument.path),r=so(t.unknownDocument.version);n=lr.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new se(e[0],e[1]);return oe.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(oe.min()))return e}return lr.newInvalidDocument(e)}}function Ca(e){return new Ta(e)}class Sa extends Ia{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new si((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new hn(((e,t)=>J(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.Lr.get(i);if(t.push(this.Br.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=no(this.Br.serializer,s);r=r.add(i.path.popLast());const c=ra(a);n+=c-o.size,t.push(this.Br.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=no(this.Br.serializer,s.convertToNoDocument(oe.min()));t.push(this.Br.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.Br.updateMetadata(e,n)),Se.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next((e=>(this.Lr.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.Br.Or(e,t).next((e=>{let{documents:t,Nr:n}=e;return n.forEach(((e,n)=>{this.Lr.set(e,{size:n,readTime:t.get(e).readTime})})),t}))}}function ka(e){return rn(e,gt)}function xa(e){return rn(e,lt)}function Pa(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Aa(e,t){const n=t.documentKey.path.toArray();return[e,ro(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Oa(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=J(n[s],r[s]),i)return i;return i=J(n.length,r.length),i||(i=J(n[n.length-2],r[r.length-2]),i||J(n[n.length-1],r[r.length-1]))}class Da{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ra{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&qi(n.mutation,e,pn.empty(),se.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,mi()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mi();const r=hi();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=li();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=hi();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,mi())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=ai();const s=fi(),o=fi();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Wi)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),qi(o.mutation,t,o.mutation.getFieldMask(),se.now())):s.set(t.key,pn.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Da(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=fi();let r=new cn(((e,t)=>e-t)),i=mi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||pn.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||mi()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,l=di();c.forEach((e=>{if(!i.has(e)){const r=ji(t.get(e),n.get(e));null!==r&&l.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,l))}return Se.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return de.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Hr(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Se.resolve(hi());let o=fe,a=i;return s.next((t=>Se.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Se.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,mi()))).next((e=>({batchId:o,changes:ui(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new de(t)).next((e=>{let t=li();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=li();return this.indexManager.getCollectionParents(e,i).next((o=>Se.forEach(o,(o=>{const a=function(e,t){return new Vr(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,lr.newInvalidDocument(r)))}));let n=li();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&qi(s.mutation,r,pn.empty(),se.now()),ti(t,r)&&(n=n.insert(e,r))})),n}))}}class Na{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return Se.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:xs(e.createTime)}}(t)),Se.resolve()}getNamedQuery(e,t){return Se.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(e){return{name:e.name,query:lo(e.bundledQuery),readTime:xs(e.readTime)}}(t)),Se.resolve()}}class Ma{constructor(){this.overlays=new cn(de.comparator),this.Qr=new Map}getOverlay(e,t){return Se.resolve(this.overlays.get(t))}getOverlays(e,t){const n=hi();return Se.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.St(e,t,r)})),Se.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Qr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Qr.delete(n)),Se.resolve()}getOverlaysForCollection(e,t,n){const r=hi(),i=t.length+1,s=new de(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Se.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new cn(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=hi(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=hi(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return Se.resolve(o)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Qr.get(r.largestBatchId).delete(n.key);this.Qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Zi(t,n));let i=this.Qr.get(t);void 0===i&&(i=mi(),this.Qr.set(t,i)),this.Qr.set(t,i.add(n.key))}}class La{constructor(){this.sessionToken=_n.EMPTY_BYTE_STRING}getSessionToken(e){return Se.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Se.resolve()}}class Fa{constructor(){this.$r=new hn(Ua.Ur),this.Kr=new hn(Ua.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const n=new Ua(e,t);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.zr(new Ua(e,t))}jr(e,t){e.forEach((e=>this.removeReference(e,t)))}Hr(e){const t=new de(new le([])),n=new Ua(t,e),r=new Ua(t,e+1),i=[];return this.Kr.forEachInRange([n,r],(e=>{this.zr(e),i.push(e.key)})),i}Jr(){this.$r.forEach((e=>this.zr(e)))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new de(new le([])),n=new Ua(t,e),r=new Ua(t,e+1);let i=mi();return this.Kr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new Ua(e,0),n=this.$r.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ua{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return de.comparator(e.key,t.key)||J(e.Zr,t.Zr)}static Wr(e,t){return J(e.Zr,t.Zr)||de.comparator(e.key,t.key)}}class ja{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new hn(Ua.Ur)}checkEmpty(e){return Se.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Ji(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Xr=this.Xr.add(new Ua(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Se.resolve(s)}lookupMutationBatch(e,t){return Se.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ti(n),i=r<0?0:r;return Se.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Se.resolve(0===this.mutationQueue.length?Ve:this.nr-1)}getAllMutationBatches(e){return Se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ua(t,0),r=new Ua(t,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([n,r],(e=>{const t=this.ei(e.Zr);i.push(t)})),Se.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new hn(J);return t.forEach((e=>{const t=new Ua(e,0),r=new Ua(e,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([t,r],(e=>{n=n.add(e.Zr)}))})),Se.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;de.isDocumentKey(i)||(i=i.child(""));const s=new Ua(new de(i),0);let o=new hn(J);return this.Xr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Zr)),!0)}),s),Se.resolve(this.ni(o))}ni(e){const t=[];return e.forEach((e=>{const n=this.ei(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){N(0===this.ri(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Xr;return Se.forEach(t.mutations,(r=>{const i=new Ua(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Xr=n}))}sr(e){}containsKey(e,t){const n=new Ua(t,0),r=this.Xr.firstAfterOrEqual(n);return Se.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Se.resolve()}ri(e,t){return this.ti(e)}ti(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Ba{constructor(e){this.ii=e,this.docs=new cn(de.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ii(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Se.resolve(n?n.document.mutableCopy():lr.newInvalidDocument(t))}getEntries(e,t){let n=ai();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():lr.newInvalidDocument(e))})),Se.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=ai();const s=t.path,o=new de(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Ee(we(o),n)<=0||(r.has(o.key)||ti(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Se.resolve(i)}getAllFromCollectionGroup(e,t,n,r){D(9500)}si(e,t){return Se.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new qa(this)}getSize(e){return Se.resolve(this.size)}}class qa extends Ia{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Br.addEntry(e,r)):this.Br.removeEntry(n)})),Se.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}class Va{constructor(e){this.persistence=e,this.oi=new si((e=>Lr(e)),Fr),this.lastRemoteSnapshotVersion=oe.min(),this.highestTargetId=0,this._i=0,this.ai=new Fa,this.targetCount=0,this.ui=la.cr()}forEachTarget(e,t){return this.oi.forEach(((e,n)=>t(n))),Se.resolve()}getLastRemoteSnapshotVersion(e){return Se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Se.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),Se.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this._i&&(this._i=t),Se.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new la(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,Se.resolve()}updateTargetData(e,t){return this.Tr(t),Se.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,Se.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.oi.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.oi.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Se.waitFor(i).next((()=>r))}getTargetCount(e){return Se.resolve(this.targetCount)}getTargetData(e,t){const n=this.oi.get(t)||null;return Se.resolve(n)}addMatchingKeys(e,t,n){return this.ai.Gr(t,n),Se.resolve()}removeMatchingKeys(e,t,n){this.ai.jr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),Se.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),Se.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ai.Yr(t);return Se.resolve(n)}containsKey(e,t){return Se.resolve(this.ai.containsKey(t))}}class Ka{constructor(e,t){this.ci={},this.overlays={},this.li=new qe(0),this.hi=!1,this.hi=!0,this.Pi=new La,this.referenceDelegate=e(this),this.Ti=new Va(this),this.indexManager=new Ko,this.remoteDocumentCache=function(e){return new Ba(e)}((e=>this.referenceDelegate.Ii(e))),this.serializer=new to(t),this.Ei=new Na(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ma,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ci[e.toKey()];return n||(n=new ja(t,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,n){x("MemoryPersistence","Starting transaction:",e);const r=new za(this.li.next());return this.referenceDelegate.di(),n(r).next((e=>this.referenceDelegate.Ai(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ri(e,t){return Se.or(Object.values(this.ci).map((n=>()=>n.containsKey(e,t))))}}class za extends Te{constructor(e){super(),this.currentSequenceNumber=e}}class Wa{constructor(e){this.persistence=e,this.Vi=new Fa,this.mi=null}static fi(e){return new Wa(e)}get gi(){if(this.mi)return this.mi;throw D(60996)}addReference(e,t,n){return this.Vi.addReference(n,t),this.gi.delete(n.toString()),Se.resolve()}removeReference(e,t,n){return this.Vi.removeReference(n,t),this.gi.add(n.toString()),Se.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),Se.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach((e=>this.gi.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.gi.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Se.forEach(this.gi,(n=>{const r=de.fromPath(n);return this.pi(e,r).next((e=>{e||t.removeEntry(r,oe.min())}))})).next((()=>(this.mi=null,t.apply(e))))}updateLimboDocument(e,t){return this.pi(e,t).next((e=>{e?this.gi.delete(t.toString()):this.gi.add(t.toString())}))}Ii(e){return 0}pi(e,t){return Se.or([()=>Se.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Ha{constructor(e,t){this.persistence=e,this.yi=new si((e=>Ge(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=wa(this,t)}static fi(e,t){return new Ha(e,t)}di(){}Ai(e){return Se.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}br(e){let t=0;return this.yr(e,(e=>{t++})).next((()=>t))}yr(e,t){return Se.forEach(this.yi,((n,r)=>this.Dr(e,n,r).next((e=>e?Se.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.si(e,(r=>this.Dr(e,r,t).next((e=>{e||(n++,i.removeEntry(r,oe.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),Se.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),Se.resolve()}removeReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),Se.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),Se.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Hn(e.data.value)),t}Dr(e,t,n){return Se.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.yi.get(t);return Se.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ga{constructor(e){this.serializer=e}q(e,t,n,r){const i=new xe("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Xe)}(e),function(e){e.createObjectStore(et,{keyPath:"userId"});e.createObjectStore(tt,{keyPath:nt,autoIncrement:!0}).createIndex(rt,it,{unique:!0}),e.createObjectStore(ct)}(e),Qa(e),function(e){e.createObjectStore(Je)}(e));let s=Se.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(wt),e.deleteObjectStore(_t),e.deleteObjectStore(Ct)}(e),Qa(e)),s=s.next((()=>function(e){const t=e.store(Ct),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:oe.min().toTimestamp(),targetCount:0};return t.put(Tt,n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store(tt).J().next((n=>{e.deleteObjectStore(tt),e.createObjectStore(tt,{keyPath:nt,autoIncrement:!0}).createIndex(rt,it,{unique:!0});const r=t.store(tt),i=n.map((e=>r.put(e)));return Se.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore(xt,{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.wi(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore(gt)}(e),this.bi(i))))),n<7&&r>=7&&(s=s.next((()=>this.Si(i)))),n<8&&r>=8&&(s=s.next((()=>this.Di(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.Ci(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore(Pt,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(At,{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore(qt,{keyPath:Vt});t.createIndex(Kt,zt,{unique:!1}),t.createIndex(Wt,Ht,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore(lt,{keyPath:ut});t.createIndex(ht,dt),t.createIndex(ft,pt)}(e))).next((()=>this.Fi(e,i))).next((()=>e.deleteObjectStore(Je)))),n<14&&r>=14&&(s=s.next((()=>this.Mi(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore(Ot,{keyPath:"indexId",autoIncrement:!0}).createIndex(Dt,"collectionGroup",{unique:!1});e.createObjectStore(Rt,{keyPath:Nt}).createIndex(Mt,Lt,{unique:!1});e.createObjectStore(Ft,{keyPath:Ut}).createIndex(jt,Bt,{unique:!1})}(e)))),n<16&&r>=16&&(s=s.next((()=>{t.objectStore(Rt).clear()})).next((()=>{t.objectStore(Ft).clear()}))),n<17&&r>=17&&(s=s.next((()=>{!function(e){e.createObjectStore(Gt,{keyPath:"name"})}(e)}))),n<18&&r>=18&&(0,c.Ov)()&&(s=s.next((()=>{t.objectStore(Rt).clear()})).next((()=>{t.objectStore(Ft).clear()}))),s}bi(e){let t=0;return e.store(Je).te(((e,n)=>{t+=ra(n)})).next((()=>{const n={byteSize:t};return e.store(gt).put(mt,n)}))}wi(e){const t=e.store(et),n=e.store(tt);return t.J().next((t=>Se.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,Ve],[t.userId,t.lastAcknowledgedBatchId]);return n.J(rt,r).next((n=>Se.forEach(n,(n=>{N(n.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:n.batchId});const r=oo(this.serializer,n);return na(e,t.userId,r).next((()=>{}))}))))}))))}Si(e){const t=e.store(wt),n=e.store(Je);return e.store(Ct).get(Tt).next((e=>{const r=[];return n.te(((n,i)=>{const s=new le(n),o=function(e){return[0,Ge(e)]}(s);r.push(t.get(o).next((n=>n?Se.resolve():(n=>t.put({targetId:0,path:Ge(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>Se.waitFor(r)))}))}Di(e,t){e.createObjectStore(St,{keyPath:kt});const n=t.store(St),r=new zo,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Ge(r)})}};return t.store(Je).te({ee:!0},((e,t)=>{const n=new le(e);return i(n.popLast())})).next((()=>t.store(ct).te({ee:!0},((e,t)=>{let[n,r,s]=e;const o=$e(r);return i(o.popLast())}))))}Ci(e){const t=e.store(_t);return t.te(((e,n)=>{const r=ao(n),i=co(this.serializer,r);return t.put(i)}))}Fi(e,t){const n=t.store(Je),r=[];return n.te(((e,n)=>{const i=t.store(lt),s=function(e){return e.document?new de(le.fromString(e.document.name).popFirst(5)):e.noDocument?de.fromSegments(e.noDocument.path):e.unknownDocument?de.fromSegments(e.unknownDocument.path):D(36783)}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))})).next((()=>Se.waitFor(r)))}Mi(e,t){const n=t.store(tt),r=Ca(this.serializer),i=new Ka(Wa.fi,this.serializer.wt);return n.J().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:mi();oo(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),Se.forEach(n,((e,n)=>{const s=new I(n),o=_o.bt(this.serializer,s),a=i.getIndexManager(s),c=ia.bt(s,this.serializer,a,i.referenceDelegate);return new Ra(r,c,o,a).recalculateAndSaveOverlaysForDocumentKeys(new nn(t,qe.le),e).next()}))}))}}function Qa(e){e.createObjectStore(wt,{keyPath:bt}).createIndex(Et,It,{unique:!0}),e.createObjectStore(_t,{keyPath:"targetId"}).createIndex(vt,yt,{unique:!0}),e.createObjectStore(Ct)}const Ya="IndexedDbPersistence",$a=18e5,Ja=5e3,Xa="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Za="main";class ec{constructor(e,t,n,r,i,s,o,a,c,l){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:18;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.xi=i,this.window=s,this.document=o,this.Oi=c,this.Ni=l,this.Bi=u,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=e=>Promise.resolve(),!ec.C())throw new U(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ba(this,r),this.Ui=t+Za,this.serializer=new to(a),this.Ki=new Pe(this.Ui,this.Bi,new Ga(this.serializer)),this.Pi=new yo,this.Ti=new ua(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Ca(this.serializer),this.Ei=new po,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,!1===l&&P(Ya,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new U(F.FAILED_PRECONDITION,Xa);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ti.getHighestSequenceNumber(e)))})).then((e=>{this.li=new qe(e,this.Oi)})).then((()=>{this.hi=!0})).catch((e=>(this.Ki&&this.Ki.close(),Promise.reject(e))))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget((async()=>{this.started&&await this.Gi()})))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>nc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Yi(e).next((e=>{e||(this.isPrimary=!1,this.xi.enqueueRetryable((()=>this.$i(!1))))}))})).next((()=>this.Zi(e))).next((t=>this.isPrimary&&!t?this.Xi(e).next((()=>!1)):!!t&&this.es(e).next((()=>!0)))))).catch((e=>{if(Re(e))return x(Ya,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return x(Ya,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.xi.enqueueRetryable((()=>this.$i(e))),this.isPrimary=e}))}Yi(e){return tc(e).get(Ze).next((e=>Se.resolve(this.ts(e))))}ns(e){return nc(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,$a)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=rn(e,xt);return t.J().next((e=>{const n=this._s(e,$a),r=e.filter((e=>-1===n.indexOf(e)));return Se.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Gi().then((()=>this.rs())).then((()=>this.Hi()))))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?Se.resolve(!0):tc(e).get(Ze).next((t=>{if(null!==t&&this.ss(t.leaseTimestampMs,Ja)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new U(F.FAILED_PRECONDITION,Xa);return!1}}return!(!this.networkEnabled||!this.inForeground)||nc(e).J().next((e=>void 0===this._s(e,Ja).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&x(Ya,"Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e)))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[Xe,xt],(e=>{const t=new nn(e,qe.le);return this.Xi(t).next((()=>this.ns(t)))})),this.Ki.close(),this.Ts()}_s(e,t){return e.filter((e=>this.ss(e.updateTimeMs,t)&&!this.cs(e.clientId)))}Is(){return this.runTransaction("getActiveClients","readonly",(e=>nc(e).J().next((e=>this._s(e,$a).map((e=>e.clientId))))))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return ia.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Go(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return _o.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,n){x(Ya,"Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 18===e?tn:17===e?en:16===e?Zt:15===e?Xt:14===e?Jt:13===e?$t:12===e?Yt:11===e?Qt:void D(60245)}(this.Bi);let s;return this.Ki.runTransaction(e,r,i,(r=>(s=new nn(r,this.li?this.li.next():qe.le),"readwrite-primary"===t?this.Yi(s).next((e=>!!e||this.Zi(s))).next((t=>{if(!t)throw P("Failed to obtain primary lease for action '".concat(e,"'.")),this.isPrimary=!1,this.xi.enqueueRetryable((()=>this.$i(!1))),new U(F.FAILED_PRECONDITION,Ie);return n(s)})).next((e=>this.es(s).next((()=>e)))):this.Es(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}Es(e){return tc(e).get(Ze).next((e=>{if(null!==e&&this.ss(e.leaseTimestampMs,Ja)&&!this.cs(e.ownerId)&&!this.ts(e)&&!(this.Ni||this.allowTabSynchronization&&e.allowTabSynchronization))throw new U(F.FAILED_PRECONDITION,Xa)}))}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return tc(e).put(Ze,t)}static C(){return Pe.C()}Xi(e){const t=tc(e);return t.get(Ze).next((e=>this.ts(e)?(x(Ya,"Releasing primary lease."),t.delete(Ze)):Se.resolve()))}ss(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(P("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}zi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ki=()=>{this.xi.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.Gi())))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground="visible"===this.document.visibilityState)}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Li=()=>{this.ls();const e=/(?:Version|Mobile)\/1[456]/;(0,c.nr)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const n=null!==(null===(t=this.Wi)||void 0===t?void 0:t.getItem(this.us(e)));return x(Ya,"Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return P(Ya,"Failed to get zombied client id.",e),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){P("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch(e){}}us(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}function tc(e){return rn(e,Xe)}function nc(e){return rn(e,xt)}function rc(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class ic{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.ds=n,this.As=r}static Rs(e,t){let n=mi(),r=mi();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new ic(e,t.fromCache,n,r)}}class sc{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class oc{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=(0,c.nr)()?8:Ae((0,c.ZQ)())>0?6:4}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ws(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.bs(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new sc;return this.Ss(e,t,n).next((r=>{if(i.result=r,this.fs)return this.Ds(e,t,n,r.size)}))})).next((()=>i.result))}Ds(e,t,n,r){return n.documentReadCount<this.gs?(S()<=a.$b.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",ei(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),Se.resolve()):(S()<=a.$b.DEBUG&&x("QueryEngine","Query:",ei(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ps*r?(S()<=a.$b.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",ei(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qr(t))):Se.resolve())}ws(e,t){if(Wr(t))return Se.resolve(null);let n=Qr(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Jr(t,null,"F"),n=Qr(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=mi(...r);return this.ys.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.vs(t,r);return this.Cs(t,s,i,n.readTime)?this.ws(e,Jr(t,null,"F")):this.Fs(e,s,t,n)}))))})))))}bs(e,t,n,r){return Wr(t)||r.isEqual(oe.min())?Se.resolve(null):this.ys.getDocuments(e,n).next((i=>{const s=this.vs(t,i);return this.Cs(t,s,n,r)?Se.resolve(null):(S()<=a.$b.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ei(t)),this.Fs(e,s,t,ye(r,fe)).next((e=>e)))}))}vs(e,t){let n=new hn(ri(e));return t.forEach(((t,r)=>{ti(e,r)&&(n=n.add(r))})),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return S()<=a.$b.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",ei(t)),this.ys.getDocumentsMatchingQuery(e,t,be.min(),n)}Fs(e,t,n,r){return this.ys.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}const ac="LocalStore",cc=3e8;class lc{constructor(e,t,n,r){this.persistence=e,this.Ms=t,this.serializer=r,this.xs=new cn(J),this.Os=new si((e=>Lr(e)),Fr),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ra(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.xs)))}}function uc(e,t,n,r){return new lc(e,t,n,r)}async function hc(e,t){const n=L(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.Ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=mi();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({ks:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function dc(e){const t=L(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ti.getLastRemoteSnapshotVersion(e)))}function fc(e,t,n){let r=mi(),i=mi();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=ai();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(oe.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):x(ac,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{qs:r,Qs:i}}))}function pc(e,t){const n=L(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=Ve),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function gc(e,t){const n=L(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ti.getTargetData(e,t).next((i=>i?(r=i,Se.resolve(r)):n.Ti.allocateTargetId(e).next((i=>(r=new eo(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ti.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.xs.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.xs=n.xs.insert(e.targetId,e),n.Os.set(t,e.targetId)),e}))}async function mc(e,t,n){const r=L(e),i=r.xs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Re(e))throw e;x(ac,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.xs=r.xs.remove(t),r.Os.delete(i.target)}function _c(e,t,n){const r=L(e);let i=oe.min(),s=mi();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=L(e),i=r.Os.get(n);return void 0!==i?Se.resolve(r.xs.get(i)):r.Ti.getTargetData(t,n)}(r,e,Qr(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.Ms.getDocumentsMatchingQuery(e,t,n?i:oe.min(),n?s:mi()))).next((e=>(wc(r,ni(t),e),{documents:e,$s:s})))))}function vc(e,t){const n=L(e),r=L(n.Ti),i=n.xs.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.Rt(e,t).next((e=>e?e.target:null))))}function yc(e,t){const n=L(e),r=n.Ns.get(t)||oe.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.Bs.getAllFromCollectionGroup(e,t,ye(r,fe),Number.MAX_SAFE_INTEGER))).then((e=>(wc(n,t,e),e)))}function wc(e,t,n){let r=e.Ns.get(t)||oe.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Ns.set(t,r)}async function bc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mi();const r=await gc(e,Qr(lo(t.bundledQuery))),i=L(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=xs(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Ei.saveNamedQuery(e,t);const o=r.withResumeToken(_n.EMPTY_BYTE_STRING,s);return i.xs=i.xs.insert(o.targetId,o),i.Ti.updateTargetData(e,o).next((()=>i.Ti.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Ti.addMatchingKeys(e,n,r.targetId))).next((()=>i.Ei.saveNamedQuery(e,t)))}))}const Ec="firestore_clients";function Ic(e,t){return"".concat(Ec,"_").concat(e,"_").concat(t)}const Tc="firestore_mutations";function Cc(e,t,n){let r="".concat(Tc,"_").concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}const Sc="firestore_targets";function kc(e,t){return"".concat(Sc,"_").concat(e,"_").concat(t)}const xc="SharedClientState";class Pc{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Gs(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new U(r.error.code,r.error.message))),s?new Pc(e,t,r.state,i):(P(xc,"Failed to parse mutation state for ID '".concat(t,"': ").concat(n)),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ac{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Gs(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new U(n.error.code,n.error.message))),i?new Ac(e,n.state,r):(P(xc,"Failed to parse target state for ID '".concat(e,"': ").concat(t)),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Oc{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=vi();for(let s=0;r&&s<n.activeTargetIds.length;++s)r=We(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new Oc(e,i):(P(xc,"Failed to parse client data for instance '".concat(e,"': ").concat(t)),null)}}class Dc{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Dc(t.clientId,t.onlineState):(P(xc,"Failed to parse online state: ".concat(e)),null)}}class Rc{constructor(){this.activeTargetIds=vi()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Nc{constructor(e,t,n,r,i){this.window=e,this.xi=t,this.persistenceKey=n,this.Js=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new cn(J),this.started=!1,this.eo=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.no=Ic(this.persistenceKey,this.Js),this.ro=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.Xs=this.Xs.insert(this.Js,new Rc),this.io=new RegExp("^".concat(Ec,"_").concat(s,"_([^_]*)$")),this.so=new RegExp("^".concat(Tc,"_").concat(s,"_(\\d+)(?:_(.*))?$")),this.oo=new RegExp("^".concat(Sc,"_").concat(s,"_(\\d+)$")),this._o=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.ao=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const n of e){if(n===this.Js)continue;const e=this.getItem(Ic(this.persistenceKey,n));if(e){const t=Oc.Gs(n,e);t&&(this.Xs=this.Xs.insert(t.clientId,t))}}this.uo();const t=this.storage.getItem(this._o);if(t){const e=this.co(t);e&&this.lo(e)}for(const n of this.eo)this.Zs(n);this.eo=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,n){this.Po(e,t,n),this.To(e)}addLocalQueryTarget(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="not-current";if(this.isActiveQueryTarget(e)){const t=this.storage.getItem(kc(this.persistenceKey,e));if(t){const r=Ac.Gs(e,t);r&&(n=r.state)}}return t&&this.Io.js(e),this.uo(),n}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(kc(this.persistenceKey,e))}updateQueryState(e,t,n){this.Eo(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.To(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return x(xc,"READ",e,t),t}setItem(e,t){x(xc,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){x(xc,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(x(xc,"EVENT",t.key,t.newValue),t.key===this.no)return void P("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.io.test(t.key)){if(null==t.newValue){const e=this.Vo(t.key);return this.mo(e,null)}{const e=this.fo(t.key,t.newValue);if(e)return this.mo(e.clientId,e)}}else if(this.so.test(t.key)){if(null!==t.newValue){const e=this.po(t.key,t.newValue);if(e)return this.yo(e)}}else if(this.oo.test(t.key)){if(null!==t.newValue){const e=this.wo(t.key,t.newValue);if(e)return this.bo(e)}}else if(t.key===this._o){if(null!==t.newValue){const e=this.co(t.newValue);if(e)return this.lo(e)}}else if(t.key===this.ro){const e=function(e){let t=qe.le;if(null!=e)try{const n=JSON.parse(e);N("number"==typeof n,30636,{So:e}),t=n}catch(e){P(xc,"Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==qe.le&&this.sequenceNumberHandler(e)}else if(t.key===this.ao){const e=this.Do(t.newValue);await Promise.all(e.map((e=>this.syncEngine.vo(e))))}}else this.eo.push(t)}))}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,n){const r=new Pc(this.currentUser,e,t,n),i=Cc(this.persistenceKey,this.currentUser,e);this.setItem(i,r.zs())}To(e){const t=Cc(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,n){const r=kc(this.persistenceKey,e),i=new Ac(e,t,n);this.setItem(r,i.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const n=this.Vo(e);return Oc.Gs(n,t)}po(e,t){const n=this.so.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Pc.Gs(new I(i),r,t)}wo(e,t){const n=this.oo.exec(e),r=Number(n[1]);return Ac.Gs(r,t)}co(e){return Dc.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);x(xc,"Ignoring mutation for non-active user ".concat(e.user.uid))}bo(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const n=t?this.Xs.insert(e,t):this.Xs.remove(e),r=this.ho(this.Xs),i=this.ho(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.Mo(s,o).then((()=>{this.Xs=n}))}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=vi();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Mc{constructor(){this.xo=new Rc,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,n){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Rc,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Lc{No(e){}shutdown(){}}const Fc="ConnectivityMonitor";class Uc{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){x(Fc,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){x(Fc,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let jc=null;function Bc(){return null===jc?jc=268435456+Math.round(2147483648*Math.random()):jc++,"0x"+jc.toString(16)}const qc="RestConnection",Vc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Kc{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo="projects/".concat(n,"/databases/").concat(r),this.Go=this.databaseId.database===An?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}zo(e,t,n,r,i){const s=Bc(),o=this.jo(e,t.toUriEncodedString());x(qc,"Sending RPC '".concat(e,"' ").concat(s,":"),o,n);const a={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(a,r,i);const{host:l}=new URL(o),u=(0,c.zJ)(l);return this.Jo(e,o,a,n,u).then((t=>(x(qc,"Received RPC '".concat(e,"' ").concat(s,": "),t),t)),(t=>{throw A(qc,"RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",o,"request:",n),t}))}Yo(e,t,n,r,i,s){return this.zo(e,t,n,r,i)}Ho(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+T,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}jo(e,t){const n=Vc[e];return"".concat(this.Ko,"/v1/").concat(t,":").concat(n)}terminate(){}}class zc{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}const Wc="WebChannelConnection";class Hc extends Kc{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const s=Bc();return new Promise(((i,o)=>{const a=new h;a.setWithCredentials(!0),a.listenOnce(f.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case p.NO_ERROR:const t=a.getResponseJson();x(Wc,"XHR for RPC '".concat(e,"' ").concat(s," received:"),JSON.stringify(t)),i(t);break;case p.TIMEOUT:x(Wc,"RPC '".concat(e,"' ").concat(s," timed out")),o(new U(F.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:const n=a.getStatus();if(x(Wc,"RPC '".concat(e,"' ").concat(s," failed with status:"),n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(t)>=0?t:F.UNKNOWN}(t.status);o(new U(e,t.message))}else o(new U(F.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new U(F.UNAVAILABLE,"Connection failed."));break;default:D(9055,{h_:e,streamId:s,P_:a.getLastErrorCode(),T_:a.getLastError()})}}finally{x(Wc,"RPC '".concat(e,"' ").concat(s," completed."))}}));const c=JSON.stringify(r);x(Wc,"RPC '".concat(e,"' ").concat(s," sending request:"),r),a.send(t,"POST",c,n,15)}))}I_(e,t,n){const r=Bc(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=v(),o=_(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Ho(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const l=i.join("");x(Wc,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(l),a);const u=s.createWebChannel(l,a);this.E_(u);let h=!1,f=!1;const p=new zc({Zo:t=>{f?x(Wc,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(x(Wc,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),h=!0),x(Wc,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},Xo:()=>u.close()}),y=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return y(u,d.EventType.OPEN,(()=>{f||(x(Wc,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),p.__())})),y(u,d.EventType.CLOSE,(()=>{f||(f=!0,x(Wc,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.u_(),this.d_(u))})),y(u,d.EventType.ERROR,(t=>{f||(f=!0,A(Wc,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),p.u_(new U(F.UNAVAILABLE,"The operation could not be completed")))})),y(u,d.EventType.MESSAGE,(t=>{var n;if(!f){const i=t.data[0];N(!!i,16349);const s=i,o=(null==s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){x(Wc,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);const t=o.status;let n=function(e){const t=ts[e];if(void 0!==t)return is(t)}(t),i=o.message;void 0===n&&(n=F.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),f=!0,p.u_(new U(n,i)),u.close()}else x(Wc,"RPC '".concat(e,"' stream ").concat(r," received:"),i),p.c_(i)}})),y(o,m.STAT_EVENT,(t=>{t.stat===g.PROXY?x(Wc,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===g.NOPROXY&&x(Wc,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((()=>{p.a_()}),0),p}terminate(){this.l_.forEach((e=>e.close())),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter((t=>t===e))}}function Gc(){return"undefined"!=typeof window?window:null}function Qc(){return"undefined"!=typeof document?document:null}function Yc(e){return new Is(e,!0)}class $c{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.xi=e,this.timerId=t,this.A_=n,this.R_=r,this.V_=i,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),r=Math.max(0,t-n);r>0&&x("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.m_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.f_=this.xi.enqueueAfterDelay(this.timerId,r,(()=>(this.g_=Date.now(),e()))),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){null!==this.f_&&(this.f_.skipDelay(),this.f_=null)}cancel(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}const Jc="PersistentStream";class Xc{constructor(e,t,n,r,i,s,o,a){this.xi=e,this.S_=n,this.D_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new $c(e,t)}O_(){return 1===this.state||5===this.state||this.N_()}N_(){return 2===this.state||3===this.state}start(){this.M_=0,4!==this.state?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&null===this.C_&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,(()=>this.q_())))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,4!==e?this.x_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(P(t.toString()),P("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===F.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.v_===t&&this.z_(n,r)}),(t=>{e((()=>{const e=new U(F.UNKNOWN,"Fetching auth token failed: "+t.message);return this.j_(e)}))}))}z_(e,t){const n=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_((()=>{n((()=>this.listener.e_()))})),this.stream.n_((()=>{n((()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,(()=>(this.N_()&&(this.state=3),Promise.resolve()))),this.listener.n_())))})),this.stream.i_((e=>{n((()=>this.j_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.M_?this.J_(e):this.onNext(e)))}))}B_(){this.state=5,this.x_.y_((async()=>{this.state=0,this.start()}))}j_(e){return x(Jc,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget((()=>this.v_===e?t():(x(Jc,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Zc extends Xc{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:D(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(N(void 0===t||"string"==typeof t,58123),_n.fromBase64String(t||"")):(N(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),_n.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?F.UNKNOWN:is(e.code);return new U(t,e.message||"")}(o);n=new gs(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Rs(e,r.document.name),s=xs(r.document.updateTime),o=r.document.createTime?xs(r.document.createTime):oe.min(),a=new ar({mapValue:{fields:r.document.fields}}),c=lr.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new fs(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Rs(e,r.document),s=r.readTime?xs(r.readTime):oe.min(),o=lr.newNoDocument(i,s),a=r.removedTargetIds||[];n=new fs([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Rs(e,r.document),s=r.removedTargetIds||[];n=new fs([],s,i,null)}else{if(!("filter"in t))return D(11601,{Vt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new es(r,i),o=e.targetId;n=new ps(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return oe.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?oe.min():t.readTime?xs(t.readTime):oe.min()}(e);return this.listener.Y_(t,n)}Z_(e){const t={};t.database=Ls(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Ur(r)?{documents:Vs(e,r)}:{query:Ks(e,r).gt},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Ss(e,t.resumeToken);const r=Ts(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(oe.min())>0){n.readTime=Cs(e,t.snapshotVersion.toTimestamp());const r=Ts(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return D(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Q_(t)}X_(e){const t={};t.database=Ls(this.serializer),t.removeTarget=e,this.Q_(t)}}class el extends Xc{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return N(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,N(!e.writeResults||0===e.writeResults.length,55816),this.listener.na()}onNext(e){N(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=function(e,t){return e&&e.length>0?(N(void 0!==t,14353),e.map((e=>function(e,t){let n=e.updateTime?xs(e.updateTime):xs(t);return n.isEqual(oe.min())&&(n=xs(t)),new Mi(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=xs(e.commitTime);return this.listener.ra(n,t)}ia(){const e={};e.database=Ls(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Bs(this.serializer,e)))};this.Q_(t)}}class tl{}class nl extends tl{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.sa=!1}oa(){if(this.sa)throw new U(F.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,n,r){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.zo(e,As(t,n),r,s,o)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new U(F.UNKNOWN,e.toString())}))}Yo(e,t,n,r,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[o,a]=s;return this.connection.Yo(e,As(t,n),r,o,a,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new U(F.UNKNOWN,e.toString())}))}terminate(){this.sa=!0,this.connection.terminate()}}class rl{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){0===this._a&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve()))))}Pa(e){"Online"===this.state?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.la("Offline")))}set(e){this.Ta(),this._a=0,"Online"===e&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ua?(P(t),this.ua=!1):x("OnlineStateTracker",t)}Ta(){null!==this.aa&&(this.aa.cancel(),this.aa=null)}}const il="RemoteStore";class sl{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=i,this.Ra.No((e=>{n.enqueueAndForget((async()=>{pl(this)&&(x(il,"Restarting streams for network reachability change."),await async function(e){const t=L(e);t.da.add(4),await al(t),t.Va.set("Unknown"),t.da.delete(4),await ol(t)}(this))}))})),this.Va=new rl(n,r)}}async function ol(e){if(pl(e))for(const t of e.Aa)await t(!0)}async function al(e){for(const t of e.Aa)await t(!1)}function cl(e,t){const n=L(e);n.Ea.has(t.targetId)||(n.Ea.set(t.targetId,t),fl(n)?dl(n):Rl(n).N_()&&ul(n,t))}function ll(e,t){const n=L(e),r=Rl(n);n.Ea.delete(t),r.N_()&&hl(n,t),0===n.Ea.size&&(r.N_()?r.k_():pl(n)&&n.Va.set("Unknown"))}function ul(e,t){if(e.ma.Ke(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(oe.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Rl(e).Z_(t)}function hl(e,t){e.ma.Ke(t),Rl(e).X_(t)}function dl(e){e.ma=new _s({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Rt:t=>e.Ea.get(t)||null,Pt:()=>e.datastore.serializer.databaseId}),Rl(e).start(),e.Va.ca()}function fl(e){return pl(e)&&!Rl(e).O_()&&e.Ea.size>0}function pl(e){return 0===L(e).da.size}function gl(e){e.ma=void 0}async function ml(e){e.Va.set("Online")}async function _l(e){e.Ea.forEach(((t,n)=>{ul(e,t)}))}async function vl(e,t){gl(e),fl(e)?(e.Va.Pa(t),dl(e)):e.Va.set("Unknown")}async function yl(e,t,n){if(e.Va.set("Online"),t instanceof gs&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ea.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ea.delete(r),e.ma.removeTarget(r))}(e,t)}catch(n){x(il,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await wl(e,n)}else if(t instanceof fs?e.ma.Xe(t):t instanceof ps?e.ma.ot(t):e.ma.nt(t),!n.isEqual(oe.min()))try{const t=await dc(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.ma.It(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ea.get(r);i&&e.Ea.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.Ea.get(t);if(!r)return;e.Ea.set(t,r.withResumeToken(_n.EMPTY_BYTE_STRING,r.snapshotVersion)),hl(e,t);const i=new eo(r.target,t,n,r.sequenceNumber);ul(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){x(il,"Failed to raise snapshot:",t),await wl(e,t)}}async function wl(e,t,n){if(!Re(t))throw t;e.da.add(1),await al(e),e.Va.set("Offline"),n||(n=()=>dc(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{x(il,"Retrying IndexedDB access"),await n(),e.da.delete(1),await ol(e)}))}function bl(e,t){return t().catch((n=>wl(e,n,t)))}async function El(e){const t=L(e),n=Nl(t);let r=t.Ia.length>0?t.Ia[t.Ia.length-1].batchId:Ve;for(;Il(t);)try{const e=await pc(t.localStore,r);if(null===e){0===t.Ia.length&&n.k_();break}r=e.batchId,Tl(t,e)}catch(e){await wl(t,e)}Cl(t)&&Sl(t)}function Il(e){return pl(e)&&e.Ia.length<10}function Tl(e,t){e.Ia.push(t);const n=Nl(e);n.N_()&&n.ea&&n.ta(t.mutations)}function Cl(e){return pl(e)&&!Nl(e).O_()&&e.Ia.length>0}function Sl(e){Nl(e).start()}async function kl(e){Nl(e).ia()}async function xl(e){const t=Nl(e);for(const n of e.Ia)t.ta(n.mutations)}async function Pl(e,t,n){const r=e.Ia.shift(),i=Xi.from(r,t,n);await bl(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await El(e)}async function Al(e,t){t&&Nl(e).ea&&await async function(e,t){if(function(e){return rs(e)&&e!==F.ABORTED}(t.code)){const n=e.Ia.shift();Nl(e).L_(),await bl(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await El(e)}}(e,t),Cl(e)&&Sl(e)}async function Ol(e,t){const n=L(e);n.asyncQueue.verifyOperationInProgress(),x(il,"RemoteStore received new credentials");const r=pl(n);n.da.add(3),await al(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.da.delete(3),await ol(n)}async function Dl(e,t){const n=L(e);t?(n.da.delete(2),await ol(n)):t||(n.da.add(2),await al(n),n.Va.set("Unknown"))}function Rl(e){return e.fa||(e.fa=function(e,t,n){const r=L(e);return r.oa(),new Zc(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{e_:ml.bind(null,e),n_:_l.bind(null,e),i_:vl.bind(null,e),Y_:yl.bind(null,e)}),e.Aa.push((async t=>{t?(e.fa.L_(),fl(e)?dl(e):e.Va.set("Unknown")):(await e.fa.stop(),gl(e))}))),e.fa}function Nl(e){return e.ga||(e.ga=function(e,t,n){const r=L(e);return r.oa(),new el(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{e_:()=>Promise.resolve(),n_:kl.bind(null,e),i_:Al.bind(null,e),na:xl.bind(null,e),ra:Pl.bind(null,e)}),e.Aa.push((async t=>{t?(e.ga.L_(),await El(e)):(await e.ga.stop(),e.Ia.length>0&&(x(il,"Stopping write stream with ".concat(e.Ia.length," pending writes")),e.Ia=[]))}))),e.ga}class Ml{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new j,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Ml(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new U(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ll(e,t){if(P("AsyncQueue","".concat(t,": ").concat(e)),Re(e))return new U(F.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Fl{static emptySet(e){return new Fl(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||de.comparator(t.key,n.key):(e,t)=>de.comparator(e.key,t.key),this.keyedMap=li(),this.sortedSet=new cn(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Fl))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Fl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ul{constructor(){this.pa=new cn(de.comparator)}track(e){const t=e.doc.key,n=this.pa.get(t);n?0!==e.type&&3===n.type?this.pa=this.pa.insert(t,e):3===e.type&&1!==n.type?this.pa=this.pa.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.pa=this.pa.remove(t):1===e.type&&2===n.type?this.pa=this.pa.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):D(63341,{Vt:e,ya:n}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal(((t,n)=>{e.push(n)})),e}}class jl{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new jl(e,t,Fl.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xr(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Bl{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some((e=>e.va()))}}class ql{constructor(){this.queries=Vl(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=L(e),r=n.queries;n.queries=Vl(),r.forEach(((e,n)=>{for(const r of n.Sa)r.onError(t)}))}(this,new U(F.ABORTED,"Firestore shutting down"))}}function Vl(){return new si((e=>Zr(e)),Xr)}async function Kl(e,t){const n=L(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Da()&&t.va()&&(r=2):(s=new Bl,r=t.va()?0:1);try{switch(r){case 0:s.ba=await n.onListen(i,!0);break;case 1:s.ba=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Ll(e,"Initialization of query '".concat(ei(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.Sa.push(t),t.Fa(n.onlineState),s.ba&&t.Ma(s.ba)&&Gl(n)}async function zl(e,t){const n=L(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?i=t.va()?0:1:!s.Da()&&t.va()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Wl(e,t){const n=L(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Ma(i)&&(r=!0);t.ba=i}}r&&Gl(n)}function Hl(e,t,n){const r=L(e),i=r.queries.get(t);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(t)}function Gl(e){e.Ca.forEach((e=>{e.next()}))}var Ql,Yl;(Yl=Ql||(Ql={})).xa="default",Yl.Cache="cache";class $l{constructor(e,t,n){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new jl(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache)return!0;if(!this.va())return!0;const n="Offline"!==t;return(!this.options.Qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}qa(e){e=jl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Ql.Cache}}class Jl{constructor(e,t){this.$a=e,this.byteLength=t}Ua(){return"metadata"in this.$a}}class Xl{constructor(e){this.serializer=e}Us(e){return Rs(this.serializer,e)}Ks(e){return e.metadata.exists?js(this.serializer,e.document,!1):lr.newNoDocument(this.Us(e.metadata.name),this.Ws(e.metadata.readTime))}Ws(e){return xs(e)}}class Zl{constructor(e,t,n){this.Ka=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=eu(e)}Wa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.$a.namedQuery)this.queries.push(e.$a.namedQuery);else if(e.$a.documentMetadata){this.documents.push({metadata:e.$a.documentMetadata}),e.$a.documentMetadata.exists||++t;const n=le.fromString(e.$a.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.$a.document&&(this.documents[this.documents.length-1].document=e.$a.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ga(e){const t=new Map,n=new Xl(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.Us(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||mi()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=L(e);let s=mi(),o=ai();for(const l of n){const e=t.Us(l.metadata.name);l.document&&(s=s.add(e));const n=t.Ks(l);n.setReadTime(t.Ws(l.metadata.readTime)),o=o.insert(e,n)}const a=i.Bs.newChangeBuffer({trackRemovals:!0}),c=await gc(i,function(e){return Qr(zr(le.fromString("__bundle__/docs/".concat(e))))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>fc(e,a,o).next((t=>(a.apply(e),t))).next((t=>i.Ti.removeMatchingKeysForTargetId(e,c.targetId).next((()=>i.Ti.addMatchingKeys(e,s,c.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.qs,t.Qs))).next((()=>t.qs))))))}(this.localStore,new Xl(this.serializer),this.documents,this.Ka.id),t=this.Ga(this.documents);for(const n of this.queries)await bc(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,za:this.collectionGroups,ja:e}}}function eu(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class tu{constructor(e){this.key=e}}class nu{constructor(e){this.key=e}}class ru{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=mi(),this.mutatedKeys=mi(),this.Za=ri(e),this.Xa=new Fl(this.Za)}get eu(){return this.Ha}tu(e,t){const n=t?t.nu:new Ul,r=t?t.Xa:this.Xa;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const l=r.get(e),u=ti(this.query,t)?t:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.ru(l,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Za(u,a)>0||c&&this.Za(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Xa:s,nu:n,Cs:o,mutatedKeys:i}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const s=e.nu.wa();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return D(20277,{Vt:e})}};return n(e)-n(t)}(e.type,t.type)||this.Za(e.doc,t.doc))),this.iu(n),r=null!=r&&r;const o=t&&!r?this.su():[],a=0===this.Ya.size&&this.current&&!r?1:0,c=a!==this.Ja;return this.Ja=a,0!==s.length||c?{snapshot:new jl(this.query,e.Xa,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:o}:{ou:o}}Fa(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new Ul,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach((e=>this.Ha=this.Ha.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ha=this.Ha.delete(e))),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=mi(),this.Xa.forEach((e=>{this._u(e.key)&&(this.Ya=this.Ya.add(e.key))}));const t=[];return e.forEach((e=>{this.Ya.has(e)||t.push(new nu(e))})),this.Ya.forEach((n=>{e.has(n)||t.push(new tu(n))})),t}au(e){this.Ha=e.$s,this.Ya=mi();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return jl.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,0===this.Ja,this.hasCachedResults)}}const iu="SyncEngine";class su{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class ou{constructor(e){this.key=e,this.cu=!1}}class au{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.lu={},this.hu=new si((e=>Zr(e)),Xr),this.Pu=new Map,this.Tu=new Set,this.Iu=new cn(de.comparator),this.Eu=new Map,this.du=new Fa,this.Au={},this.Ru=new Map,this.Vu=la.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return!0===this.mu}}async function cu(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Fu(e);let i;const s=r.hu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.uu()):i=await uu(r,t,n,!0),i}async function lu(e,t){const n=Fu(e);await uu(n,t,!0,!1)}async function uu(e,t,n,r){const i=await gc(e.localStore,Qr(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await hu(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&cl(e.remoteStore,i),a}async function hu(e,t,n,r,i){e.fu=(t,n,r)=>async function(e,t,n,r){let i=t.view.tu(n);i.Cs&&(i=await _c(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.tu(n,i)})));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return Iu(e,t.targetId,a.ou),a.snapshot}(e,t,n,r);const s=await _c(e.localStore,t,!0),o=new ru(t,s.$s),a=o.tu(s.documents),c=ds.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),l=o.applyChanges(a,e.isPrimaryClient,c);Iu(e,n,l.ou);const u=new su(t,n,o);return e.hu.set(t,u),e.Pu.has(n)?e.Pu.get(n).push(t):e.Pu.set(n,[t]),l.snapshot}async function du(e,t,n){const r=L(e),i=r.hu.get(t),s=r.Pu.get(i.targetId);if(s.length>1)return r.Pu.set(i.targetId,s.filter((e=>!Xr(e,t)))),void r.hu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await mc(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ll(r.remoteStore,i.targetId),bu(r,i.targetId)})).catch(Ce)):(bu(r,i.targetId),await mc(r.localStore,i.targetId,!0))}async function fu(e,t){const n=L(e),r=n.hu.get(t),i=n.Pu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ll(n.remoteStore,r.targetId))}async function pu(e,t){const n=L(e);try{const e=await function(e,t){const n=L(e),r=t.snapshotVersion;let i=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Bs.newChangeBuffer({trackRemovals:!0});i=n.xs;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.Ti.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Ti.addMatchingKeys(e,s.addedDocuments,a))));let l=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?l=l.withResumeToken(_n.EMPTY_BYTE_STRING,oe.min()).withLastLimboFreeSnapshotVersion(oe.min()):s.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(s.resumeToken,r)),i=i.insert(a,l),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=cc||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(c,l,s)&&o.push(n.Ti.updateTargetData(e,l))}));let a=ai(),c=mi();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(fc(e,s,t.documentUpdates).next((e=>{a=e.qs,c=e.Qs}))),!r.isEqual(oe.min())){const t=n.Ti.getLastRemoteSnapshotVersion(e).next((t=>n.Ti.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Se.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.xs=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Eu.get(t);r&&(N(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.cu=!0:e.modifiedDocuments.size>0?N(r.cu,14607):e.removedDocuments.size>0&&(N(r.cu,42227),r.cu=!1))})),await Su(n,e,t)}catch(e){await Ce(e)}}function gu(e,t,n){const r=L(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.hu.forEach(((n,r)=>{const i=r.view.Fa(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=L(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.Sa)i.Fa(t)&&(r=!0)})),r&&Gl(n)}(r.eventManager,t),e.length&&r.lu.Y_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function mu(e,t,n){const r=L(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let e=new cn(de.comparator);e=e.insert(s,lr.newNoDocument(s,oe.min()));const n=mi().add(s),i=new hs(oe.min(),new Map,new cn(J),e,n);await pu(r,i),r.Iu=r.Iu.remove(s),r.Eu.delete(t),Cu(r)}else await mc(r.localStore,t,!1).then((()=>bu(r,t,n))).catch(Ce)}async function _u(e,t){const n=L(e),r=t.batch.batchId;try{const e=await function(e,t){const n=L(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Se.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);N(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=mi();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);wu(n,r,null),yu(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Su(n,e)}catch(e){await Ce(e)}}async function vu(e,t,n){const r=L(e);try{const e=await function(e,t){const n=L(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(N(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);wu(r,t,n),yu(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Su(r,e)}catch(n){await Ce(n)}}function yu(e,t){(e.Ru.get(t)||[]).forEach((e=>{e.resolve()})),e.Ru.delete(t)}function wu(e,t,n){const r=L(e);let i=r.Au[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Au[r.currentUser.toKey()]=i}}function bu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Pu.get(t))e.hu.delete(r),n&&e.lu.gu(r,n);e.Pu.delete(t),e.isPrimaryClient&&e.du.Hr(t).forEach((t=>{e.du.containsKey(t)||Eu(e,t)}))}function Eu(e,t){e.Tu.delete(t.path.canonicalString());const n=e.Iu.get(t);null!==n&&(ll(e.remoteStore,n),e.Iu=e.Iu.remove(t),e.Eu.delete(n),Cu(e))}function Iu(e,t,n){for(const r of n)r instanceof tu?(e.du.addReference(r.key,t),Tu(e,r)):r instanceof nu?(x(iu,"Document no longer in limbo: "+r.key),e.du.removeReference(r.key,t),e.du.containsKey(r.key)||Eu(e,r.key)):D(19791,{pu:r})}function Tu(e,t){const n=t.key,r=n.path.canonicalString();e.Iu.get(n)||e.Tu.has(r)||(x(iu,"New document in limbo: "+n),e.Tu.add(r),Cu(e))}function Cu(e){for(;e.Tu.size>0&&e.Iu.size<e.maxConcurrentLimboResolutions;){const t=e.Tu.values().next().value;e.Tu.delete(t);const n=new de(le.fromString(t)),r=e.Vu.next();e.Eu.set(r,new ou(n)),e.Iu=e.Iu.insert(n,r),cl(e.remoteStore,new eo(Qr(zr(n.path)),r,"TargetPurposeLimboResolution",qe.le))}}async function Su(e,t,n){const r=L(e),i=[],s=[],o=[];r.hu.isEmpty()||(r.hu.forEach(((e,a)=>{o.push(r.fu(a,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=ic.Rs(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.lu.Y_(i),await async function(e,t){const n=L(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Se.forEach(t,(t=>Se.forEach(t.ds,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Se.forEach(t.As,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Re(e))throw e;x(ac,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.xs.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.xs=n.xs.insert(e,i)}}}(r.localStore,s))}async function ku(e,t){const n=L(e);if(!n.currentUser.isEqual(t)){x(iu,"User change. New user:",t.toKey());const e=await hc(n.localStore,t);n.currentUser=t,function(e,t){e.Ru.forEach((e=>{e.forEach((e=>{e.reject(new U(F.CANCELLED,t))}))})),e.Ru.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Su(n,e.ks)}}function xu(e,t){const n=L(e),r=n.Eu.get(t);if(r&&r.cu)return mi().add(r.key);{let e=mi();const r=n.Pu.get(t);if(!r)return e;for(const t of r){const r=n.hu.get(t);e=e.unionWith(r.view.eu)}return e}}async function Pu(e,t){const n=L(e),r=await _c(n.localStore,t.query,!0),i=t.view.au(r);return n.isPrimaryClient&&Iu(n,t.targetId,i.ou),i}async function Au(e,t){const n=L(e);return yc(n.localStore,t).then((e=>Su(n,e)))}async function Ou(e,t,n,r){const i=L(e),s=await function(e,t){const n=L(e),r=L(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.tr(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):Se.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await El(i.remoteStore):"acknowledged"===n||"rejected"===n?(wu(i,t,r||null),yu(i,t),function(e,t){L(L(e).mutationQueue).sr(t)}(i.localStore,t)):D(6720,"Unknown batchState",{yu:n}),await Su(i,s)):x(iu,"Cannot apply mutation batch with id: "+t)}async function Du(e,t,n){const r=L(e),i=[],s=[];for(const o of t){let e;const t=r.Pu.get(o);if(t&&0!==t.length){e=await gc(r.localStore,Qr(t[0]));for(const e of t){const t=r.hu.get(e),n=await Pu(r,t);n.snapshot&&s.push(n.snapshot)}}else{const t=await vc(r.localStore,o);e=await gc(r.localStore,t),await hu(r,Ru(t),o,!1,e.resumeToken)}i.push(e)}return r.lu.Y_(s),i}function Ru(e){return Kr(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Nu(e){return function(e){return L(L(e).persistence).Is()}(L(e).localStore)}async function Mu(e,t,n,r){const i=L(e);if(i.mu)return void x(iu,"Ignoring unexpected query state notification.");const s=i.Pu.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await yc(i.localStore,ni(s[0])),r=hs.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,_n.EMPTY_BYTE_STRING);await Su(i,e,r);break}case"rejected":await mc(i.localStore,t,!0),bu(i,t,r);break;default:D(64155,n)}}async function Lu(e,t,n){const r=Fu(e);if(r.mu){for(const e of t){if(r.Pu.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){x(iu,"Adding an already active target "+e);continue}const t=await vc(r.localStore,e),n=await gc(r.localStore,t);await hu(r,Ru(t),n.targetId,!1,n.resumeToken),cl(r.remoteStore,n)}for(const e of n)r.Pu.has(e)&&await mc(r.localStore,e,!1).then((()=>{ll(r.remoteStore,e),bu(r,e)})).catch(Ce)}}function Fu(e){const t=L(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=pu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=xu.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=mu.bind(null,t),t.lu.Y_=Wl.bind(null,t.eventManager),t.lu.gu=Hl.bind(null,t.eventManager),t}function Uu(e){const t=L(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=_u.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=vu.bind(null,t),t}class ju{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Yc(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return uc(this.persistence,new oc,e.initialUser,this.serializer)}Su(e){return new Ka(Wa.fi,this.serializer)}bu(e){return new Mc}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ju.provider={build:()=>new ju};class Bu extends ju{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){N(this.persistence.referenceDelegate instanceof Ha,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new va(n,e.asyncQueue,t)}Su(e){const t=void 0!==this.cacheSizeBytes?ta.withCacheSize(this.cacheSizeBytes):ta.DEFAULT;return new Ka((e=>Ha.fi(e,t)),this.serializer)}}class qu extends ju{constructor(e,t,n){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await Uu(this.Fu.syncEngine),await El(this.Fu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}Du(e){return uc(this.persistence,new oc,e.initialUser,this.serializer)}vu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new va(n,e.asyncQueue,t)}Cu(e,t){const n=new Be(t,this.persistence);return new je(e.asyncQueue,n)}Su(e){const t=rc(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ta.withCacheSize(this.cacheSizeBytes):ta.DEFAULT;return new ec(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Gc(),Qc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new Mc}}class Vu extends qu{constructor(e,t){super(e,t,!1),this.Fu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Fu.syncEngine;this.sharedClientState instanceof Nc&&(this.sharedClientState.syncEngine={Co:Ou.bind(null,t),Fo:Mu.bind(null,t),Mo:Lu.bind(null,t),Is:Nu.bind(null,t),vo:Au.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async e=>{await async function(e,t){const n=L(e);if(Fu(n),Uu(n),!0===t&&!0!==n.mu){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Du(n,e.toArray());n.mu=!0,await Dl(n.remoteStore,!0);for(const r of t)cl(n.remoteStore,r)}else if(!1===t&&!1!==n.mu){const e=[];let t=Promise.resolve();n.Pu.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(bu(n,i),mc(n.localStore,i,!0)))),ll(n.remoteStore,i)})),await t,await Du(n,e),function(e){const t=L(e);t.Eu.forEach(((e,n)=>{ll(t.remoteStore,n)})),t.du.Jr(),t.Eu=new Map,t.Iu=new cn(de.comparator)}(n),n.mu=!1,await Dl(n.remoteStore,!1)}}(this.Fu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}bu(e){const t=Gc();if(!Nc.C(t))throw new U(F.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=rc(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Nc(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Ku{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>gu(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=ku.bind(null,this.syncEngine),await Dl(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new ql}createDatastore(e){const t=Yc(e.databaseInfo.databaseId),n=function(e){return new Hc(e)}(e.databaseInfo);return function(e,t,n,r){return new nl(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new sl(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>gu(this.syncEngine,e,0)),Uc.C()?new Uc:new Lc)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new au(e,t,n,r,i,s);return o&&(a.mu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=L(e);x(il,"RemoteStore shutting down."),t.da.add(5),await al(t),t.Ra.shutdown(),t.Va.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}function zu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}Ku.provider={build:()=>new Ku};class Wu{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):P("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class Hu{constructor(e,t){this.Ou=e,this.serializer=t,this.metadata=new j,this.buffer=new Uint8Array,this.Nu=new TextDecoder("utf-8"),this.Bu().then((e=>{e&&e.Ua()?this.metadata.resolve(e.$a.metadata):this.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.$a))))}),(e=>this.metadata.reject(e)))}close(){return this.Ou.cancel()}async getMetadata(){return this.metadata.promise}async wu(){return await this.getMetadata(),this.Bu()}async Bu(){const e=await this.Lu();if(null===e)return null;const t=this.Nu.decode(e),n=Number(t);isNaN(n)&&this.ku("length string (".concat(t,") is not valid number"));const r=await this.qu(n);return new Jl(JSON.parse(r),e.length+n)}Qu(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async Lu(){for(;this.Qu()<0&&!await this.$u(););if(0===this.buffer.length)return null;const e=this.Qu();e<0&&this.ku("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async qu(e){for(;this.buffer.length<e;)await this.$u()&&this.ku("Reached the end of bundle when more is expected.");const t=this.Nu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ku(e){throw this.Ou.cancel(),new Error("Invalid bundle format: ".concat(e))}async $u(){const e=await this.Ou.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Gu{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new U(F.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=L(e),r={documents:t.map((e=>Ds(n.serializer,e)))},i=await n.Yo("BatchGetDocuments",n.serializer.databaseId,le.emptyPath(),r,t.length),s=new Map;i.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){N(!!t.found,43571),t.found.name,t.found.updateTime;const n=Rs(e,t.found.name),r=xs(t.found.updateTime),i=t.found.createTime?xs(t.found.createTime):oe.min(),s=new ar({mapValue:{fields:t.found.fields}});return lr.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){N(!!t.missing,3894),N(!!t.readTime,22933);const n=Rs(e,t.missing),r=xs(t.readTime);return lr.newNoDocument(n,r)}(e,t):D(7234,{result:t})}(n.serializer,e);s.set(t.key.toString(),t)}));const o=[];return t.forEach((e=>{const t=s.get(e.toString());N(!!t,55234,{key:e}),o.push(t)})),o}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Yi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=de.fromPath(t);this.mutations.push(new $i(n,this.precondition(n)))})),await async function(e,t){const n=L(e),r={writes:t.map((e=>Bs(n.serializer,e)))};await n.zo("Commit",n.serializer.databaseId,le.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw D(50498,{Uu:e.constructor.name});t=oe.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new U(F.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(oe.min())?Li.exists(!1):Li.updateTime(t):Li.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(oe.min()))throw new U(F.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Li.updateTime(t)}return Li.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Qu{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Ku=n.maxAttempts,this.x_=new $c(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_((async()=>{const e=new Gu(this.datastore),t=this.zu(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.ju(e)}))))})).catch((e=>{this.ju(e)}))}))}zu(e){try{const t=this.updateFunction(e);return!Ke(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget((()=>(this.Gu(),Promise.resolve())))):this.deferred.reject(e)}Hu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!rs(t)}return!1}}const Yu="FirestoreClient";class $u{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=I.UNAUTHENTICATED,this.clientId=$.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{x(Yu,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(x(Yu,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new j;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Ll(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Ju(e,t){e.asyncQueue.verifyOperationInProgress(),x(Yu,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await hc(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Xu(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Zu(e);x(Yu,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Ol(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Ol(t.remoteStore,n))),e._onlineComponents=t}async function Zu(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){x(Yu,"Using user provided OfflineComponentProvider");try{await Ju(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===F.FAILED_PRECONDITION||e.code===F.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;A("Error using user provided cache. Falling back to memory cache: "+n),await Ju(e,new ju)}}else x(Yu,"Using default OfflineComponentProvider"),await Ju(e,new Bu(void 0));return e._offlineComponents}async function eh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(x(Yu,"Using user provided OnlineComponentProvider"),await Xu(e,e._uninitializedComponentsProvider._online)):(x(Yu,"Using default OnlineComponentProvider"),await Xu(e,new Ku))),e._onlineComponents}function th(e){return Zu(e).then((e=>e.persistence))}function nh(e){return Zu(e).then((e=>e.localStore))}function rh(e){return eh(e).then((e=>e.remoteStore))}function ih(e){return eh(e).then((e=>e.syncEngine))}function sh(e){return eh(e).then((e=>e.datastore))}async function oh(e){const t=await eh(e),n=t.eventManager;return n.onListen=cu.bind(null,t.syncEngine),n.onUnlisten=du.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=lu.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=fu.bind(null,t.syncEngine),n}function ah(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new j;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Wu({next:a=>{s.xu(),t.enqueueAndForget((()=>zl(e,o)));const c=a.docs.has(n);!c&&a.fromCache?i.reject(new U(F.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&r&&"server"===r.source?i.reject(new U(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new $l(zr(n.path),s,{includeMetadataChanges:!0,Qa:!0});return Kl(e,o)}(await oh(e),e.asyncQueue,t,n,r))),r.promise}function ch(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new j;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Wu({next:n=>{s.xu(),t.enqueueAndForget((()=>zl(e,o))),n.fromCache&&"server"===r.source?i.reject(new U(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new $l(n,s,{includeMetadataChanges:!0,Qa:!0});return Kl(e,o)}(await oh(e),e.asyncQueue,t,n,r))),r.promise}function lh(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?Y().encode(e):e,function(e,t){return new Hu(e,t)}(function(e,t){if(e instanceof Uint8Array)return zu(e,t);if(e instanceof ArrayBuffer)return zu(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,Yc(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=L(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=L(e),r=xs(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Ei.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(eu(r));const i=new Zl(r,e.localStore,t.serializer);let s=await t.wu();for(;s;){const e=await i.Wa(s);e&&n._updateProgress(e),s=await t.wu()}const o=await i.complete();return await Su(e,o.ja,void 0),await function(e,t){const n=L(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Ei.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.za)}catch(e){return A(iu,"Loading bundle failed with ".concat(e)),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await ih(e),i,r)}))}function uh(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const hh=new Map;function dh(e,t,n){if(!n)throw new U(F.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function fh(e,t,n,r){if(!0===t&&!0===r)throw new U(F.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function ph(e){if(!de.isDocumentKey(e))throw new U(F.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function gh(e){if(de.isDocumentKey(e))throw new U(F.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function mh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":D(12329,{type:typeof e})}function _h(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new U(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=mh(e);throw new U(F.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function vh(e,t){if(t<=0)throw new U(F.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}const yh="firestore.googleapis.com",wh=!0;class bh{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new U(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yh,this.ssl=wh}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:wh;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=ea;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<ga)throw new U(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}fh("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uh(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new U(F.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new U(F.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new U(F.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Eh{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new U(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new U(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bh(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new q;switch(e.type){case"firstParty":return new W(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new U(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=hh.get(e);t&&(x("ComponentProvider","Removing Datastore"),hh.delete(e),t.terminate())}(this),Promise.resolve()}}function Ih(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;e=_h(e,Eh);const s=(0,c.zJ)(t),o=e._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),l="".concat(t,":").concat(n);s&&((0,c.gE)("https://".concat(l)),(0,c.P1)("Firestore",!0)),o.host!==yh&&o.host!==l&&A("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:l,ssl:s,emulatorOptions:r});if(!(0,c.bD)(u,a)&&(e._setSettings(u),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=I.MOCK_USER;else{t=(0,c.Fy)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new U(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new I(s)}e._authCredentials=new V(new B(t,n))}}class Th{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Th(this.firestore,e,this._query)}}class Ch{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ch(this.firestore,e,this._key)}}class Sh extends Th{constructor(e,t,n){super(e,t,zr(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ch(this.firestore,null,new de(e))}withConverter(e){return new Sh(this.firestore,e,this._path)}}function kh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,c.Ku)(e),dh("collection","path",t),e instanceof Eh){const n=le.fromString(t,...r);return gh(n),new Sh(e,null,n)}{if(!(e instanceof Ch||e instanceof Sh))throw new U(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(le.fromString(t,...r));return gh(n),new Sh(e.firestore,null,n)}}function xh(e,t){if(e=_h(e,Eh),dh("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new U(F.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new Th(e,null,function(e){return new Vr(le.emptyPath(),e)}(t))}function Ph(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,c.Ku)(e),1===arguments.length&&(t=$.newId()),dh("doc","path",t),e instanceof Eh){const n=le.fromString(t,...r);return ph(n),new Ch(e,null,new de(n))}{if(!(e instanceof Ch||e instanceof Sh))throw new U(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(le.fromString(t,...r));return ph(n),new Ch(e.firestore,e instanceof Sh?e.converter:null,new de(n))}}function Ah(e,t){return e=(0,c.Ku)(e),t=(0,c.Ku)(t),(e instanceof Ch||e instanceof Sh)&&(t instanceof Ch||t instanceof Sh)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Oh(e,t){return e=(0,c.Ku)(e),t=(0,c.Ku)(t),e instanceof Th&&t instanceof Th&&e.firestore===t.firestore&&Xr(e._query,t._query)&&e.converter===t.converter}const Dh="AsyncQueue";class Rh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new $c(this,"async_queue_retry"),this.rc=()=>{const e=Qc();e&&x(Dh,"Visibility state changed to "+e.visibilityState),this.x_.b_()},this.sc=e;const t=Qc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Qc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise((()=>{}));const t=new j;return this._c((()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Ju.push(e),this.ac())))}async ac(){if(0!==this.Ju.length){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!Re(e))throw e;x(Dh,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_((()=>this.ac()))}}_c(e){const t=this.sc.then((()=>(this.ec=!0,e().catch((e=>{throw this.Xu=e,this.ec=!1,P("INTERNAL UNHANDLED ERROR: ",Nh(e)),e})).then((e=>(this.ec=!1,e))))));return this.sc=t,t}enqueueAfterDelay(e,t,n){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const r=Ml.createAndSchedule(this,e,t,n,(e=>this.uc(e)));return this.Zu.push(r),r}oc(){this.Xu&&D(47125,{cc:Nh(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do{e=this.sc,await e}while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then((()=>{this.Zu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Zu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.lc()}))}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function Nh(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Mh(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Lh{constructor(){this._progressObserver={},this._taskCompletionResolver=new j,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const Fh=-1;class Uh extends Eh{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Rh,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Rh(e),this._firestoreClient=void 0,await e}}}function jh(e){if(e._terminated)throw new U(F.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Bh(e),e._firestoreClient}function Bh(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Pn(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,uh(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new $u(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function qh(e,t){A("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return Kh(e,Ku.provider,{build:e=>new qu(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()}async function Vh(e){A("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=e._freezeSettings();Kh(e,Ku.provider,{build:e=>new Vu(e,t.cacheSizeBytes)})}function Kh(e,t,n){if((e=_h(e,Uh))._firestoreClient||e._terminated)throw new U(F.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new U(F.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},Bh(e)}function zh(e){if(e._initialized&&!e._terminated)throw new U(F.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new j;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!Pe.C())return Promise.resolve();const t=e+Za;await Pe.delete(t)}(rc(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}function Wh(e){return function(e){const t=new j;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=L(e);pl(n.remoteStore)||x(iu,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=L(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(e===Ve)return void t.resolve();const r=n.Ru.get(e)||[];r.push(t),n.Ru.set(e,r)}catch(e){const n=Ll(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await ih(e),t))),t.promise}(jh(e=_h(e,Uh)))}function Hh(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await th(e),n=await rh(e);return t.setNetworkEnabled(!0),function(e){const t=L(e);return t.da.delete(0),ol(t)}(n)}))}(jh(e=_h(e,Uh)))}function Gh(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await th(e),n=await rh(e);return t.setNetworkEnabled(!1),async function(e){const t=L(e);t.da.add(0),await al(t),t.Va.set("Offline")}(n)}))}(jh(e=_h(e,Uh)))}function Qh(e,t){const n=jh(e=_h(e,Uh)),r=new Lh;return lh(n,e._databaseId,t,r),r}function Yh(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=L(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.Ei.getNamedQuery(e,t)))}(await nh(e),t)))}(jh(e=_h(e,Uh)),t).then((t=>t?new Th(e,null,t.query):null))}class $h{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $h(_n.fromBase64String(e))}catch(e){throw new U(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new $h(_n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Jh{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new U(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new he(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Xh{constructor(e){this._methodName=e}}class Zh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new U(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new U(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}}class ed{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const td=/^__.*__$/;class nd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Wi(e,this.data,this.fieldMask,t,this.fieldTransforms):new zi(e,this.data,t,this.fieldTransforms)}}class rd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Wi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function id(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw D(40011,{Ic:e})}}class sd{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ec(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new sd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.dc({path:n,Rc:!1});return r.Vc(e),r}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.dc({path:n,Rc:!1});return r.Ec(),r}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Cd(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(0===e.length)throw this.gc("Document fields must not be empty");if(id(this.Ic)&&td.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class od{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Yc(e)}bc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new sd({Ic:e,methodName:t,wc:n,path:he.emptyPath(),Rc:!1,yc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ad(e){const t=e._freezeSettings(),n=Yc(e._databaseId);return new od(e._databaseId,!!t.ignoreUndefinedProperties,n)}function cd(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.bc(s.merge||s.mergeFields?2:0,t,n,i);bd("Data must be an object, but it was:",o,r);const a=yd(r,o);let c,l;if(s.merge)c=new pn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Ed(t,r,n);if(!o.contains(i))throw new U(F.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));Sd(e,i)||e.push(i)}c=new pn(e),l=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=o.fieldTransforms;return new nd(new ar(a),c,l)}class ld extends Xh{_toFieldTransform(e){if(2!==e.Ic)throw 1===e.Ic?e.gc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.gc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ld}}function ud(e,t,n){return new sd({Ic:3,wc:t.settings.wc,methodName:e._methodName,Rc:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class hd extends Xh{_toFieldTransform(e){return new Ni(e.path,new Si)}isEqual(e){return e instanceof hd}}class dd extends Xh{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=ud(this,e,!0),n=this.Sc.map((e=>vd(e,t))),r=new ki(n);return new Ni(e.path,r)}isEqual(e){return e instanceof dd&&(0,c.bD)(this.Sc,e.Sc)}}class fd extends Xh{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=ud(this,e,!0),n=this.Sc.map((e=>vd(e,t))),r=new Pi(n);return new Ni(e.path,r)}isEqual(e){return e instanceof fd&&(0,c.bD)(this.Sc,e.Sc)}}class pd extends Xh{constructor(e,t){super(e),this.Dc=t}_toFieldTransform(e){const t=new Oi(e.serializer,bi(e.serializer,this.Dc));return new Ni(e.path,t)}isEqual(e){return e instanceof pd&&this.Dc===e.Dc}}function gd(e,t,n,r){const i=e.bc(1,t,n);bd("Data must be an object, but it was:",i,r);const s=[],o=ar.empty();on(r,((e,r)=>{const a=Td(t,e,n);r=(0,c.Ku)(r);const l=i.mc(a);if(r instanceof ld)s.push(a);else{const e=vd(r,l);null!=e&&(s.push(a),o.set(a,e))}}));const a=new pn(s);return new rd(o,a,i.fieldTransforms)}function md(e,t,n,r,i,s){const o=e.bc(1,t,n),a=[Ed(t,r,n)],l=[i];if(s.length%2!=0)throw new U(F.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let c=0;c<s.length;c+=2)a.push(Ed(t,s[c])),l.push(s[c+1]);const u=[],h=ar.empty();for(let f=a.length-1;f>=0;--f)if(!Sd(u,a[f])){const e=a[f];let t=l[f];t=(0,c.Ku)(t);const n=o.mc(e);if(t instanceof ld)u.push(e);else{const r=vd(t,n);null!=r&&(u.push(e),h.set(e,r))}}const d=new pn(u);return new rd(h,d,o.fieldTransforms)}function _d(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return vd(n,e.bc(r?4:3,t))}function vd(e,t){if(wd(e=(0,c.Ku)(e)))return bd("Unsupported field value:",t,e),yd(e,t);if(e instanceof Xh)return function(e,t){if(!id(t.Ic))throw t.gc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.gc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Rc&&4!==t.Ic)throw t.gc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=vd(i,t.fc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,c.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return bi(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=se.fromDate(e);return{timestampValue:Cs(t.serializer,n)}}if(e instanceof se){const n=new se(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Cs(t.serializer,n)}}if(e instanceof Zh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof $h)return{bytesValue:Ss(t.serializer,e._byteString)};if(e instanceof Ch){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.gc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Ps(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof ed)return function(e,t){return{mapValue:{fields:{[Dn]:{stringValue:Mn},[Ln]:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.gc("VectorValues must only contain numeric values.");return yi(t.serializer,e)}))}}}}}}(e,t);throw t.gc("Unsupported field value: ".concat(mh(e)))}(e,t)}function yd(e,t){const n={};return an(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):on(e,((e,r)=>{const i=vd(r,t.Ac(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function wd(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof se||e instanceof Zh||e instanceof $h||e instanceof Ch||e instanceof Xh||e instanceof ed)}function bd(e,t,n){if(!wd(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=mh(n);throw"an object"===r?t.gc(e+" a custom object"):t.gc(e+" "+r)}}function Ed(e,t,n){if((t=(0,c.Ku)(t))instanceof Jh)return t._internalPath;if("string"==typeof t)return Td(e,t);throw Cd("Field path arguments must be of type string or ",e,!1,void 0,n)}const Id=new RegExp("[~\\*/\\[\\]]");function Td(e,t,n){if(t.search(Id)>=0)throw Cd("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Jh(...t.split("."))._internalPath}catch(r){throw Cd("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Cd(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=" in field ".concat(r)),o&&(c+=" in document ".concat(i)),c+=")"),new U(F.INVALID_ARGUMENT,a+e+c)}function Sd(e,t){return e.some((e=>e.isEqual(t)))}class kd{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ch(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new xd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Pd("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class xd extends kd{data(){return super.data()}}function Pd(e,t){return"string"==typeof t?Td(e,t):t instanceof Jh?t._internalPath:t._delegate._internalPath}function Ad(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new U(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Od{}class Dd extends Od{}function Rd(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof Od&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof Ld)).length,n=e.filter((e=>e instanceof Nd)).length;if(t>1||t>0&&n>0)throw new U(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class Nd extends Dd{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Nd(e,t,n)}_apply(e){const t=this._parse(e);return Jd(e._query,t),new Th(e.firestore,e.converter,$r(e._query,t))}_parse(e){const t=ad(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new U(F.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){$d(o,s);const t=[];for(const n of o)t.push(Yd(r,e,n));a={arrayValue:{values:t}}}else a=Yd(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||$d(o,s),a=_d(n,t,o,"in"===s||"not-in"===s);return mr.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Md(e,t,n){const r=t,i=Pd("where",e);return Nd._create(i,r,n)}class Ld extends Od{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ld(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:_r.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Jd(n,i),n=$r(n,i)}(e._query,t),new Th(e.firestore,e.converter,$r(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Fd extends Dd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Fd(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new U(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new U(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fr(t,n)}(e._query,this._field,this._direction);return new Th(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Vr(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Ud(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Pd("orderBy",e);return Fd._create(n,t)}class jd extends Dd{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new jd(e,t,n)}_apply(e){return new Th(e.firestore,e.converter,Jr(e._query,this._limit,this._limitType))}}function Bd(e){return vh("limit",e),jd._create("limit",e,"F")}function qd(e){return vh("limitToLast",e),jd._create("limitToLast",e,"L")}class Vd extends Dd{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Vd(e,t,n)}_apply(e){const t=Qd(e,this.type,this._docOrFields,this._inclusive);return new Th(e.firestore,e.converter,function(e,t){return new Vr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function Kd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Vd._create("startAt",t,!0)}function zd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Vd._create("startAfter",t,!1)}class Wd extends Dd{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Wd(e,t,n)}_apply(e){const t=Qd(e,this.type,this._docOrFields,this._inclusive);return new Th(e.firestore,e.converter,function(e,t){return new Vr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function Hd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Wd._create("endBefore",t,!1)}function Gd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Wd._create("endAt",t,!0)}function Qd(e,t,n,r){if(n[0]=(0,c.Ku)(n[0]),n[0]instanceof kd)return function(e,t,n,r,i){if(!r)throw new U(F.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));const s=[];for(const o of Gr(e))if(o.field.isKeyField())s.push(Gn(t,r.key));else{const e=r.data.field(o.field);if(Sn(e))throw new U(F.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new U(F.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}s.push(e)}return new ur(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=ad(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new U(F.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const a=[];for(let c=0;c<i.length;c++){const s=i[c];if(o[c].field.isKeyField()){if("string"!=typeof s)throw new U(F.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof s));if(!Hr(e)&&-1!==s.indexOf("/"))throw new U(F.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(s,"' contains a slash."));const n=e.path.child(le.fromString(s));if(!de.isDocumentKey(n))throw new U(F.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(n,"' is not because it contains an odd number of segments."));const i=new de(n);a.push(Gn(t,i))}else{const e=_d(n,r,s);a.push(e)}}return new ur(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Yd(e,t,n){if("string"==typeof(n=(0,c.Ku)(n))){if(""===n)throw new U(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Hr(t)&&-1!==n.indexOf("/"))throw new U(F.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(le.fromString(n));if(!de.isDocumentKey(r))throw new U(F.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Gn(e,new de(r))}if(n instanceof Ch)return Gn(e,n._key);throw new U(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(mh(n),"."))}function $d(e,t){if(!Array.isArray(e)||0===e.length)throw new U(F.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Jd(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new U(F.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new U(F.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class Xd{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Un(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(bn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw D(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return on(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[Ln].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>wn(e.doubleValue)));return new ed(i)}convertGeoPoint(e){return new Zh(wn(e.latitude),wn(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=kn(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(xn(e));default:return null}}convertTimestamp(e){const t=yn(e);return new se(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=le.fromString(e);N(Zs(n),9688,{name:e});const r=new On(n.get(1),n.get(3)),i=new de(n.popFirst(5));return r.isEqual(t)||P("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function Zd(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class ef extends Xd{constructor(e){super(),this.firestore=e}convertBytes(e){return new $h(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ch(this.firestore,null,t)}}class tf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nf extends kd{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new rf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Pd("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class rf extends nf{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class sf{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new tf(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new rf(this._firestore,this._userDataWriter,n.key,n,new tf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new U(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new rf(e._firestore,e._userDataWriter,n.doc.key,n.doc,new tf(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new rf(e._firestore,e._userDataWriter,t.doc.key,t.doc,new tf(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:of(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function of(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return D(61501,{type:e})}}function af(e,t){return e instanceof nf&&t instanceof nf?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof sf&&t instanceof sf&&e._firestore===t._firestore&&Oh(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function cf(e){e=_h(e,Ch);const t=_h(e.firestore,Uh);return ah(jh(t),e._key).then((n=>Ef(t,e,n)))}class lf extends Xd{constructor(e){super(),this.firestore=e}convertBytes(e){return new $h(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ch(this.firestore,null,t)}}function uf(e){e=_h(e,Ch);const t=_h(e.firestore,Uh),n=jh(t),r=new lf(t);return function(e,t){const n=new j;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=L(e);return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new U(F.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=Ll(e,"Failed to get document '".concat(t," from cache"));n.reject(r)}}(await nh(e),t,n))),n.promise}(n,e._key).then((n=>new nf(t,r,e._key,n,new tf(null!==n&&n.hasLocalMutations,!0),e.converter)))}function hf(e){e=_h(e,Ch);const t=_h(e.firestore,Uh);return ah(jh(t),e._key,{source:"server"}).then((n=>Ef(t,e,n)))}function df(e){e=_h(e,Th);const t=_h(e.firestore,Uh),n=jh(t),r=new lf(t);return Ad(e._query),ch(n,e._query).then((n=>new sf(t,r,e,n)))}function ff(e){e=_h(e,Th);const t=_h(e.firestore,Uh),n=jh(t),r=new lf(t);return function(e,t){const n=new j;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await _c(e,t,!0),i=new ru(t,r.$s),s=i.tu(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=Ll(e,"Failed to execute query '".concat(t," against cache"));n.reject(r)}}(await nh(e),t,n))),n.promise}(n,e._query).then((n=>new sf(t,r,e,n)))}function pf(e){e=_h(e,Th);const t=_h(e.firestore,Uh),n=jh(t),r=new lf(t);return ch(n,e._query,{source:"server"}).then((n=>new sf(t,r,e,n)))}function gf(e,t,n){e=_h(e,Ch);const r=_h(e.firestore,Uh),i=Zd(e.converter,t,n);return bf(r,[cd(ad(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Li.none())])}function mf(e,t,n){e=_h(e,Ch);const r=_h(e.firestore,Uh),i=ad(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=(0,c.Ku)(t))||t instanceof Jh?md(i,"updateDoc",e._key,t,n,a):gd(i,"updateDoc",e._key,t),bf(r,[s.toMutation(e._key,Li.exists(!0))])}function _f(e){return bf(_h(e.firestore,Uh),[new Yi(e._key,Li.none())])}function vf(e,t){const n=_h(e.firestore,Uh),r=Ph(e),i=Zd(e.converter,t);return bf(n,[cd(ad(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Li.exists(!1))]).then((()=>r))}function yf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=(0,c.Ku)(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||Mh(n[l])||(a=n[l],l++);const u={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Mh(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let h,d,f;if(e instanceof Ch)d=_h(e.firestore,Uh),f=zr(e._key.path),h={next:t=>{n[l]&&n[l](Ef(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=_h(e,Th);d=_h(t.firestore,Uh),f=t._query;const r=new lf(d);h={next:e=>{n[l]&&n[l](new sf(d,r,t,e))},error:n[l+1],complete:n[l+2]},Ad(e._query)}return function(e,t,n,r){const i=new Wu(r),s=new $l(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Kl(await oh(e),s))),()=>{i.xu(),e.asyncQueue.enqueueAndForget((async()=>zl(await oh(e),s)))}}(jh(d),f,u,h)}function wf(e,t){return function(e,t){const n=new Wu(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){L(e).Ca.add(t),t.next()}(await oh(e),n))),()=>{n.xu(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){L(e).Ca.delete(t)}(await oh(e),n)))}}(jh(e=_h(e,Uh)),Mh(t)?t:{next:t})}function bf(e,t){return function(e,t){const n=new j;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Uu(e);try{const e=await function(e,t){const n=L(e),r=se.now(),i=t.reduce(((e,t)=>e.add(t.key)),mi());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=ai(),c=mi();return n.Bs.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=Vi(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Wi(e.key,t,cr(t.value.mapValue),Li.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:ui(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Au[e.currentUser.toKey()];r||(r=new cn(J)),r=r.insert(t,n),e.Au[e.currentUser.toKey()]=r}(r,e.batchId,n),await Su(r,e.changes),await El(r.remoteStore)}catch(e){const t=Ll(e,"Failed to persist write");n.reject(t)}}(await ih(e),t,n))),n.promise}(jh(e),t)}function Ef(e,t,n){const r=n.docs.get(t._key),i=new lf(e);return new nf(e,i,t._key,r,new tf(n.hasPendingWrites,n.fromCache),t.converter)}const If={maxAttempts:5};class Tf{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ad(e)}set(e,t,n){this._verifyNotCommitted();const r=Cf(e,this._firestore),i=Zd(r.converter,t,n),s=cd(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Li.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Cf(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=(0,c.Ku)(t))||t instanceof Jh?md(this._dataReader,"WriteBatch.update",r._key,t,n,o):gd(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,Li.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Cf(e,this._firestore);return this._mutations=this._mutations.concat(new Yi(t._key,Li.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new U(F.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Cf(e,t){if((e=(0,c.Ku)(e)).firestore!==t)throw new U(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Sf{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=ad(e)}get(e){const t=Cf(e,this._firestore),n=new ef(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return D(24041);const r=e[0];if(r.isFoundDocument())return new kd(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new kd(this._firestore,n,t._key,null,t.converter);throw D(18433,{doc:r})}))}set(e,t,n){const r=Cf(e,this._firestore),i=Zd(r.converter,t,n),s=cd(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n){const r=Cf(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=(0,c.Ku)(t))||t instanceof Jh?md(this._dataReader,"Transaction.update",r._key,t,n,o):gd(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,i),this}delete(e){const t=Cf(e,this._firestore);return this._transaction.delete(t._key),this}}class kf extends Sf{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Cf(e,this._firestore),n=new lf(this._firestore);return super.get(e).then((e=>new nf(this._firestore,n,t._key,e._document,new tf(!1,!1),t.converter)))}}function xf(e,t,n){e=_h(e,Uh);const r=Object.assign(Object.assign({},If),n);return function(e){if(e.maxAttempts<1)throw new U(F.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new j;return e.asyncQueue.enqueueAndForget((async()=>{const i=await sh(e);new Qu(e.asyncQueue,i,n,t,r).Wu()})),r.promise}(jh(e),(n=>t(new kf(e,n))),r)}function Pf(){return new ld("deleteField")}function Af(){return new hd("serverTimestamp")}function Of(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new dd("arrayUnion",t)}function Df(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new fd("arrayRemove",t)}function Rf(e){return new pd("increment",e)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){T=e}(s.SDK_VERSION),(0,s._registerComponent)(new o.uA("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new Uh(new K(e.getProvider("auth-internal")),new G(s,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new U(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new On(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),(0,s.registerVersion)(b,E,e),(0,s.registerVersion)(b,E,"esm2017")}()},846:(e,t,n)=>{n.d(t,{Ve:()=>cn});var r=n(579),i=n(43);const s="abcdefgh".split(""),o={a8:"bR",b8:"bN",c8:"bB",d8:"bQ",e8:"bK",f8:"bB",g8:"bN",h8:"bR",a7:"bP",b7:"bP",c7:"bP",d7:"bP",e7:"bP",f7:"bP",g7:"bP",h7:"bP",a2:"wP",b2:"wP",c2:"wP",d2:"wP",e2:"wP",f2:"wP",g2:"wP",h2:"wP",a1:"wR",b1:"wN",c1:"wB",d1:"wQ",e1:"wK",f1:"wB",g1:"wN",h1:"wR"},a={a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},c={a:7,b:6,c:5,d:4,e:3,f:2,g:1,h:0},l=[7,6,5,4,3,2,1,0],u=[0,1,2,3,4,5,6,7],h={wP:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsx)("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),wR:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,r.jsx)("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),(0,r.jsx)("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),(0,r.jsx)("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",style:{strokeLinecap:"butt"}}),(0,r.jsx)("path",{d:"M 34,14 L 31,17 L 14,17 L 11,14"}),(0,r.jsx)("path",{d:"M 31,17 L 31,29.5 L 14,29.5 L 14,17",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"}),(0,r.jsx)("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wN:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,r.jsx)("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#ffffff",stroke:"#000000"}}),(0,r.jsx)("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#ffffff",stroke:"#000000"}}),(0,r.jsx)("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#000000",stroke:"#000000"}}),(0,r.jsx)("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#000000",stroke:"#000000"}})]}))})),wB:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,r.jsxs)("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt"}},{children:[(0,r.jsx)("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),(0,r.jsx)("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),(0,r.jsx)("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),(0,r.jsx)("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wQ:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeWidth:"1.5",strokeLinejoin:"round"}},{children:[(0,r.jsx)("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"}),(0,r.jsx)("path",{d:"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"}),(0,r.jsx)("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30",style:{fill:"none"}}),(0,r.jsx)("path",{d:"M 12,33.5 C 18,32.5 27,32.5 33,33.5",style:{fill:"none"}}),(0,r.jsx)("circle",{cx:"6",cy:"12",r:"2"}),(0,r.jsx)("circle",{cx:"14",cy:"9",r:"2"}),(0,r.jsx)("circle",{cx:"22.5",cy:"8",r:"2"}),(0,r.jsx)("circle",{cx:"31",cy:"9",r:"2"}),(0,r.jsx)("circle",{cx:"39",cy:"12",r:"2"})]}))})),wK:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,r.jsx)("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#ffffff",stroke:"#000000"}}),(0,r.jsx)("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30",style:{fill:"none",stroke:"#000000"}}),(0,r.jsx)("path",{d:"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5",style:{fill:"none",stroke:"#000000"}}),(0,r.jsx)("path",{d:"M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#000000"}})]}))})),bP:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsx)("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),bR:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,r.jsx)("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),(0,r.jsx)("path",{d:"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",style:{strokeLinecap:"butt"}}),(0,r.jsx)("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),(0,r.jsx)("path",{d:"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",style:{strokeLinecap:"butt"}}),(0,r.jsx)("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",style:{strokeLinecap:"butt"}}),(0,r.jsx)("path",{d:"M 12,35.5 L 33,35.5 L 33,35.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 13,31.5 L 32,31.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 14,29.5 L 31,29.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 14,16.5 L 31,16.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}})]}))})),bN:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,r.jsx)("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#000000",stroke:"#000000"}}),(0,r.jsx)("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#000000",stroke:"#000000"}}),(0,r.jsx)("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#ffffff",stroke:"#ffffff"}}),(0,r.jsx)("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#ffffff",stroke:"#ffffff"}}),(0,r.jsx)("path",{d:"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",style:{fill:"#ffffff",stroke:"none"}})]}))})),bB:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,r.jsxs)("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeLinecap:"butt"}},{children:[(0,r.jsx)("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),(0,r.jsx)("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),(0,r.jsx)("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),(0,r.jsx)("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#ffffff",strokeLinejoin:"miter"}})]}))})),bQ:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}},{children:[(0,r.jsx)("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z",style:{strokeLinecap:"butt",fill:"#000000"}}),(0,r.jsx)("path",{d:"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z"}),(0,r.jsx)("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30"}),(0,r.jsx)("path",{d:"m 12,33.5 c 6,-1 15,-1 21,0"}),(0,r.jsx)("circle",{cx:"6",cy:"12",r:"2"}),(0,r.jsx)("circle",{cx:"14",cy:"9",r:"2"}),(0,r.jsx)("circle",{cx:"22.5",cy:"8",r:"2"}),(0,r.jsx)("circle",{cx:"31",cy:"9",r:"2"}),(0,r.jsx)("circle",{cx:"39",cy:"12",r:"2"}),(0,r.jsx)("path",{d:"M 11,38.5 A 35,35 1 0 0 34,38.5",style:{fill:"none",stroke:"#000000",strokeLinecap:"butt"}}),(0,r.jsxs)("g",Object.assign({style:{fill:"none",stroke:"#ffffff"}},{children:[(0,r.jsx)("path",{d:"M 11,29 A 35,35 1 0 1 34,29"}),(0,r.jsx)("path",{d:"M 12.5,31.5 L 32.5,31.5"}),(0,r.jsx)("path",{d:"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"}),(0,r.jsx)("path",{d:"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"})]}))]}))})),bK:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,r.jsxs)("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,r.jsx)("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"},id:"path6570"}),(0,r.jsx)("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#000000",fillOpacity:"1",strokeLinecap:"butt",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#000000",stroke:"#000000"}}),(0,r.jsx)("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),(0,r.jsx)("path",{d:"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5",style:{fill:"none",stroke:"#ffffff"}}),(0,r.jsx)("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#ffffff"}})]}))}))};function d(e,t,n){const r=t/8,i="white"===e?l:u;return{x:("white"===e?a:c)[n[0]]*r+r/2,y:i[parseInt(n[1],10)-1]*r+r/2}}function f(e){let t=!1;return Object.keys(o).forEach((n=>{e[n]!==o[n]&&(t=!0)})),Object.keys(e).forEach((n=>{o[n]!==e[n]&&(t=!0)})),t}function p(e){return"start"===e?o:"string"===typeof e?function(e){if(!function(e){e=e.replace(/ .+$/,""),e=function(e){return e.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")}(e);const t=e.split("/");if(8!==t.length)return!1;for(let n=0;n<8;n++)if(8!==t[n].length||-1!==t[n].search(/[^kqrnbpKQRNBP1]/))return!1;return!0}(e))return{};const t=(e=e.replace(/ .+$/,"")).split("/"),n={};let r=8;for(let i=0;i<8;i++){const e=t[i].split("");let o=0;for(let t=0;t<e.length;t++)if(-1!==e[t].search(/[1-8]/)){o+=parseInt(e[t],10)}else{n[s[o]+r]=g(e[t]),o+=1}r-=1}return n}(e):e}function g(e){return e.toLowerCase()===e?"b"+e.toUpperCase():"w"+e.toUpperCase()}const m=(0,i.createContext)({}),_=()=>(0,i.useContext)(m),v=(0,i.forwardRef)(((e,t)=>{let{allowDragOutsideBoard:n=!0,animationDuration:s=300,areArrowsAllowed:o=!0,arePiecesDraggable:a=!0,arePremovesAllowed:c=!1,autoPromoteToQueen:l=!1,boardOrientation:u="white",boardWidth:d,children:g,clearPremovesOnRightClick:_=!0,customArrows:v,customArrowColor:y="rgb(255,170,0)",customBoardStyle:w,customNotationStyle:b,customDarkSquareStyle:E={backgroundColor:"#B58863"},customDropSquareStyle:I={boxShadow:"inset 0 0 1px 6px rgba(255,255,255,0.75)"},customLightSquareStyle:T={backgroundColor:"#F0D9B5"},customPieces:C,customPremoveDarkSquareStyle:S={backgroundColor:"#A42323"},customPremoveLightSquareStyle:k={backgroundColor:"#BD2828"},customSquare:x="div",customSquareStyles:P,dropOffBoardAction:A="snapback",id:O=0,isDraggablePiece:D=()=>!0,getPositionObject:R=()=>{},onArrowsChange:N=()=>{},onDragOverSquare:M=()=>{},onMouseOutSquare:L=()=>{},onMouseOverSquare:F=()=>{},onPieceClick:U=()=>{},onPieceDragBegin:j=()=>{},onPieceDragEnd:B=()=>{},onPieceDrop:q=()=>!0,onPieceDropOffBoard:V=()=>{},onPromotionCheck:K=(e,t,n)=>("wP"===n&&"7"===e[1]&&"8"===t[1]||"bP"===n&&"2"===e[1]&&"1"===t[1])&&Math.abs(e.charCodeAt(0)-t.charCodeAt(0))<=1,onPromotionPieceSelect:z=()=>!0,onSparePieceDrop:W=()=>!0,onSquareClick:H=()=>{},onSquareRightClick:G=()=>{},position:Q="start",promotionDialogVariant:Y="default",promotionToSquare:$=null,showBoardNotation:J=!0,showPromotionDialog:X=!1,snapToCursor:Z=!0}=e;const[ee,te]=(0,i.useState)(p(Q)),[ne,re]=(0,i.useState)({removed:{},added:{}}),[ie,se]=(0,i.useState)(void 0),[oe,ae]=(0,i.useState)(X&&!l),[ce,le]=(0,i.useState)(null),[ue,he]=(0,i.useState)($),[de,fe]=(0,i.useState)([]),pe=(0,i.useRef)(de),[ge,me]=(0,i.useState)(),[_e,ve]=(0,i.useState)(Object.assign(Object.assign({},h),C)),[ye,we]=(0,i.useState)(!1),be=(0,i.useRef)(),[Ee,Ie]=(0,i.useState)(!1),[Te,Ce]=(0,i.useState)(null);(0,i.useImperativeHandle)(t,(()=>({clearPremoves(){De(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])}}))),(0,i.useEffect)((()=>{ve(Object.assign(Object.assign({},h),C))}),[C]),(0,i.useEffect)((()=>{ae(X),he($)}),[$,X]),(0,i.useEffect)((()=>{var e,t,n;Re();const r=p(Q),i=function(e,t){const n={removed:{},added:{}};return Object.keys(e).forEach((r=>{t[r]!==e[r]&&(n.removed[r]=e[r])})),Object.keys(t).forEach((r=>{e[r]!==t[r]&&(n.added[r]=t[r])})),n}(ee,r),o=(null===(e=Object.keys(i.added))||void 0===e?void 0:e.length)<=2?null===(n=null===(t=Object.entries(i.added))||void 0===t?void 0:t[0])||void 0===n?void 0:n[1][0]:void 0;if(Ee)te(r),Ie(!1),c&&Oe(o),be.current&&clearTimeout(be.current);else if(ye)te(r),Ie(!1),c&&Oe(o);else{f(r)&&void 0!==ie?se(o):f(r)?se(void 0):se("b"),re(i),Ie(!0);const e=setTimeout((()=>{te(r),Ie(!1),c&&Oe(o)}),s);be.current=e}return we(!1),R(r),xe(),()=>{clearTimeout(be.current)}}),[Q]);const{arrows:Se,newArrow:ke,clearArrows:xe,drawNewArrow:Pe,onArrowDrawEnd:Ae}=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const[s,o]=(0,i.useState)([]),[a,c]=(0,i.useState)([]),[l,u]=(0,i.useState)();function h(){c([]),u(void 0)}(0,i.useEffect)((()=>{Array.isArray(e)&&(h(),o(null===e||void 0===e?void 0:e.filter((e=>e[0]!==e[1]))))}),[e]),(0,i.useEffect)((()=>{null===n||void 0===n||n(a)}),[a]);const d=[...a,...s];return{arrows:d,newArrow:l,clearArrows:h,drawNewArrow:(e,n)=>{t&&u([e,n,r])},setArrows:c,onArrowDrawEnd:(e,n)=>{if(e===n||!t)return;let i;const s=[e,n,r];i=d.every((t=>{let[r,i]=t;return!(r===e&&i===n)}))?[...a,s]:a.filter((t=>{let[r,i]=t;return!(r===e&&i===n)})),u(void 0),c(i)}}}(v,o,N,y);function Oe(e){if(0===pe.current.length)return;const t=pe.current[0];if(void 0!==t.piece[0]&&t.piece[0]!==e&&q.length){se(t.piece[0]),we(!0);if(q(t.sourceSq,t.targetSq,t.piece)){const e=[...pe.current];e.shift(),pe.current=e,fe([...e])}else De()}}function De(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&se(void 0),pe.current=[],fe([])}function Re(){le(null),he(null),ae(!1)}const Ne={allowDragOutsideBoard:n,animationDuration:s,arePiecesDraggable:a,arePremovesAllowed:c,arrows:Se,autoPromoteToQueen:l,boardOrientation:u,boardWidth:d,chessPieces:_e,clearArrows:xe,clearCurrentRightClickDown:function(){me(void 0)},currentPosition:ee,currentRightClickDown:ge,customArrowColor:y,customBoardStyle:w,customDarkSquareStyle:E,customDropSquareStyle:I,customLightSquareStyle:T,customNotationStyle:b,customPremoveDarkSquareStyle:S,customPremoveLightSquareStyle:k,customSquare:x,customSquareStyles:P,deletePieceFromSquare:function(e){const t=Object.assign({},ee);delete t[e],te(t),R(t)},drawNewArrow:Pe,dropOffBoardAction:A,handleSetPosition:function(e,t,n,r){if(e===t)return;if(xe(),c&&Ee||c&&(ie===n[0]||pe.current.filter((e=>e.piece[0]===n[0])).length>0)){const r=[...pe.current];return r.push({sourceSq:e,targetSq:t,piece:n}),pe.current=r,fe([...r]),void Re()}if(!c&&Ee)return;const i=Object.assign({},ee);if(we(!!r),se(n[0]),q.length){q(e,t,n)||(De(),we(!1))}else delete i[e],i[t]=n,te(i);Re(),R(i)},handleSparePieceDrop:function(e,t){if(!W(e,t))return;const n=Object.assign({},ee);n[t]=e,te(n),R(n)},id:O,isDraggablePiece:D,isWaitingForAnimation:Ee,lastPieceColour:ie,lastSquareDraggedOver:Te,newArrow:ke,onArrowDrawEnd:Ae,onDragOverSquare:M,onMouseOutSquare:L,onMouseOverSquare:F,onPieceClick:U,onPieceDragBegin:j,onPieceDragEnd:B,onPieceDrop:q,onPieceDropOffBoard:V,onPromotionCheck:K,onPromotionPieceSelect:z,onRightClickDown:function(e){me(e)},onRightClickUp:function(e){if(ge){if(ge===e)return me(void 0),_&&De(!1),void G(e)}else me(void 0)},onSparePieceDrop:W,onSquareClick:H,positionDifferences:ne,premoves:de,promoteFromSquare:ce,promoteToSquare:ue,promotionDialogVariant:Y,setLastSquareDraggedOver:Ce,setPromoteFromSquare:le,setPromoteToSquare:he,setShowPromoteDialog:ae,showBoardNotation:J,showPromoteDialog:oe,snapToCursor:Z};return(0,r.jsx)(m.Provider,Object.assign({value:Ne},{children:g}))}));function y(e){let{row:t,col:n}=e;const{boardOrientation:i,boardWidth:o,customDarkSquareStyle:a,customLightSquareStyle:c,customNotationStyle:l}=_(),u=c.backgroundColor,h=a.backgroundColor,d=0===n,f=7===t;function p(){return"white"===i?8-t:t+1}function g(){return"black"===i?s[7-n]:s[n]}return d&&f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:u}),b(o,l))},{children:p()})),(0,r.jsx)("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:u}),w(o,l))},{children:g()}))]}):f?(0,r.jsx)("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},{color:n%2!==0?h:u}),w(o,l))},{children:g()})):d?(0,r.jsx)("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},{color:t%2===0?h:u}),b(o,l))},{children:p()})):null}const w=(e,t)=>Object.assign({alignSelf:"flex-end",paddingLeft:e/8-e/48,fontSize:e/48},t),b=(e,t)=>Object.assign({alignSelf:"flex-start",paddingRight:e/8-e/48,fontSize:e/48},t),E=(0,i.createContext)({dragDropManager:void 0});function I(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var T="function"===typeof Symbol&&Symbol.observable||"@@observable",C=function(){return Math.random().toString(36).substring(7).split("").join(".")},S={INIT:"@@redux/INIT"+C(),REPLACE:"@@redux/REPLACE"+C(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+C()}};function k(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(I(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(I(1));return n(k)(e,t)}if("function"!==typeof e)throw new Error(I(2));var i=e,s=t,o=[],a=o,c=!1;function l(){a===o&&(a=o.slice())}function u(){if(c)throw new Error(I(3));return s}function h(e){if("function"!==typeof e)throw new Error(I(4));if(c)throw new Error(I(5));var t=!0;return l(),a.push(e),function(){if(t){if(c)throw new Error(I(6));t=!1,l();var n=a.indexOf(e);a.splice(n,1),o=null}}}function d(e){if(!function(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(I(7));if("undefined"===typeof e.type)throw new Error(I(8));if(c)throw new Error(I(9));try{c=!0,s=i(s,e)}finally{c=!1}for(var t=o=a,n=0;n<t.length;n++){(0,t[n])()}return e}return d({type:S.INIT}),(r={dispatch:d,subscribe:h,getState:u,replaceReducer:function(e){if("function"!==typeof e)throw new Error(I(10));i=e,d({type:S.REPLACE})}})[T]=function(){var e,t=h;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(I(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[T]=function(){return this},e},r}function x(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if("undefined"!==typeof process&&void 0===t)throw new Error("invariant requires an error message argument");if(!e){let e;if(void 0===t)e=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let n=0;e=new Error(t.replace(/%s/g,(function(){return r[n++]}))),e.name="Invariant Violation"}throw e.framesToPop=1,e}}function P(e){return"object"===typeof e}const A="dnd-core/INIT_COORDS",O="dnd-core/BEGIN_DRAG",D="dnd-core/PUBLISH_DRAG_SOURCE",R="dnd-core/HOVER",N="dnd-core/DROP",M="dnd-core/END_DRAG";function L(e,t){return{type:A,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}const F={type:A,payload:{clientOffset:null,sourceClientOffset:null}};function U(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0};const{publishSource:r=!0,clientOffset:i,getSourceClientOffset:s}=n,o=e.getMonitor(),a=e.getRegistry();e.dispatch(L(i)),function(e,t,n){x(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach((function(e){x(n.getSource(e),"Expected sourceIds to be registered.")}))}(t,o,a);const c=function(e,t){let n=null;for(let r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}(t,o);if(null==c)return void e.dispatch(F);let l=null;if(i){if(!s)throw new Error("getSourceClientOffset must be defined");!function(e){x("function"===typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(s),l=s(c)}e.dispatch(L(i,l));const u=a.getSource(c).beginDrag(o,c);if(null==u)return;!function(e){x(P(e),"Item must be an object.")}(u),a.pinSource(c);const h=a.getSourceType(c);return{type:O,payload:{itemType:h,item:u,sourceId:c,clientOffset:i||null,sourceClientOffset:l||null,isSourcePublic:!!r}}}}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){j(e,t,n[t])}))}return e}function q(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=e.getMonitor(),r=e.getRegistry();!function(e){x(e.isDragging(),"Cannot call drop while not dragging."),x(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);const i=function(e){const t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);i.forEach(((i,s)=>{const o=function(e,t,n,r){const i=n.getTarget(e);let s=i?i.drop(r,e):void 0;(function(e){x("undefined"===typeof e||P(e),"Drop result must either be an object or undefined.")})(s),"undefined"===typeof s&&(s=0===t?{}:r.getDropResult());return s}(i,s,r,n),a={type:N,payload:{dropResult:B({},t,o)}};e.dispatch(a)}))}}function V(e){return function(){const t=e.getMonitor(),n=e.getRegistry();!function(e){x(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);const r=t.getSourceId();if(null!=r){n.getSource(r,!0).endDrag(t,r),n.unpinSource()}return{type:M}}}function K(e,t){return null===t?null===e:Array.isArray(e)?e.some((e=>e===t)):e===t}function z(e){return function(t){let{clientOffset:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e){x(Array.isArray(e),"Expected targetIds to be an array.")}(t);const r=t.slice(0),i=e.getMonitor(),s=e.getRegistry();return function(e,t,n){for(let r=e.length-1;r>=0;r--){const i=e[r];K(t.getTargetType(i),n)||e.splice(r,1)}}(r,s,i.getItemType()),function(e,t,n){x(t.isDragging(),"Cannot call hover while not dragging."),x(!t.didDrop(),"Cannot call hover after drop.");for(let r=0;r<e.length;r++){const t=e[r];x(e.lastIndexOf(t)===r,"Expected targetIds to be unique in the passed array.");x(n.getTarget(t),"Expected targetIds to be registered.")}}(r,i,s),function(e,t,n){e.forEach((function(e){n.getTarget(e).hover(t,e)}))}(r,i,s),{type:R,payload:{targetIds:r,clientOffset:n||null}}}}function W(e){return function(){if(e.getMonitor().isDragging())return{type:D}}}class H{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:t}=this.store;const n=function(e){return{beginDrag:U(e),publishDragSource:W(e),hover:z(e),drop:q(e),endDrag:V(e)}}(this);return Object.keys(n).reduce(((r,i)=>{const s=n[i];var o;return r[i]=(o=s,function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const s=o.apply(e,r);"undefined"!==typeof s&&t(s)}),r}),{})}dispatch(e){this.store.dispatch(e)}constructor(e,t){this.isSetUp=!1,this.handleRefCountChange=()=>{const e=this.store.getState().refCount>0;this.backend&&(e&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!e&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=t,e.subscribe(this.handleRefCountChange)}}function G(e,t){return{x:e.x-t.x,y:e.y-t.y}}const Q=[],Y=[];Q.__IS_NONE__=!0,Y.__IS_ALL__=!0;class ${subscribeToStateChange(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{handlerIds:n}=t;x("function"===typeof e,"listener must be a function."),x("undefined"===typeof n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");let r=this.store.getState().stateId;return this.store.subscribe((()=>{const t=this.store.getState(),i=t.stateId;try{const s=i===r||i===r+1&&!function(e,t){return e!==Q&&(e===Y||"undefined"===typeof t||(n=e,t.filter((e=>n.indexOf(e)>-1))).length>0);var n}(t.dirtyHandlerIds,n);s||e()}finally{r=i}}))}subscribeToOffsetChange(e){x("function"===typeof e,"listener must be a function.");let t=this.store.getState().dragOffset;return this.store.subscribe((()=>{const n=this.store.getState().dragOffset;n!==t&&(t=n,e())}))}canDragSource(e){if(!e)return!1;const t=this.registry.getSource(e);return x(t,"Expected to find a valid source. sourceId=".concat(e)),!this.isDragging()&&t.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const t=this.registry.getTarget(e);if(x(t,"Expected to find a valid target. targetId=".concat(e)),!this.isDragging()||this.didDrop())return!1;return K(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}isDragging(){return Boolean(this.getItemType())}isDraggingSource(e){if(!e)return!1;const t=this.registry.getSource(e,!0);if(x(t,"Expected to find a valid source. sourceId=".concat(e)),!this.isDragging()||!this.isSourcePublic())return!1;return this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}isOverTarget(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1};if(!e)return!1;const{shallow:n}=t;if(!this.isDragging())return!1;const r=this.registry.getTargetType(e),i=this.getItemType();if(i&&!K(r,i))return!1;const s=this.getTargetIds();if(!s.length)return!1;const o=s.indexOf(e);return n?o===s.length-1:o>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return function(e){const{clientOffset:t,initialClientOffset:n,initialSourceClientOffset:r}=e;return t&&n&&r?G((s=r,{x:(i=t).x+s.x,y:i.y+s.y}),n):null;var i,s}(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return function(e){const{clientOffset:t,initialClientOffset:n}=e;return t&&n?G(t,n):null}(this.store.getState().dragOffset)}constructor(e,t){this.store=e,this.registry=t}}const J="undefined"!==typeof n.g?n.g:self,X=J.MutationObserver||J.WebKitMutationObserver;function Z(e){return function(){const t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}const ee="function"===typeof X?function(e){let t=1;const n=new X(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}:Z;class te{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const ne=new class{enqueueTask(e){const{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=ee(this.flush),this.requestErrorThrow=Z((()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()}))}},re=new class{create(e){const t=this.freeTasks,n=t.length?t.pop():new te(this.onError,(e=>t[t.length]=e));return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}(ne.registerPendingError);const ie="dnd-core/ADD_SOURCE",se="dnd-core/ADD_TARGET",oe="dnd-core/REMOVE_SOURCE",ae="dnd-core/REMOVE_TARGET";function ce(e,t){t&&Array.isArray(e)?e.forEach((e=>ce(e,!1))):x("string"===typeof e||"symbol"===typeof e,t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var le;!function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(le||(le={}));let ue=0;function he(e){const t=(ue++).toString();switch(e){case le.SOURCE:return"S".concat(t);case le.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function de(e){switch(e[0]){case"S":return le.SOURCE;case"T":return le.TARGET;default:throw new Error("Cannot parse handler ID: ".concat(e))}}function fe(e,t){const n=e.entries();let r=!1;do{const{done:e,value:[,i]}=n.next();if(i===t)return!0;r=!!e}while(!r);return!1}class pe{addSource(e,t){ce(e),function(e){x("function"===typeof e.canDrag,"Expected canDrag to be a function."),x("function"===typeof e.beginDrag,"Expected beginDrag to be a function."),x("function"===typeof e.endDrag,"Expected endDrag to be a function.")}(t);const n=this.addHandler(le.SOURCE,e,t);return this.store.dispatch(function(e){return{type:ie,payload:{sourceId:e}}}(n)),n}addTarget(e,t){ce(e,!0),function(e){x("function"===typeof e.canDrop,"Expected canDrop to be a function."),x("function"===typeof e.hover,"Expected hover to be a function."),x("function"===typeof e.drop,"Expected beginDrag to be a function.")}(t);const n=this.addHandler(le.TARGET,e,t);return this.store.dispatch(function(e){return{type:se,payload:{targetId:e}}}(n)),n}containsHandler(e){return fe(this.dragSources,e)||fe(this.dropTargets,e)}getSource(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];x(this.isSourceId(e),"Expected a valid source ID.");return t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return x(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return x(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return x(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return de(e)===le.SOURCE}isTargetId(e){return de(e)===le.TARGET}removeSource(e){var t;x(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:oe,payload:{sourceId:e}}}(e)),t=()=>{this.dragSources.delete(e),this.types.delete(e)},ne.enqueueTask(re.create(t))}removeTarget(e){x(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:ae,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const t=this.getSource(e);x(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}unpinSource(){x(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,t,n){const r=he(e);return this.types.set(r,t),e===le.SOURCE?this.dragSources.set(r,n):e===le.TARGET&&this.dropTargets.set(r,n),r}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const ge=(e,t)=>e===t;function me(){let e=arguments.length>1?arguments[1]:void 0;switch(e.type){case R:break;case ie:case se:case ae:case oe:return Q;default:return Y}const{targetIds:t=[],prevTargetIds:n=[]}=e.payload,r=function(e,t){const n=new Map,r=e=>{n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(r),t.forEach(r);const i=[];return n.forEach(((e,t)=>{1===e&&i.push(t)})),i}(t,n),i=r.length>0||!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ge;if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}(t,n);if(!i)return Q;const s=n[n.length-1],o=t[t.length-1];return s!==o&&(s&&r.push(s),o&&r.push(o)),r}function _e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ve={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function ye(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;const{payload:n}=t;switch(t.type){case A:case O:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case R:return r=e.clientOffset,i=n.clientOffset,!r&&!i||r&&i&&r.x===i.x&&r.y===i.y?e:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_e(e,t,n[t])}))}return e}({},e,{clientOffset:n.clientOffset});case M:case N:return ve;default:return e}var r,i}function we(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){we(e,t,n[t])}))}return e}const Ee={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function Ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;const{payload:n}=t;switch(t.type){case O:return be({},e,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case D:return be({},e,{isSourcePublic:!0});case R:return be({},e,{targetIds:n.targetIds});case ae:return-1===e.targetIds.indexOf(n.targetId)?e:be({},e,{targetIds:(r=e.targetIds,i=n.targetId,r.filter((e=>e!==i)))});case N:return be({},e,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case M:return be({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}var r,i}function Te(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1?arguments[1]:void 0).type){case ie:case se:return e+1;case oe:case ae:return e-1;default:return e}}function Ce(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Se(e,t,n[t])}))}return e}function xe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:me(e.dirtyHandlerIds,{type:t.type,payload:ke({},t.payload,{prevTargetIds:(n=e,r="dragOperation.targetIds",i=[],r.split(".").reduce(((e,t)=>e&&e[t]?e[t]:i||null),n))})}),dragOffset:ye(e.dragOffset,t),refCount:Te(e.refCount,t),dragOperation:Ie(e.dragOperation,t),stateId:Ce(e.stateId)};var n,r,i}function Pe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=function(e){const t="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return k(xe,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(arguments.length>3&&void 0!==arguments[3]&&arguments[3]),i=new $(r,new pe(r)),s=new H(r,i),o=e(s,t,n);return s.receiveBackend(o),s}function Ae(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}let Oe=0;const De=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var Re=(0,i.memo)((function(e){var{children:t}=e,n=Ae(e,["children"]);const[s,o]=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ne(),n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const i=t;i[De]||(i[De]={dragDropManager:Pe(e,t,n,r)});return i[De]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(n);return(0,i.useEffect)((()=>{if(o){const e=Ne();return++Oe,()=>{0===--Oe&&(e[De]=null)}}}),[]),(0,r.jsx)(E.Provider,{value:s,children:t})}));function Ne(){return"undefined"!==typeof n.g?n.g:window}var Me=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!==i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(s=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;0!==i--;){var o=s[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n};const Le="undefined"!==typeof window?i.useLayoutEffect:i.useEffect;function Fe(e,t,n){const[r,s]=(0,i.useState)((()=>t(e))),o=(0,i.useCallback)((()=>{const i=t(e);Me(r,i)||(s(i),n&&n())}),[r,e,n]);return Le(o),[r,o]}function Ue(e,t,n){return function(e,t,n){const[r,i]=Fe(e,t,n);return Le((function(){const t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(i,{handlerIds:[t]})}),[e,i]),r}(t,e||(()=>({})),(()=>n.reconnect()))}function je(e,t){const n=[...t||[]];return null==t&&"function"!==typeof e&&n.push(e),(0,i.useMemo)((()=>"function"===typeof e?e():e),n)}function Be(e){return(0,i.useMemo)((()=>e.hooks.dragSource()),[e])}function qe(e){return(0,i.useMemo)((()=>e.hooks.dragPreview()),[e])}let Ve=!1,Ke=!1;class ze{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){x(!Ve,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Ve=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Ve=!1}}isDragging(){if(!this.sourceId)return!1;x(!Ke,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Ke=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Ke=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let We=!1;class He{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}canDrop(){if(!this.targetId)return!1;x(!We,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return We=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{We=!1}}isOver(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function Ge(e,t,n,r){let i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;const s=Object.keys(e),o=Object.keys(t);if(s.length!==o.length)return!1;const a=Object.prototype.hasOwnProperty.bind(t);for(let c=0;c<s.length;c++){const o=s[c];if(!a(o))return!1;const l=e[o],u=t[o];if(i=n?n.call(r,l,u,o):void 0,!1===i||void 0===i&&l!==u)return!1}return!0}function Qe(e){return null!==e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function Ye(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!(0,i.isValidElement)(t)){const r=t;return e(r,n),r}const r=t;!function(e){if("string"===typeof e.type)return;const t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(t," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}(r);return function(e,t){const n=e.ref;return x("string"!==typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?(0,i.cloneElement)(e,{ref:e=>{Je(n,e),Je(t,e)}}):(0,i.cloneElement)(e,{ref:t})}(r,n?t=>e(t,n):e)}}function $e(e){const t={};return Object.keys(e).forEach((n=>{const r=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{const e=Ye(r);t[n]=()=>e}})),t}function Je(e,t){"function"===typeof e?e(t):e.current=t}class Xe{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.dragPreview,n=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();n&&this.disconnectDragPreview(),this.handlerId&&(t?n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions)):this.lastConnectedDragPreview=t)}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!Ge(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!Ge(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=$e({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,Qe(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,Qe(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class Ze{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!Ge(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=$e({dropTarget:(e,t)=>{this.clearDropTarget(),this.dropTargetOptions=t,Qe(e)?this.dropTargetRef=e:this.dropTargetNode=e,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function et(){const{dragDropManager:e}=(0,i.useContext)(E);return x(null!=e,"Expected drag drop context"),e}class tt{beginDrag(){const e=this.spec,t=this.monitor;let n=null;return n="object"===typeof e.item?e.item:"function"===typeof e.item?e.item(t):{},null!==n&&void 0!==n?n:null}canDrag(){const e=this.spec,t=this.monitor;return"boolean"===typeof e.canDrag?e.canDrag:"function"!==typeof e.canDrag||e.canDrag(t)}isDragging(e,t){const n=this.spec,r=this.monitor,{isDragging:i}=n;return i?i(r):t===e.getSourceId()}endDrag(){const e=this.spec,t=this.monitor,n=this.connector,{end:r}=e;r&&r(t.getItem(),t),n.reconnect()}constructor(e,t,n){this.spec=e,this.monitor=t,this.connector=n}}function nt(e,t,n){const r=et(),s=function(e,t,n){const r=(0,i.useMemo)((()=>new tt(e,t,n)),[t,n]);return(0,i.useEffect)((()=>{r.spec=e}),[e]),r}(e,t,n),o=function(e){return(0,i.useMemo)((()=>{const t=e.type;return x(null!=t,"spec.type must be defined"),t}),[e])}(e);Le((function(){if(null!=o){const[e,i]=function(e,t,n){const r=n.getRegistry(),i=r.addSource(e,t);return[i,()=>r.removeSource(i)]}(o,s,r);return t.receiveHandlerId(e),n.receiveHandlerId(e),i}}),[r,t,n,s,o])}function rt(e,t){const n=je(e,t);x(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const r=function(){const e=et();return(0,i.useMemo)((()=>new ze(e)),[e])}(),s=function(e,t){const n=et(),r=(0,i.useMemo)((()=>new Xe(n.getBackend())),[n]);return Le((()=>(r.dragSourceOptions=e||null,r.reconnect(),()=>r.disconnectDragSource())),[r,e]),Le((()=>(r.dragPreviewOptions=t||null,r.reconnect(),()=>r.disconnectDragPreview())),[r,t]),r}(n.options,n.previewOptions);return nt(n,r,s),[Ue(n.collect,r,s),Be(s),qe(s)]}function it(e){return(0,i.useMemo)((()=>e.hooks.dropTarget()),[e])}class st{canDrop(){const e=this.spec,t=this.monitor;return!e.canDrop||e.canDrop(t.getItem(),t)}hover(){const e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}drop(){const e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}constructor(e,t){this.spec=e,this.monitor=t}}function ot(e,t,n){const r=et(),s=function(e,t){const n=(0,i.useMemo)((()=>new st(e,t)),[t]);return(0,i.useEffect)((()=>{n.spec=e}),[e]),n}(e,t),o=function(e){const{accept:t}=e;return(0,i.useMemo)((()=>(x(null!=e.accept,"accept must be defined"),Array.isArray(t)?t:[t])),[t])}(e);Le((function(){const[e,i]=function(e,t,n){const r=n.getRegistry(),i=r.addTarget(e,t);return[i,()=>r.removeTarget(i)]}(o,s,r);return t.receiveHandlerId(e),n.receiveHandlerId(e),i}),[r,t,s,n,o.map((e=>e.toString())).join("|")])}function at(e,t){const n=je(e,t),r=function(){const e=et();return(0,i.useMemo)((()=>new He(e)),[e])}(),s=function(e){const t=et(),n=(0,i.useMemo)((()=>new Ze(t.getBackend())),[t]);return Le((()=>(n.dropTargetOptions=e||null,n.reconnect(),()=>n.disconnectDropTarget())),[e]),n}(n.options);return ot(n,r,s),[Ue(n.collect,r,s),it(s)]}function ct(e){let t=null;return()=>(null==t&&(t=e()),t)}class lt{enter(e){const t=this.entered.length;return this.entered=function(e,t){const n=new Set,r=e=>n.add(e);e.forEach(r),t.forEach(r);const i=[];return n.forEach((e=>i.push(e))),i}(this.entered.filter((t=>this.isNodeInDocument(t)&&(!t.contains||t.contains(e)))),[e]),0===t&&this.entered.length>0}leave(e){const t=this.entered.length;var n,r;return this.entered=(n=this.entered.filter(this.isNodeInDocument),r=e,n.filter((e=>e!==r))),t>0&&0===this.entered.length}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class ut{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach((e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get:()=>(console.warn("Browser doesn't allow reading \"".concat(e,'" until the drop event.')),null)})}))}loadDataTransfer(e){if(e){const t={};Object.keys(this.config.exposeProperties).forEach((n=>{const r=this.config.exposeProperties[n];null!=r&&(t[n]={value:r(e,this.config.matchesTypes),configurable:!0,enumerable:!0})})),Object.defineProperties(this.item,t)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,t){return t===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}const ht="__NATIVE_FILE__",dt="__NATIVE_URL__",ft="__NATIVE_TEXT__",pt="__NATIVE_HTML__";var gt=Object.freeze({__proto__:null,FILE:ht,HTML:pt,TEXT:ft,URL:dt});function mt(e,t,n){const r=t.reduce(((t,n)=>t||e.getData(n)),"");return null!=r?r:n}const _t={[ht]:{exposeProperties:{files:e=>Array.prototype.slice.call(e.files),items:e=>e.items,dataTransfer:e=>e},matchesTypes:["Files"]},[pt]:{exposeProperties:{html:(e,t)=>mt(e,t,""),dataTransfer:e=>e},matchesTypes:["Html","text/html"]},[dt]:{exposeProperties:{urls:(e,t)=>mt(e,t,"").split("\n"),dataTransfer:e=>e},matchesTypes:["Url","text/uri-list"]},[ft]:{exposeProperties:{text:(e,t)=>mt(e,t,""),dataTransfer:e=>e},matchesTypes:["Text","text/plain"]}};function vt(e){if(!e)return null;const t=Array.prototype.slice.call(e.types||[]);return Object.keys(_t).filter((e=>{const n=_t[e];return!!(null===n||void 0===n?void 0:n.matchesTypes)&&n.matchesTypes.some((e=>t.indexOf(e)>-1))}))[0]||null}const yt=ct((()=>/firefox/i.test(navigator.userAgent))),wt=ct((()=>Boolean(window.safari)));class bt{interpolate(e){const{xs:t,ys:n,c1s:r,c2s:i,c3s:s}=this;let o=t.length-1;if(e===t[o])return n[o];let a,c=0,l=s.length-1;for(;c<=l;){a=Math.floor(.5*(c+l));const r=t[a];if(r<e)c=a+1;else{if(!(r>e))return n[a];l=a-1}}o=Math.max(0,l);const u=e-t[o],h=u*u;return n[o]+r[o]*u+i[o]*h+s[o]*u*h}constructor(e,t){const{length:n}=e,r=[];for(let d=0;d<n;d++)r.push(d);r.sort(((t,n)=>e[t]<e[n]?-1:1));const i=[],s=[];let o,a;for(let d=0;d<n-1;d++)o=e[d+1]-e[d],a=t[d+1]-t[d],i.push(o),s.push(a/o);const c=[s[0]];for(let d=0;d<i.length-1;d++){const e=s[d],t=s[d+1];if(e*t<=0)c.push(0);else{o=i[d];const n=i[d+1],r=o+n;c.push(3*r/((r+n)/e+(r+o)/t))}}c.push(s[s.length-1]);const l=[],u=[];let h;for(let d=0;d<c.length-1;d++){h=s[d];const e=c[d],t=1/i[d],n=e+c[d+1]-h-h;l.push((h-e-n)*t),u.push(n*t*t)}this.xs=e,this.ys=t,this.c1s=c,this.c2s=l,this.c3s=u}}function Et(e){const t=1===e.nodeType?e:e.parentElement;if(!t)return null;const{top:n,left:r}=t.getBoundingClientRect();return{x:r,y:n}}function It(e){return{x:e.clientX,y:e.clientY}}function Tt(e,t,n,r,i){const s=function(e){var t;return"IMG"===e.nodeName&&(yt()||!(null===(t=document.documentElement)||void 0===t?void 0:t.contains(e)))}(t),o=Et(s?e:t),a={x:n.x-o.x,y:n.y-o.y},{offsetWidth:c,offsetHeight:l}=e,{anchorX:u,anchorY:h}=r,{dragPreviewWidth:d,dragPreviewHeight:f}=function(e,t,n,r){let i=e?t.width:n,s=e?t.height:r;return wt()&&e&&(s/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:s}}(s,t,c,l),{offsetX:p,offsetY:g}=i,m=0===g||g;return{x:0===p||p?p:new bt([0,.5,1],[a.x,a.x/c*d,a.x+d-c]).interpolate(u),y:m?g:(()=>{let e=new bt([0,.5,1],[a.y,a.y/l*f,a.y+f-l]).interpolate(h);return wt()&&s&&(e+=(window.devicePixelRatio-1)*f),e})()}}let Ct,St=class{get window(){return this.globalContext?this.globalContext:"undefined"!==typeof window?window:void 0}get document(){var e;return(null===(e=this.globalContext)||void 0===e?void 0:e.document)?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}constructor(e,t){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=t}};function kt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){kt(e,t,n[t])}))}return e}class Pt{profile(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;var t;void 0!==e&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(t=this.window)||void 0===t||t.cancelAnimationFrame(this.asyncEndDragFrameId)))}connectDragPreview(e,t,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,t,n){this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);const r=t=>this.handleDragStart(t,e),i=e=>this.handleSelectStart(e);return t.setAttribute("draggable","true"),t.addEventListener("dragstart",r),t.addEventListener("selectstart",i),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",r),t.removeEventListener("selectstart",i),t.setAttribute("draggable","false")}}connectDropTarget(e,t){const n=t=>this.handleDragEnter(t,e),r=t=>this.handleDragOver(t,e),i=t=>this.handleDrop(t,e);return t.addEventListener("dragenter",n),t.addEventListener("dragover",r),t.addEventListener("drop",i),()=>{t.removeEventListener("dragenter",n),t.removeEventListener("dragover",r),t.removeEventListener("drop",i)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return xt({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId();return xt({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(gt).some((t=>gt[t]===e))}beginDragNativeItem(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){const n=_t[e];if(!n)throw new Error("native type ".concat(e," has no configuration"));const r=new ut(n);return r.loadDataTransfer(t),r}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;this.mouseMoveTimeoutTimer=setTimeout((()=>{var e;return null===(e=this.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){var e;if(this.currentDragSourceNode=null,this.rootElement)null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0);return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}handleDragEnter(e,t){this.dragEnterTargetIds.unshift(t)}handleDragOver(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}handleDrop(e,t){this.dropTargetIds.unshift(t)}constructor(e,t,n){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=e=>{const t=this.sourceNodes.get(e);return t&&Et(t)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=e=>Boolean(e&&this.document&&this.document.body&&this.document.body.contains(e)),this.endDragIfSourceWasRemovedFromDOM=()=>{const e=this.currentDragSourceNode;null==e||this.isNodeInDocument(e)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=e=>{null===this.hoverRafId&&"undefined"!==typeof requestAnimationFrame&&(this.hoverRafId=requestAnimationFrame((()=>{this.monitor.isDragging()&&this.actions.hover(e||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null})))},this.cancelHover=()=>{null!==this.hoverRafId&&"undefined"!==typeof cancelAnimationFrame&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=e=>{if(e.defaultPrevented)return;const{dragStartSourceIds:t}=this;this.dragStartSourceIds=null;const n=It(e);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:n});const{dataTransfer:r}=e,i=vt(r);if(this.monitor.isDragging()){if(r&&"function"===typeof r.setDragImage){const e=this.monitor.getSourceId(),t=this.sourceNodes.get(e),i=this.sourcePreviewNodes.get(e)||t;if(i){const{anchorX:e,anchorY:s,offsetX:o,offsetY:a}=this.getCurrentSourcePreviewNodeOptions(),c=Tt(t,i,n,{anchorX:e,anchorY:s},{offsetX:o,offsetY:a});r.setDragImage(i,c.x,c.y)}}try{null===r||void 0===r||r.setData("application/json",{})}catch(s){}this.setCurrentDragSourceNode(e.target);const{captureDraggingState:t}=this.getCurrentSourcePreviewNodeOptions();t?this.actions.publishDragSource():setTimeout((()=>this.actions.publishDragSource()),0)}else if(i)this.beginDragNativeItem(i);else{if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=e=>{var t;(this.dragEnterTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer));if(!this.enterLeaveCounter.enter(e.target)||this.monitor.isDragging())return;const{dataTransfer:n}=e,r=vt(n);r&&this.beginDragNativeItem(r,n)},this.handleTopDragEnter=e=>{const{dragEnterTargetIds:t}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=e.altKey,t.length>0&&this.actions.hover(t,{clientOffset:It(e)});t.some((e=>this.monitor.canDropOnTarget(e)))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=e=>{var t;(this.dragOverTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer))},this.handleTopDragOver=e=>{const{dragOverTargetIds:t}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));this.altKeyPressed=e.altKey,this.lastClientOffset=It(e),this.scheduleHover(t);(t||[]).some((e=>this.monitor.canDropOnTarget(e)))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=e=>{this.isDraggingNativeItem()&&e.preventDefault();this.enterLeaveCounter.leave(e.target)&&(this.isDraggingNativeItem()&&setTimeout((()=>this.endDragNativeItem()),0),this.cancelHover())},this.handleTopDropCapture=e=>{var t;(this.dropTargetIds=[],this.isDraggingNativeItem())?(e.preventDefault(),null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):vt(e.dataTransfer)&&e.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=e=>{const{dropTargetIds:t}=this;this.dropTargetIds=[],this.actions.hover(t,{clientOffset:It(e)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=e=>{const t=e.target;"function"===typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new St(t,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new lt(this.isNodeInDocument)}}function At(){return Ct||(Ct=new Image,Ct.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),Ct}const Ot=function(e,t,n){return new Pt(e,t,n)};function Dt(e){let{isPremovedPiece:t=!1,piece:n,square:s,squares:o}=e;const{animationDuration:a,arePiecesDraggable:c,boardWidth:l,boardOrientation:u,chessPieces:h,currentPosition:d,deletePieceFromSquare:f,dropOffBoardAction:p,id:g,isDraggablePiece:m,isWaitingForAnimation:v,onPieceClick:y,onPieceDragBegin:w,onPieceDragEnd:b,onPieceDropOffBoard:E,onPromotionCheck:I,positionDifferences:T}=_(),[C,S]=(0,i.useState)({opacity:1,zIndex:5,touchAction:"none",cursor:c&&m({piece:n,sourceSquare:s})?"-webkit-grab":"default"}),[{canDrag:k,isDragging:x},P,A]=rt((()=>({type:"piece",item:()=>(w(n,s),{piece:n,square:s,id:g}),end:(e,t)=>{b(n,s);!t.didDrop()&&("trash"===p&&f(s),null===E||void 0===E||E(s,n))},collect:e=>({canDrag:m({piece:n,sourceSquare:s}),isDragging:!!e.isDragging()})})),[n,s,d,g]);return A(At(),{captureDraggingState:!0}),(0,i.useEffect)((()=>{S((e=>Object.assign(Object.assign({},e),{opacity:x?0:1})))}),[x]),(0,i.useEffect)((()=>{var e;const n=null===(e=T.removed)||void 0===e?void 0:e[s];if(!T.added||!n)return;const r=Object.entries(T.added).find((e=>{let[t,r]=e;return r===n||I(s,t,n)}));if(v&&n&&r&&!t){const e=s,t=r[0];if(e&&t){const n=l/8;S((r=>Object.assign(Object.assign({},r),{transform:"translate(".concat(("black"===u?-1:1)*(t.charCodeAt(0)-e.charCodeAt(0))*n,"px, ").concat(("black"===u?-1:1)*(Number(e[1])-Number(t[1]))*n,"px)"),transition:"transform ".concat(a,"ms"),zIndex:6})))}}}),[T]),(0,i.useEffect)((()=>{const{sourceSq:e}={sourceSq:o[s]};e&&S((e=>Object.assign(Object.assign({},e),{transform:"translate(".concat(0,"px, ",0,"px)"),transition:"transform ".concat(0,"ms")})))}),[d]),(0,i.useEffect)((()=>{S((e=>Object.assign(Object.assign({},e),{cursor:c&&m({piece:n,sourceSquare:s})?"-webkit-grab":"default"})))}),[s,d,c]),(0,r.jsx)("div",Object.assign({ref:c&&k?P:null,onClick:()=>y(n,s),"data-piece":n,style:C},{children:"function"===typeof h[n]?h[n]({squareWidth:l/8,isDragging:x,square:s}):(0,r.jsx)("svg",Object.assign({viewBox:"1 1 43 43",width:l/8,height:l/8,style:{display:"block"}},{children:(0,r.jsx)("g",{children:h[n]})}))}))}function Rt(e){let{square:t,squareColor:n,setSquares:s,squareHasPremove:o,children:a}=e;const c=(0,i.useRef)(null),{autoPromoteToQueen:l,boardWidth:u,boardOrientation:h,clearArrows:d,currentPosition:f,currentRightClickDown:p,customBoardStyle:g,customDarkSquareStyle:m,customDropSquareStyle:v,customLightSquareStyle:y,customPremoveDarkSquareStyle:w,customPremoveLightSquareStyle:b,customSquare:E,customSquareStyles:I,drawNewArrow:T,handleSetPosition:C,handleSparePieceDrop:S,isWaitingForAnimation:k,lastPieceColour:x,lastSquareDraggedOver:P,onArrowDrawEnd:A,onDragOverSquare:O,onMouseOutSquare:D,onMouseOverSquare:R,onPieceDrop:N,onPromotionCheck:M,onRightClickDown:L,onRightClickUp:F,onSquareClick:U,setLastSquareDraggedOver:j,setPromoteFromSquare:B,setPromoteToSquare:q,setShowPromoteDialog:V}=_(),[{isOver:K},z]=at((()=>({accept:"piece",drop:W,collect:e=>({isOver:!!e.isOver()})})),[t,f,N,k,x]);function W(e){e.isSpare?S(e.piece,t):M(e.square,t,e.piece)?l?C(e.square,t,"w"===e.piece[0]?"wQ":"bQ"):(B(e.square),q(t),V(!0)):C(e.square,t,e.piece,!0)}(0,i.useEffect)((()=>{if(c.current){const{x:e,y:n}=c.current.getBoundingClientRect();s((r=>Object.assign(Object.assign({},r),{[t]:{x:e,y:n}})))}}),[u,h]);const H=Object.assign(Object.assign(Object.assign(Object.assign({},Lt(t,h,g)),"black"===n?m:y),o&&("black"===n?w:b)),K&&v);return(0,r.jsx)("div",Object.assign({ref:z,style:H,"data-square-color":n,"data-square":t,onTouchMove:e=>{var t;const n=e.touches[0],r=document.elementsFromPoint(n.clientX,n.clientY),i=null===(t=null===r||void 0===r?void 0:r.find((e=>e.getAttribute("data-square"))))||void 0===t?void 0:t.getAttribute("data-square");i&&i!==P&&(j(i),O(i))},onMouseOver:e=>{2===e.buttons&&p&&T(p,t),e.relatedTarget&&e.currentTarget.contains(e.relatedTarget)||R(t)},onMouseOut:e=>{e.relatedTarget&&e.currentTarget.contains(e.relatedTarget)||D(t)},onMouseDown:e=>{2===e.button&&L(t)},onMouseUp:e=>{2===e.button&&(p&&A(p,t),F(t))},onDragEnter:()=>O(t),onClick:()=>{const e=f[t];U(t,e),d()},onContextMenu:e=>{e.preventDefault()}},{children:"string"===typeof E?(0,r.jsx)(E,Object.assign({ref:c,style:Object.assign(Object.assign(Object.assign({},Mt(u)),Nt),!o&&(null===I||void 0===I?void 0:I[t]))},{children:a})):(0,r.jsx)(E,Object.assign({ref:c,square:t,squareColor:n,style:Object.assign(Object.assign(Object.assign({},Mt(u)),Nt),!o&&(null===I||void 0===I?void 0:I[t]))},{children:a}))}))}const Nt={display:"flex",justifyContent:"center"},Mt=e=>({width:e/8,height:e/8}),Lt=(e,t,n)=>(null===n||void 0===n?void 0:n.borderRadius)?"a1"===e?"white"===t?{borderBottomLeftRadius:n.borderRadius}:{borderTopRightRadius:n.borderRadius}:"a8"===e?"white"===t?{borderTopLeftRadius:n.borderRadius}:{borderBottomRightRadius:n.borderRadius}:"h1"===e?"white"===t?{borderBottomRightRadius:n.borderRadius}:{borderTopLeftRadius:n.borderRadius}:"h8"===e?"white"===t?{borderTopRightRadius:n.borderRadius}:{borderBottomLeftRadius:n.borderRadius}:{}:{};function Ft(){const[e,t]=(0,i.useState)({}),{arePremovesAllowed:n,boardOrientation:o,boardWidth:a,currentPosition:c,id:l,premoves:u,showBoardNotation:h}=_(),d=(0,i.useMemo)((()=>{const e=[];return n?(u.forEach(((t,n)=>{const{sourceSq:r,targetSq:i,piece:s}=t,o=e.find((e=>{var t;return e.piece===s&&(null===(t=e.premovesRoute.at(-1))||void 0===t?void 0:t.targetSq)===r}));o?o.premovesRoute.push({sourceSq:r,targetSq:i,index:n}):e.push({piece:s,premovesRoute:[{sourceSq:r,targetSq:i,index:n}]})})),e):[]}),[u]);return(0,r.jsx)("div",Object.assign({"data-boardid":l},{children:[...Array(8)].map(((n,i)=>(0,r.jsx)("div",Object.assign({style:{display:"flex",flexWrap:"nowrap",width:a}},{children:[...Array(8)].map(((n,a)=>{const l="black"===o?s[7-a]+(i+1):s[a]+(8-i),f=a%2===i%2?"white":"black",p=u.find((e=>e.sourceSq===l||e.targetSq===l)),g=d.filter((e=>{let{premovesRoute:t}=e;var n;return(null===(n=t.at(-1))||void 0===n?void 0:n.targetSq)===l})).sort(((e,t)=>{var n,r;return(null===(n=t.premovesRoute.at(-1))||void 0===n?void 0:n.index)-(null===(r=e.premovesRoute.at(-1))||void 0===r?void 0:r.index)})).at(0);return(0,r.jsxs)(Rt,Object.assign({square:l,squareColor:f,setSquares:t,squareHasPremove:!!p},{children:[!p&&c[l]&&(0,r.jsx)(Dt,{piece:c[l],square:l,squares:e}),g&&(0,r.jsx)(Dt,{isPremovedPiece:!0,piece:g.piece,square:l,squares:e}),h&&(0,r.jsx)(y,{row:i,col:a})]}),"".concat(a).concat(i))}))}),i.toString())))}))}const Ut=()=>{const{arrows:e,newArrow:t,boardOrientation:n,boardWidth:s,customArrowColor:o}=_(),a=[...e,t].filter(Boolean);return(0,r.jsx)("svg",Object.assign({width:s,height:s,style:{position:"absolute",top:"0",left:"0",pointerEvents:"none",zIndex:"10"}},{children:a.map(((t,a)=>{const[c,l,u]=t;if(c===l)return null;const h=d(n,s,c),f=d(n,s,l);let p=s/32;const g=a===e.length;e.some((e=>e[0]!==c&&e[1]===l))&&!g&&(p=s/16);const m=f.x-h.x,_=f.y-h.y,v=Math.hypot(_,m),y={x:h.x+m*(v-p)/v,y:h.y+_*(v-p)/v};return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)("marker",Object.assign({id:"arrowhead-".concat(a),markerWidth:"2",markerHeight:"2.5",refX:"1.25",refY:"1.25",orient:"auto"},{children:(0,r.jsx)("polygon",{points:"0.3 0, 2 1.25, 0.3 2.5",fill:null!==u&&void 0!==u?u:o})})),(0,r.jsx)("line",{x1:h.x,y1:h.y,x2:y.x,y2:y.y,opacity:g?"0.5":"0.65",stroke:null!==u&&void 0!==u?u:o,strokeWidth:g?.9*s/40:s/40,markerEnd:"url(#arrowhead-".concat(a,")")})]},"".concat(c,"-").concat(l).concat(g?"-active":""))}))}))};function jt(e){let{option:t}=e;const[n,s]=(0,i.useState)(!1),{boardWidth:o,chessPieces:a,customDarkSquareStyle:c,customLightSquareStyle:l,handleSetPosition:u,onPromotionPieceSelect:h,promoteFromSquare:d,promoteToSquare:f,promotionDialogVariant:p}=_(),g=()=>{switch(t[1]){case"Q":return c.backgroundColor;case"R":return l.backgroundColor;case"N":return"default"===p?l.backgroundColor:c.backgroundColor;case"B":return"default"===p?c.backgroundColor:l.backgroundColor}};return(0,r.jsx)("div",Object.assign({onClick:()=>{h(t,null!==d&&void 0!==d?d:void 0,null!==f&&void 0!==f?f:void 0)&&u(d,f,t,!0)},onMouseOver:()=>s(!0),onMouseOut:()=>s(!1),"data-piece":t,style:{cursor:"pointer",backgroundColor:n?g():"".concat(g(),"aa"),borderRadius:"4px",transition:"all 0.1s ease-out"}},{children:"function"===typeof a[t]?(0,r.jsx)("div",Object.assign({style:{transition:"all 0.1s ease-out",transform:n?"scale(1)":"scale(0.85)"}},{children:a[t]({squareWidth:o/8,isDragging:!1})})):(0,r.jsx)("svg",Object.assign({viewBox:"1 1 43 43",width:o/8,height:o/8,style:{transition:"all 0.1s ease-out",transform:n?"scale(1)":"scale(0.85)"}},{children:(0,r.jsx)("g",{children:a[t]})}))}))}function Bt(){const{boardOrientation:e,boardWidth:t,promotionDialogVariant:n,promoteToSquare:i}=_(),s="1"===(null===i||void 0===i?void 0:i[1])?"b":"w",o=["".concat(null!==s&&void 0!==s?s:"w","Q"),"".concat(null!==s&&void 0!==s?s:"w","R"),"".concat(null!==s&&void 0!==s?s:"w","N"),"".concat(null!==s&&void 0!==s?s:"w","B")],a={default:{display:"grid",gridTemplateColumns:"1fr 1fr",transform:"translate(".concat(-t/8,"px, ").concat(-t/8,"px)")},vertical:{transform:"translate(".concat(-t/16,"px, ").concat(-t/16,"px)")},modal:{display:"flex",justifyContent:"center",alignItems:"center",transform:"translate(0px, ".concat(3*t/8,"px)"),width:"100%",height:"".concat(t/4,"px"),top:0,backgroundColor:"white",left:0}},c=d(e,t,i||"a8");return(0,r.jsx)("div",Object.assign({style:Object.assign({position:"absolute",top:"".concat(null===c||void 0===c?void 0:c.y,"px"),left:"".concat(null===c||void 0===c?void 0:c.x,"px"),zIndex:1e3},a[n]),title:"Choose promotion piece"},{children:o.map((e=>(0,r.jsx)(jt,{option:e},e)))}))}const qt={whiteKing:(0,r.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"crisp-edges"},viewBox:"0 0 4210 12970",x:"0px",y:"0px",fillRule:"evenodd",clipRule:"evenodd",width:"250",height:"250"},{children:(0,r.jsx)("g",{children:(0,r.jsx)("path",{style:{fill:"black",fillRule:"nonzero"},d:"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z"})})}))};function Vt(e){let{children:t}=e;try{return(0,r.jsx)(r.Fragment,{children:t})}catch(n){return console.log(n),(0,r.jsx)(Kt,{showError:!0})}}function Kt(e){let{showError:t=!1}=e;return(0,r.jsxs)("div",Object.assign({style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},{children:[(0,r.jsx)("div",Object.assign({style:{width:250,height:250,transform:"rotate(90deg)"}},{children:qt.whiteKing})),t&&(0,r.jsx)("h1",{children:"Something went wrong"})]}))}function zt(){const e=(0,i.useRef)(null),{boardWidth:t,clearCurrentRightClickDown:n,onPromotionPieceSelect:s,setShowPromoteDialog:o,showPromoteDialog:a,customBoardStyle:c}=_();return(0,i.useEffect)((()=>{function t(t){e.current&&!e.current.contains(t.target)&&n()}return document.addEventListener("mouseup",t),()=>{document.removeEventListener("mouseup",t)}}),[]),t?(0,r.jsx)("div",Object.assign({style:{perspective:"1000px"}},{children:(0,r.jsxs)("div",Object.assign({ref:e,style:Object.assign(Object.assign({position:"relative"},Wt(t)),c)},{children:[(0,r.jsx)(Ft,{}),(0,r.jsx)(Ut,{}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{onClick:()=>{o(!1),null===s||void 0===s||s()},style:{position:"absolute",top:"0",left:"0",zIndex:"100",backgroundColor:"rgba(22,21,18,.7)",width:t,height:t}}),(0,r.jsx)(Bt,{})]})]}))})):(0,r.jsx)(Kt,{})}const Wt=e=>({cursor:"default",height:e,width:e});var Ht;!function(e){e.mouse="mouse",e.touch="touch",e.keyboard="keyboard"}(Ht||(Ht={}));class Gt{get delay(){var e;return null!==(e=this.args.delay)&&void 0!==e?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return null!==(e=this.args.ignoreContextMenu)&&void 0!==e&&e}get enableHoverOutsideTarget(){var e;return null!==(e=this.args.enableHoverOutsideTarget)&&void 0!==e&&e}get enableKeyboardEvents(){var e;return null!==(e=this.args.enableKeyboardEvents)&&void 0!==e&&e}get enableMouseEvents(){var e;return null!==(e=this.args.enableMouseEvents)&&void 0!==e&&e}get enableTouchEvents(){var e;return null===(e=this.args.enableTouchEvents)||void 0===e||e}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,t,n,r;return null!==(r=null!==(n=null===(e=this.args)||void 0===e?void 0:e.delayTouchStart)&&void 0!==n?n:null===(t=this.args)||void 0===t?void 0:t.delay)&&void 0!==r?r:0}get delayMouseStart(){var e,t,n,r;return null!==(r=null!==(n=null===(e=this.args)||void 0===e?void 0:e.delayMouseStart)&&void 0!==n?n:null===(t=this.args)||void 0===t?void 0:t.delay)&&void 0!==r?r:0}get window(){return this.context&&this.context.window?this.context.window:"undefined"!==typeof window?window:void 0}get document(){var e;return(null===(e=this.context)||void 0===e?void 0:e.document)?this.context.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.args)||void 0===e?void 0:e.rootElement)||this.document}constructor(e,t){this.args=e,this.context=t}}const Qt=1,Yt=0;function $t(e){return void 0===e.button||e.button===Yt}function Jt(e){return!!e.targetTouches}function Xt(e,t){return Jt(e)?function(e,t){return 1===e.targetTouches.length?Xt(e.targetTouches[0]):t&&1===e.touches.length&&e.touches[0].target===t.target?Xt(e.touches[0]):void 0}(e,t):{x:e.clientX,y:e.clientY}}const Zt=(()=>{let e=!1;try{addEventListener("test",(()=>{}),Object.defineProperty({},"passive",{get:()=>(e=!0,!0)}))}catch(t){}return e})(),en={[Ht.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[Ht.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[Ht.keyboard]:{keydown:"keydown"}};class tn{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:(null===(e=this.dragOverTargetIds)||void 0===e?void 0:e.length)||0}}get document(){return this.options.document}setup(){const e=this.options.rootElement;e&&(x(!tn.isSetUp,"Cannot have two Touch backends at the same time."),tn.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){const e=this.options.rootElement;e&&(tn.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=Zt?{capture:r,passive:!1}:r;this.listenerTypes.forEach((function(r){const s=en[r][t];s&&e.addEventListener(s,n,i)}))}removeEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=Zt?{capture:r,passive:!1}:r;this.listenerTypes.forEach((function(r){const s=en[r][t];s&&e.removeEventListener(s,n,i)}))}connectDragSource(e,t){const n=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,t),this.addEventListener(t,"start",n),()=>{this.sourceNodes.delete(e),this.removeEventListener(t,"start",n)}}connectDragPreview(e,t,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,t){const n=this.options.rootElement;if(!this.document||!n)return()=>{};const r=r=>{if(!this.document||!n||!this.monitor.isDragging())return;let i;switch(r.type){case en.mouse.move:i={x:r.clientX,y:r.clientY};break;case en.touch.move:var s,o;i={x:(null===(s=r.touches[0])||void 0===s?void 0:s.clientX)||0,y:(null===(o=r.touches[0])||void 0===o?void 0:o.clientY)||0}}const a=null!=i?this.document.elementFromPoint(i.x,i.y):void 0,c=a&&t.contains(a);return a===t||c?this.handleMove(r,e):void 0};return this.addEventListener(this.document.body,"move",r),this.targetNodes.set(e,t),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",r))}}getTopMoveStartHandler(){return this.options.delayTouchStart||this.options.delayMouseStart?this.handleTopMoveStartDelay:this.handleTopMoveStart}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver((()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())})),e&&e.parentElement&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,t,n){this.getSourceClientOffset=e=>{const t=this.sourceNodes.get(e);return t&&function(e){const t=1===e.nodeType?e:e.parentElement;if(!t)return;const{top:n,left:r}=t.getBoundingClientRect();return{x:r,y:n}}(t)},this.handleTopMoveStartCapture=e=>{$t(e)&&(this.moveStartSourceIds=[])},this.handleMoveStart=e=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(e)},this.handleTopMoveStart=e=>{if(!$t(e))return;const t=Xt(e);t&&(Jt(e)&&(this.lastTargetTouchFallback=e.targetTouches[0]),this._mouseClientOffset=t),this.waitingForDelay=!1},this.handleTopMoveStartDelay=e=>{if(!$t(e))return;const t=e.type===en.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,e),t),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(e,t)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(t)},this.handleTopMove=e=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:t,dragOverTargetIds:n}=this,r=this.options.enableHoverOutsideTarget,i=Xt(e,this.lastTargetTouchFallback);if(!i)return;if(this._isScrolling||!this.monitor.isDragging()&&function(e,t,n,r,i){if(!i)return!1;const s=180*Math.atan2(r-t,n-e)/Math.PI+180;for(let o=0;o<i.length;++o){const e=i[o];if(e&&(null==e.start||s>=e.start)&&(null==e.end||s<=e.end))return!0}return!1}(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,i.x,i.y,this.options.scrollAngleRanges))return void(this._isScrolling=!0);var s,o,a,c;if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&t&&(s=this._mouseClientOffset.x||0,o=this._mouseClientOffset.y||0,a=i.x,c=i.y,Math.sqrt(Math.pow(Math.abs(a-s),2)+Math.pow(Math.abs(c-o),2))>(this.options.touchSlop?this.options.touchSlop:0))&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(t,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const l=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(l),this.actions.publishDragSource(),e.cancelable&&e.preventDefault();const u=(n||[]).map((e=>this.targetNodes.get(e))).filter((e=>!!e)),h=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(i.x,i.y,u):this.document.elementsFromPoint(i.x,i.y),d=[];for(const p in h){if(!h.hasOwnProperty(p))continue;let e=h[p];for(null!=e&&d.push(e);e;)e=e.parentElement,e&&-1===d.indexOf(e)&&d.push(e)}const f=d.filter((e=>u.indexOf(e)>-1)).map((e=>this._getDropTargetId(e))).filter((e=>!!e)).filter(((e,t,n)=>n.indexOf(e)===t));if(r)for(const p in this.targetNodes){const e=this.targetNodes.get(p);if(l&&e&&e.contains(l)&&-1===f.indexOf(p)){f.unshift(p);break}}f.reverse(),this.actions.hover(f,{clientOffset:i})},this._getDropTargetId=e=>{const t=this.targetNodes.keys();let n=t.next();for(;!1===n.done;){const r=n.value;if(e===this.targetNodes.get(r))return r;n=t.next()}},this.handleTopMoveEndCapture=e=>{this._isScrolling=!1,this.lastTargetTouchFallback=void 0,function(e){return void 0===e.buttons||0===(e.buttons&Qt)}(e)&&(this.monitor.isDragging()&&!this.monitor.didDrop()?(e.cancelable&&e.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()):this.moveStartSourceIds=void 0)},this.handleCancelOnEscape=e=>{"Escape"===e.key&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new Gt(n,t),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(Ht.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(Ht.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(Ht.keyboard)}}const nn=function(e){return new tn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})},rn=(0,i.createContext)({isCustomDndProviderSet:!1}),sn=e=>{let{children:t}=e;return(0,r.jsx)(r.Fragment,{children:t})},on=e=>{let{customDndBackend:t,customDndBackendOptions:n,children:s}=e;const[o,a]=(0,i.useState)(),[c,l]=(0,i.useState)(!1),[u,h]=(0,i.useState)(!1),{isCustomDndProviderSet:d}=(0,i.useContext)(rn);(0,i.useEffect)((()=>{h("ontouchstart"in window),l(!0),a(window)}),[]);const f=d?sn:Re;return c?o?(0,r.jsx)(f,Object.assign({backend:t||(u?nn:Ot),context:o,options:t?n:void 0},{children:s})):(0,r.jsx)(r.Fragment,{children:s}):null};function an(e){let{boardContainer:t}=e;const{boardWidth:n,chessPieces:s,id:o,snapToCursor:a,allowDragOutsideBoard:c}=_(),l=function(e){const t=et().getMonitor(),[n,r]=Fe(t,e);return(0,i.useEffect)((()=>t.subscribeToOffsetChange(r))),(0,i.useEffect)((()=>t.subscribeToStateChange(r))),n}((e=>({item:e.getItem(),clientOffset:e.getClientOffset(),sourceClientOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}))),{isDragging:u,item:h,clientOffset:d,sourceClientOffset:f}=l,p=(0,i.useCallback)(((e,r)=>{if(!e||!r)return{display:"none"};let{x:i,y:s}=a?e:r;const o=n/8/2;if(a&&(i-=o,s-=o),!c){const{left:e,top:r}=t,a=e-o,c=r-o,l=e+n-o,u=r+n-o;i=Math.max(a,Math.min(i,l)),s=Math.max(c,Math.min(s,u))}const l="translate(".concat(i,"px, ").concat(s,"px)");return{transform:l,WebkitTransform:l,touchAction:"none"}}),[n,c,a,t]);return u&&h.id===o?(0,r.jsx)("div",Object.assign({style:{position:"fixed",pointerEvents:"none",zIndex:10,left:0,top:0}},{children:(0,r.jsx)("div",Object.assign({style:p(d,f)},{children:"function"===typeof s[h.piece]?s[h.piece]({squareWidth:n/8,isDragging:!0}):(0,r.jsx)("svg",Object.assign({viewBox:"1 1 43 43",width:n/8,height:n/8},{children:(0,r.jsx)("g",{children:s[h.piece]})}))}))})):null}const cn=(0,i.forwardRef)(((e,t)=>{const{customDndBackend:n,customDndBackendOptions:s,onBoardWidthChange:o}=e,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["customDndBackend","customDndBackendOptions","onBoardWidthChange"]),[c,l]=(0,i.useState)(e.boardWidth),u=(0,i.useRef)(null),h=(0,i.useRef)(null),[d,f]=(0,i.useState)({left:0,top:0}),p=(0,i.useMemo)((()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.getBoundingClientRect()}),[u.current]);return(0,i.useEffect)((()=>{c&&(null===o||void 0===o||o(c))}),[c]),(0,i.useEffect)((()=>{f({left:(null===p||void 0===p?void 0:p.left)?null===p||void 0===p?void 0:p.left:0,top:(null===p||void 0===p?void 0:p.top)?null===p||void 0===p?void 0:p.top:0})}),[p]),(0,i.useEffect)((()=>{var t;if(void 0===e.boardWidth&&(null===(t=u.current)||void 0===t?void 0:t.offsetWidth)){const e=new ResizeObserver((()=>{var e;l(null===(e=u.current)||void 0===e?void 0:e.offsetWidth)}));return e.observe(u.current),()=>{e.disconnect()}}}),[u.current]),(0,r.jsx)(Vt,{children:(0,r.jsxs)("div",Object.assign({ref:h,style:{display:"flex",flexDirection:"column",width:"100%"}},{children:[(0,r.jsx)("div",{ref:u,style:{width:"100%"}}),(0,r.jsx)(on,Object.assign({customDndBackend:n,customDndBackendOptions:s},{children:c&&(0,r.jsxs)(v,Object.assign({boardWidth:c},a,{ref:t},{children:[(0,r.jsx)(an,{boardContainer:d}),(0,r.jsx)(zt,{})]}))}))]}))})}))},853:(e,t,n)=>{e.exports=n(234)},940:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(995).A)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]])},942:(e,t,n)=>{var r=n(52),i=n(812),s=n(529),o=n(799);const a="@firebase/installations",c="0.6.17",l=1e4,u="w:".concat(c),h="FIS_v2",d=36e5,f={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},p=new s.FA("installations","Installations",f);function g(e){return e instanceof s.g&&e.code.includes("request-failed")}function m(e){let{projectId:t}=e;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function _(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function v(e,t){const n=(await t.json()).error;return p.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function y(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function w(e,t){let{refreshToken:n}=t;const r=y(e);return r.append("Authorization",function(e){return"".concat(h," ").concat(e)}(n)),r}async function b(e){const t=await e();return t.status>=500&&t.status<600?e():t}function E(e){return new Promise((t=>{setTimeout(t,e)}))}const I=/^[cdef][\w-]{21}$/;function T(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return I.test(t)?t:""}catch(e){return""}}function C(e){return"".concat(e.appName,"!").concat(e.appId)}const S=new Map;function k(e,t){const n=C(e);x(n,t),function(e,t){const n=A();n&&n.postMessage({key:e,fid:t});O()}(n,t)}function x(e,t){const n=S.get(e);if(n)for(const r of n)r(t)}let P=null;function A(){return!P&&"BroadcastChannel"in self&&(P=new BroadcastChannel("[Firebase] FID Change"),P.onmessage=e=>{x(e.data.key,e.data.fid)}),P}function O(){0===S.size&&P&&(P.close(),P=null)}const D="firebase-installations-store";let R=null;function N(){return R||(R=(0,o.P2)("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(D)}})),R}async function M(e,t){const n=C(e),r=(await N()).transaction(D,"readwrite"),i=r.objectStore(D),s=await i.get(n);return await i.put(t,n),await r.done,s&&s.fid===t.fid||k(e,t.fid),t}async function L(e){const t=C(e),n=(await N()).transaction(D,"readwrite");await n.objectStore(D).delete(t),await n.done}async function F(e,t){const n=C(e),r=(await N()).transaction(D,"readwrite"),i=r.objectStore(D),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.done,!o||s&&s.fid===o.fid||k(e,o.fid),o}async function U(e){let t;const n=await F(e.appConfig,(n=>{const r=function(e){const t=e||{fid:T(),registrationStatus:0};return q(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(p.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:i}=t;const s=m(n),o=y(n),a=r.getImmediate({optional:!0});if(a){const e=await a.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}const c={fid:i,authVersion:h,appId:n.appId,sdkVersion:u},l={method:"POST",headers:o,body:JSON.stringify(c)},d=await b((()=>fetch(s,l)));if(d.ok){const e=await d.json();return{fid:e.fid||i,registrationStatus:2,refreshToken:e.refreshToken,authToken:_(e.authToken)}}throw await v("Create Installation",d)}(e,t);return M(e.appConfig,n)}catch(n){throw g(n)&&409===n.customData.serverCode?await L(e.appConfig):await M(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:j(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function j(e){let t=await B(e.appConfig);for(;1===t.registrationStatus;)await E(100),t=await B(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await U(e);return n||t}return t}function B(e){return F(e,(e=>{if(!e)throw p.create("installation-not-found");return q(e)}))}function q(e){return 1===(t=e).registrationStatus&&t.registrationTime+l<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function V(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const i=function(e,t){let{fid:n}=t;return"".concat(m(e),"/").concat(n,"/authTokens:generate")}(n,t),s=w(n,t),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const a={installation:{sdkVersion:u,appId:n.appId}},c={method:"POST",headers:s,body:JSON.stringify(a)},l=await b((()=>fetch(i,c)));if(l.ok){return _(await l.json())}throw await v("Generate Auth Token",l)}async function K(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await F(e.appConfig,(r=>{if(!W(r))throw p.create("not-registered");const i=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+d}(e)}(i))return r;if(1===i.requestStatus)return t=async function(e,t){let n=await z(e.appConfig);for(;1===n.authToken.requestStatus;)await E(100),n=await z(e.appConfig);const r=n.authToken;return 0===r.requestStatus?K(e,t):r}(e,n),r;{if(!navigator.onLine)throw p.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await V(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await M(e.appConfig,r),n}catch(n){if(!g(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await M(e.appConfig,n)}else await L(e.appConfig);throw n}}(e,n),n}}));return t?await t:r.authToken}function z(e){return F(e,(e=>{if(!W(e))throw p.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+l<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function W(e){return void 0!==e&&2===e.registrationStatus}async function H(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await U(e);t&&await t}(n);return(await K(n,t)).token}function G(e){return p.create("missing-app-config-values",{valueName:e})}const Q="installations",Y=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw G("App Configuration");if(!e.name)throw G("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw G(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:(0,r._getProvider)(t,"heartbeat"),_delete:()=>Promise.resolve()}},$=e=>{const t=e.getProvider("app").getImmediate(),n=(0,r._getProvider)(t,Q).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await U(t);return r?r.catch(console.error):K(t).catch(console.error),n.fid}(n),getToken:e=>H(n,e)}};(0,r._registerComponent)(new i.uA(Q,Y,"PUBLIC")),(0,r._registerComponent)(new i.uA("installations-internal",$,"PRIVATE")),(0,r.registerVersion)(a,c),(0,r.registerVersion)(a,c,"esm2017")},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},995:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(379);var i=n(43),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const o=["color","size","strokeWidth","absoluteStrokeWidth","children"],a=(e,t)=>{const n=(0,i.forwardRef)(((n,a)=>{let{color:c="currentColor",size:l=24,strokeWidth:u=2,absoluteStrokeWidth:h,children:d}=n,f=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(n,o);return(0,i.createElement)("svg",(0,r.A)((0,r.A)({ref:a},s),{},{width:l,height:l,stroke:c,strokeWidth:h?24*Number(u)/Number(l):u,className:"lucide lucide-".concat((p=e,p.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()))},f),[...t.map((e=>{let[t,n]=e;return(0,i.createElement)(t,n)})),...(Array.isArray(d)?d:[d])||[]]);var p}));return n.displayName="".concat(e),n}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>"static/js/"+e+".097aab5a.chunk.js",__webpack_require__.miniCssF=e=>{},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="sri-rudra-chat:";__webpack_require__.l=(n,r,i,s)=>{if(e[n])e[n].push(r);else{var o,a;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var u=c[l];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){o=u;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,__webpack_require__.nc&&o.setAttribute("nonce",__webpack_require__.nc),o.setAttribute("data-webpack",t+i),o.src=n),e[n]=[r];var h=(t,r)=>{o.onerror=o.onload=null,clearTimeout(d);var i=e[n];if(delete e[n],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(r))),t)return t(r)},d=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),a&&document.head.appendChild(o)}}})(),__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/rudra-chat/",(()=>{var e={792:0};__webpack_require__.f.j=(t,n)=>{var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=i);var s=__webpack_require__.p+__webpack_require__.u(t),o=new Error;__webpack_require__.l(s,(n=>{if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,r[1](o)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,i,s=n[0],o=n[1],a=n[2],c=0;if(s.some((t=>0!==e[t]))){for(r in o)__webpack_require__.o(o,r)&&(__webpack_require__.m[r]=o[r]);if(a)a(__webpack_require__)}for(t&&t(n);c<s.length;c++)i=s[c],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunksri_rudra_chat=self.webpackChunksri_rudra_chat||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var __webpack_exports__={},react=__webpack_require__(43),client=__webpack_require__(391);const src={};var App=__webpack_require__(111);const isLocalhost=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4]\d|[01]?\d?\d)){3}$/));function register(e){if("serviceWorker"in navigator){if(new URL("/rudra-chat",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="".concat("/rudra-chat","/service-worker.js");isLocalhost?checkValidServiceWorker(t,e):registerValidSW(t,e)}))}}function registerValidSW(e,t){navigator.serviceWorker.register(e).then((e=>{e.waiting&&t&&t.onUpdate&&t.onUpdate(e),e.onupdatefound=()=>{const n=e.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?t&&t.onUpdate&&t.onUpdate(e):t&&t.onSuccess&&t.onSuccess(e))})}})).catch(console.error)}function checkValidServiceWorker(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((n=>{const r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):registerValidSW(e,t)})).catch(console.error)}function unregister(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()})).catch(console.error)}const reportWebVitals=e=>{e&&e instanceof Function&&__webpack_require__.e(488).then(__webpack_require__.bind(__webpack_require__,488)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:o}=t;n(e),r(e),i(e),s(e),o(e)}))},src_reportWebVitals=reportWebVitals;var src_firebase=__webpack_require__(765),index_esm2017=__webpack_require__(554),jsx_runtime=__webpack_require__(579);const container=document.getElementById("root"),root=client.createRoot(container);root.render((0,jsx_runtime.jsx)(App.A,{})),register(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/firebase-messaging-sw.js").then((e=>{console.log("FCM service worker registered:",e),Notification.requestPermission().then((t=>{if("granted"===t){const t="YOUR_PUBLIC_VAPID_KEY";(0,index_esm2017.gf)(src_firebase.BV,{vapidKey:t,serviceWorkerRegistration:e}).then((e=>{console.log("FCM registration token:",e)})).catch((e=>{console.error("Error getting FCM token:",e)}))}else console.warn("Notification permission not granted.")}))})).catch((e=>{console.error("FCM service worker registration failed:",e)})),src_reportWebVitals()})();
//# sourceMappingURL=main.c7b304fa.js.map